"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1362],{1362:(V,S,u)=>{u.r(S),u.d(S,{RegistersListPageModule:()=>G});var _=u(177),D=u(9417),O=u(9465),N=u(5188),e=u(5180),T=u(3953);const k=[{path:"",component:e.c}];let L=(()=>{var v;class R{}return(v=R).\u0275fac=function(j){return new(j||v)},v.\u0275mod=T.$C({type:v}),v.\u0275inj=T.G2t({imports:[N.iI.forChild(k),N.iI]}),R})();var I=u(3895),B=u(5603),x=u(5641);let G=(()=>{var v;class R{}return(v=R).\u0275fac=function(j){return new(j||v)},v.\u0275mod=T.$C({type:v}),v.\u0275inj=T.G2t({imports:[_.MD,D.YN,O.bv,L,I.b,B.P,x.D]}),R})()},5180:(V,S,u)=>{u.d(S,{c:()=>se});var _=u(467),D=u(1413),O=u(7376),e=u(3953),T=u(5970),k=u(2081),L=u(1296),I=u(4501),B=u(8397),x=u(345),G=u(9710),v=u(1213),R=u(177),A=u(1880),j=u(6580);const z=a=>({"crm-block-body-fixed":a}),X=a=>({"embedded-page-header":a}),H=a=>({"crm-button-secondary-primary":a}),U=(a,m,s,t,i)=>({pageStartIndex:a,pageEndIndex:m,totalCount:s,paginationPage:t,sortField:i}),K=a=>({"embedded-pagination-container":a});function W(a,m){if(1&a){const s=e.RV6();e.j41(0,"button",17),e.bIt("click",function(){e.eBV(s);const i=e.XpG();return e.Njj(i.openCreateRegisterModal())}),e.nrm(1,"i",18),e.EFF(2," A\xf1adir registro "),e.k0s()}}function Y(a,m){1&a&&(e.nrm(0,"i",19),e.EFF(1," Cerrar filtros "))}function $(a,m){1&a&&(e.nrm(0,"i",20),e.EFF(1," Filtros activados "))}function q(a,m){1&a&&(e.nrm(0,"i",20),e.EFF(1," Filtrar "))}function J(a,m){if(1&a&&e.DNE(0,$,2,0)(1,q,2,0),2&a){const s=e.XpG();e.vxM(s.filters?0:1)}}function Q(a,m){if(1&a){const s=e.RV6();e.j41(0,"div",12)(1,"app-list-pagination-selectors",21),e.bIt("goPreviousPage",function(){e.eBV(s);const i=e.XpG();return e.Njj(i.onGoPreviousPage())})("goNextPage",function(){e.eBV(s);const i=e.XpG();return e.Njj(i.onGoNextPage())})("sort",function(i){e.eBV(s);const o=e.XpG();return e.Njj(o.onSort(i))}),e.k0s()()}if(2&a){const s=e.XpG();e.R7$(),e.Y8G("listPaginationConfig",e.s1E(1,U,s.updatePagination().startIndex,s.updatePagination().endIndex,s.allSystemOperationsCount,s.pagination.page+1,null!=s.sort&&s.sort.field?(null==s.sort?null:s.sort.field)+" "+(null==s.sort?null:s.sort.order):"Fecha de creaci\xf3n"))}}function Z(a,m){if(1&a){const s=e.RV6();e.j41(0,"div",13)(1,"app-list-pagination-selectors",21),e.bIt("goPreviousPage",function(){e.eBV(s);const i=e.XpG();return e.Njj(i.onGoPreviousPage())})("goNextPage",function(){e.eBV(s);const i=e.XpG();return e.Njj(i.onGoNextPage())})("sort",function(i){e.eBV(s);const o=e.XpG();return e.Njj(o.onSort(i))}),e.k0s()()}if(2&a){const s=e.XpG();e.Y8G("ngClass",e.eq3(2,K,!s.isMainPage)),e.R7$(),e.Y8G("listPaginationConfig",e.s1E(4,U,s.updatePagination().startIndex,s.updatePagination().endIndex,s.allSystemOperationsCount,s.pagination.page+1,null!=s.sort&&s.sort.field?(null==s.sort?null:s.sort.field)+" "+(null==s.sort?null:s.sort.order):"Fecha de creaci\xf3n"))}}function ee(a,m){}function te(a,m){if(1&a){const s=e.RV6();e.qex(0),e.j41(1,"div",24),e.EFF(2," Registros pendientes "),e.k0s(),e.j41(3,"app-table",23),e.bIt("columnClick",function(i){e.eBV(s);const o=e.XpG(2);return e.Njj(o.onColumnClick(i))})("actionButtonClick",function(i){e.eBV(s);const o=e.XpG(2);return e.Njj(o.onTableButtonClick(i))})("rowClicked",function(i){e.eBV(s);const o=e.XpG(2);return e.Njj(o.onRowClicked(i))}),e.k0s(),e.bVm()}if(2&a){const s=e.XpG(2);e.R7$(3),e.Y8G("table",s.pendingRegistersTableConfig)}}function ie(a,m){if(1&a){const s=e.RV6();e.j41(0,"div",15),e.DNE(1,te,4,1,"ng-container"),e.j41(2,"div",22),e.EFF(3," Registros "),e.k0s(),e.j41(4,"app-table",23),e.bIt("columnClick",function(i){e.eBV(s);const o=e.XpG();return e.Njj(o.onColumnClick(i))})("actionButtonClick",function(i){e.eBV(s);const o=e.XpG();return e.Njj(o.onTableButtonClick(i))})("rowClicked",function(i){e.eBV(s);const o=e.XpG();return e.Njj(o.onRowClicked(i))}),e.k0s()()}if(2&a){const s=e.XpG();e.R7$(),e.vxM("promoter"==s.currentUser.accountType?1:-1),e.R7$(3),e.Y8G("table",s.registersTableConfig)}}function ne(a,m){}function oe(a,m){if(1&a&&(e.j41(0,"div",16),e.DNE(1,ne,0,0),e.k0s()),2&a){const s=e.XpG();e.R7$(),e.vxM("filters"===(null==s.aside?null:s.aside.type)?1:-1)}}let se=(()=>{var a;class m{constructor(t,i,o,l,c,g,d,r){this.popoversService=t,this.api=i,this.tableService=o,this.headerService=l,this.toastService=c,this.sanitizer=g,this.modalsService=d,this.byvaroState=r,this.isMainPage=!0,this.promotionId="",this.registers=[],this.pendingRegisters=[],this.allSystemOperationsCount=0,this.checkedOperations=0,this.searchString="",this.searchSubject=new D.B,this.aside={type:"filters",visible:!1},this.loadingList=!1,this.pipelineName="operaciones",this.showFilters=!1,this.sort={field:"createdAt",order:"desc"},this.pagination={page:0,itemsPerPage:50},this.relationsFilter={contact:{apply:!0,filter:{},onlyCount:!1},contactWithPotentialCoincidence:{apply:!0,filter:{},onlyCount:!1},agency:{apply:!0,filter:{},onlyCount:!1},createdBy:{apply:!0,filter:{},onlyCount:!1},property:{apply:!0,filter:{},onlyCount:!1},promotion:{apply:!0,filter:{},onlyCount:!1}},this.pendingRegistersTableConfig={uniqueId:"table-1",showSelectors:!0,columns:[{key:"createdAt",label:"Fecha de registro",size:"medium",type:"date"},{key:"contactName",label:"Contacto",size:"medium"},{key:"contactPhone",label:"Tel\xe9fono",size:"medium",fn:f=>{var p;return(null===(p=f.contactPhone)||void 0===p?void 0:p.length)>4?"****"+f.contactPhone.slice(-4):""}},{key:"contactNationality",label:"Nacionalidad",size:"medium"},{key:"promotion.projectName",label:"Promoci\xf3n",size:"medium"},{key:"agency.name",label:"Empresa",size:"medium"},{key:"createdBy.name",label:"Usuario",size:"medium"},{key:"status",label:"Estado",size:"medium"},{key:"actions",label:"",size:"small"},{key:"fecha_registro",label:"",size:"small"}],rows:[]},this.registersTableConfig={uniqueId:"table-1",showSelectors:!0,columns:[{key:"createdAt",label:"Fecha de registro",size:"medium",type:"date"},{key:"contactName",label:"Contacto",size:"medium"},{key:"contactPhone",label:"Tel\xe9fono",size:"medium"},{key:"contactNationality",label:"Nacionalidad",size:"medium"},{key:"promotion.projectName",label:"Promoci\xf3n",size:"medium"},{key:"agency.name",label:"Empresa",size:"medium"},{key:"createdBy.name",label:"Usuario",size:"medium"},{key:"status",label:"Estado",size:"medium"}],rows:[]}}getCurrentUser(){var t=this;return(0,_.A)(function*(){t.byvaroState.getState().subscribe(i=>{t.currentUser=i.user})})()}ngOnInit(){var t;this.getCurrentUser(),null!==(t=this.options)&&void 0!==t&&t.fatherObj&&this.getData()}ionViewWillEnter(){this.headerService.setConfig({title:"registers"}),this.getData()}getData(){var t=this;return(0,_.A)(function*(){yield t.getRegisters(),yield t.getPendingRegisters()})()}getRegisters(){var t=this;return(0,_.A)(function*(){var i,o,l;const c=O.cloneDeep(t.filters)||{};""!=t.searchString&&(c.OR=[{contactName:{contains:t.searchString,mode:"insensitive"}},{contactEmail:{contains:t.searchString,mode:"insensitive"}},{contactPhone:{contains:t.searchString,mode:"insensitive"}}]),c.status={not:"pending"},"agency"===(null===(i=t.options)||void 0===i?void 0:i.type)&&null!==(o=t.options)&&void 0!==o&&null!==(o=o.fatherObj)&&void 0!==o&&o.id&&(c.agencyId={equals:t.options.fatherObj.id},c.promotionId={equals:t.promotionId});const g=yield t.api.getOperationRegister(c,t.sort,t.pagination,t.relationsFilter);if(null!=g&&null!==(l=g.success)&&void 0!==l&&l.data){t.registers=g.success.data;let d=t.tableService.convertDataToTableRows(t.registers,t.registersTableConfig);d=t.tableService.setRowsChipsFromRegistersList(d),t.registersTableConfig.rows=d,d=d.map((r,f)=>{r.cells.actions={value:"none",type:"actions",actions:[{key:"asd",label:"Historico",theme:"warning",openRow:!0}]};let p=t.getTimeAgo(new Date(r.rawObject.createdAt));r.cells.fecha_registro={value:p,type:"text",customCssClass:"get-time-ago-class"};const n=r.rawObject;var h,C,y,P;return"yes"!==n.isAPotentiallyCoincidence&&"yes"!==(null==n?void 0:n.last4NumberOfPhoneAreEqual)&&(null==n?void 0:n.percentageOfNameCoincidence)<50&&(n.isAPotentiallyCoincidence="no"),r.freeRowContentHtml=`\n<div class="operation-register-container">\n  \x3c!-- Title / Header --\x3e\n  <h5 style="margin-top: 0;">\n    Resultado de Comprobaci\xf3n de Cliente\n  </h5>\n\n  \x3c!-- Main message --\x3e\n  <p style="margin: 0.5rem 0;">\n  ${"yes"===n.isAPotentiallyCoincidence?"Se encontr\xf3 una posible coincidencia en la base de datos para el cliente que intentas registrar.":""}\n  ${"no"===n.isAPotentiallyCoincidence?"No se encontr\xf3 ninguna coincidencia en la base de datos para el cliente que intentas registrar.":""}\n  ${"partial"===n.isAPotentiallyCoincidence?"Se encontr\xf3 una posible coincidencia parcial en la base de datos para el cliente que intentas registrar.":""}\n  </p>\n  `,n.contactWithPotentialCoincidenceId&&"no"!==n.isAPotentiallyCoincidence&&(r.freeRowContentHtml+=`\n      \x3c!-- ChatGPT scan info --\x3e\n      <hr style="margin: 1rem 0;" />\n      <p style="margin: 0.5rem 0;">\n        Posible coincidencia con el contacto: <a href="/contacts/${n.contactWithPotentialCoincidenceId}" target="_blank">${null===(h=n.contactWithPotentialCoincidence)||void 0===h?void 0:h.name}</a>\n        ${n.coincidenceRegistredBy?"Registrado por "+n.coincidenceRegistredBy:null!==(C=n.contactWithPotentialCoincidence)&&void 0!==C&&C.origin?"("+(null===(y=n.contactWithPotentialCoincidence)||void 0===y?void 0:y.origin)+")":""}\n        <br>\n        Fecha de registro: ${t.returnCorrectDateString(null===(P=n.contactWithPotentialCoincidence)||void 0===P?void 0:P.createdAt)}\n      </p>\n      <p style="margin: 0.5rem 0;">\n        Coincidencia en \xfaltimos 4 d\xedgitos de tel\xe9fono:\n        <strong>${"yes"===n.last4NumberOfPhoneAreEqual?"S\xed":"No"}:\n        ${"yes"===n.last4NumberOfPhoneAreEqual?n.coincidenceLast4NumberOfPhone:""}</strong>\n      </p>\n      <p style="margin: 0.5rem 0;">\n        Porcentaje de coincidencia de nombre:\n        <strong>${null!=n.percentageOfNameCoincidence?n.percentageOfNameCoincidence+"%":"N/A"}</strong>\n      </p>\n      <p style="margin: 0.5rem 0;">\n        Coincidencia de nacionalidad:\n        <strong>${n.nationalityCoincidence?"S\xed":"No"}</strong>\n      </p>\n\n      \x3c!-- Status and Acceptance/Rejection dates --\x3e\n      <hr style="margin: 1rem 0;" />\n      <p style="margin: 0.5rem 0;">\n        <strong>Recomendaci\xf3n mostrada:</strong><br/>\n        ${"yes"===n.isAPotentiallyCoincidence?"No Registres, muy probablemente este contacto ya est\xe1 registrado.":""}\n      ${"no"===n.isAPotentiallyCoincidence?"Registra, no se ha encontrado coincidencia en la base de datos.":""}\n      ${"partial"===n.isAPotentiallyCoincidence?"Antes de registrar revisa que el contacto no sea el duplicado":""}\n\n      </p>\n\n\n    `),r.freeRowContentHtml=t.sanitizer.bypassSecurityTrustHtml(r.freeRowContentHtml),r}),t.registersTableConfig.rows=d}})()}openCreateRegisterModal(){var t=this;return(0,_.A)(function*(){yield t.modalsService.onShowCreateRegisterModal(),t.getData()})()}getPendingRegisters(){var t=this;return(0,_.A)(function*(){var i,o,l;const c=O.cloneDeep(t.filters)||{};""!=t.searchString&&(c.OR=[{contactName:{contains:t.searchString,mode:"insensitive"}},{contactEmail:{contains:t.searchString,mode:"insensitive"}},{contactPhone:{contains:t.searchString,mode:"insensitive"}}]),c.status={equals:"pending"},"agency"===(null===(i=t.options)||void 0===i?void 0:i.type)&&null!==(o=t.options)&&void 0!==o&&null!==(o=o.fatherObj)&&void 0!==o&&o.id&&(c.agencyId={equals:t.options.fatherObj.id});const g=yield t.api.getOperationRegister(c,t.sort,t.pagination,t.relationsFilter);if(null!=g&&null!==(l=g.success)&&void 0!==l&&l.data){t.pendingRegisters=g.success.data;let d=t.tableService.convertDataToTableRows(t.pendingRegisters,t.pendingRegistersTableConfig);d=d.map((r,f)=>{r.cells.actions={value:"none",type:"actions",actions:[{key:"asd",label:"Gestionar",theme:"warning",openRow:!0}]};let p=t.getTimeAgo(new Date(r.rawObject.createdAt));r.cells.fecha_registro={value:p,type:"text",customCssClass:"get-time-ago-class"};const n=r.rawObject;var h,C,y,P;return r.freeRowContentHtml=`\n<div class="operation-register-container">\n  \x3c!-- Title / Header --\x3e\n  <h5 style="margin-top: 0;">\n    Resultado de Comprobaci\xf3n de Cliente\n  </h5>\n\n  \x3c!-- Main message --\x3e\n  <p style="margin: 0.5rem 0;">\n  ${"yes"===n.isAPotentiallyCoincidence?"Se ha encontrado una posible coincidencia en la base de datos para el cliente que intentas registrar.":""}\n  ${"no"===n.isAPotentiallyCoincidence?"No se ha encontrado ninguna coincidencia en la base de datos para el cliente que intentas registrar.":""}\n  ${"partial"===n.isAPotentiallyCoincidence?"Se ha encontrado una posible coincidencia parcial en la base de datos para el cliente que intentas registrar.":""}\n  </p>\n  `,"yes"!==n.isAPotentiallyCoincidence&&"yes"!==(null==n?void 0:n.last4NumberOfPhoneAreEqual)&&(null==n?void 0:n.percentageOfNameCoincidence)<50&&(n.isAPotentiallyCoincidence="no"),n.contactWithPotentialCoincidenceId&&"no"!==n.isAPotentiallyCoincidence&&(r.freeRowContentHtml+=`\n      \x3c!-- ChatGPT scan info --\x3e\n      <hr style="margin: 1rem 0;" />\n      <p style="margin: 0.5rem 0;">\n        Posible coincidencia con el contacto: <a href="/contacts/${n.contactWithPotentialCoincidenceId}" target="_blank">${null===(h=n.contactWithPotentialCoincidence)||void 0===h?void 0:h.name}</a>\n        ${n.coincidenceRegistredBy?"Registrado por "+n.coincidenceRegistredBy:null!==(C=n.contactWithPotentialCoincidence)&&void 0!==C&&C.origin?"("+(null===(y=n.contactWithPotentialCoincidence)||void 0===y?void 0:y.origin)+")":""}\n        <br>\n        Fecha de registro: ${t.returnCorrectDateString(null===(P=n.contactWithPotentialCoincidence)||void 0===P?void 0:P.createdAt)}\n      </p>\n      <p style="margin: 0.5rem 0;">\n        Coincidencia en \xfaltimos 4 d\xedgitos de tel\xe9fono:\n        <strong>${"yes"===n.last4NumberOfPhoneAreEqual?"S\xed:":"No"}\n        ${"yes"===n.last4NumberOfPhoneAreEqual?n.coincidenceLast4NumberOfPhone:""}</strong>\n      </p>\n      <p style="margin: 0.5rem 0;">\n        Porcentaje de coincidencia de nombre:\n        <strong>${null!=n.percentageOfNameCoincidence?n.percentageOfNameCoincidence+"%":"N/A"}</strong>\n      </p>\n      <p style="margin: 0.5rem 0;">\n        Coincidencia de nacionalidad:\n        <strong>${n.nationalityCoincidence?"S\xed":"No"}</strong>\n      </p>\n\n      \x3c!-- Status and Acceptance/Rejection dates --\x3e\n      <hr style="margin: 1rem 0;" />\n      <p style="margin: 0.5rem 0;">\n        <strong>Recomendaci\xf3n:</strong><br/>\n      ${"yes"===n.isAPotentiallyCoincidence?"No Registres, muy probablemente este contacto ya est\xe1 registrado.":""}\n      ${"no"===n.isAPotentiallyCoincidence?"Registra, no se ha encontrado coincidencia en la base de datos.":""}\n      ${"partial"===n.isAPotentiallyCoincidence?"Antes de registrar revisa que el contacto no sea el duplicado":""}\n\n      </p>\n\n\n    `),r.freeRowContentHtml+=`\n\n  <p style="margin: 0.5rem 0;">\n        <strong>Nota:</strong><br/>\n        Recuerda que el registro ser\xe1 v\xe1lido seg\xfan las condiciones establecidas para la comercializadora y quedar\xe1 sujeto a futuras verificaciones.\n      </p>\n\n      \x3c!-- Accept / Reject Buttons --\x3e\n      <div style="display:flex; align-items:center; gap: 16px; margin-top: 32px;">\n\n        <button id="register-accept-${n.id}" class="crm-button crm-button-success" style="min-width: 90px; justify-content: center;">\n          Aceptar\n        </button>\n        <button id="register-reject-${n.id}" class="crm-button crm-button-red" style="min-width: 90px; justify-content: center;">\n          Rechazar\n        </button>\n\n      </div>\n    </div>\n\n\n  `,r.freeRowContentHtml=t.sanitizer.bypassSecurityTrustHtml(r.freeRowContentHtml),r}),t.pendingRegistersTableConfig.rows=d}setTimeout(()=>{t.pendingRegisters.forEach(d=>{const r=document.getElementById(`register-accept-${d.id}`),f=document.getElementById(`register-reject-${d.id}`);r&&r.addEventListener("click",(0,_.A)(function*(){const p=yield t.acceptOperationRegister(d.id,d);null!=p&&p.success&&(t.getData(),t.toastService.showSuccessToast("Registro aceptado correctamente."))})),f&&f.addEventListener("click",(0,_.A)(function*(){const p=yield t.rejectOperationRegister(d.id);var n;null!=p&&p.success?(t.getData(),t.toastService.showSuccessToast("Registro rechazado correctamente.")):t.toastService.showErrorToast("Error al rechazar el registro. "+(null==p||null===(n=p.error)||void 0===n?void 0:n.errorMessage))}))})},1e3)})()}returnCorrectDateString(t){return t?new Date(t).toLocaleDateString():""}onTableButtonClick(t){var i=this;return(0,_.A)(function*(){if(console.log("LA DATA:",t),"accept"===t.action.key){const l=yield i.acceptOperationRegister(t.row.rawObject.id,null==t?void 0:t.row.rawObject);null!=l&&l.success&&(i.getData(),i.toastService.showSuccessToast("Registro aceptado correctamente."))}else if("reject"===t.action.key){const l=yield i.rejectOperationRegister(t.row.rawObject.id);var o;null!=l&&l.success?(i.getData(),i.toastService.showSuccessToast("Registro rechazado correctamente.")):i.toastService.showErrorToast("Error al rechazar el registro. "+(null==l||null===(o=l.error)||void 0===o?void 0:o.errorMessage))}})()}onRowClicked(t){return(0,_.A)(function*(){})()}acceptOperationRegister(t,i){var o=this;return(0,_.A)(function*(){var l;console.log("Accepting operation register:",i);const c=yield o.modalsService.onShowAcceptRegisterModal(i);if(console.log("Modal result:",c),null!=c&&null!==(l=c.data)&&void 0!==l&&l.confirmed){var g,d,r,f,p;if(null!=c&&null!==(g=c.data)&&void 0!==g&&null!==(g=g.data)&&void 0!==g&&g.confirmVisit&&null!=i&&null!==(d=i.visits)&&void 0!==d&&null!==(d=d[0])&&void 0!==d&&d.id){var n,h,C;const b={...null==i||null===(n=i.visits)||void 0===n?void 0:n[0],promoterResponsableUserId:null==c||null===(h=c.data)||void 0===h||null===(h=h.data)||void 0===h?void 0:h.agent,status:"accepted"},M=yield o.api.updateVisitById(null==i?void 0:i.visits[0].id,b);var y;if(null!=M&&null!==(C=M.error)&&void 0!==C&&C.errorMessage)return o.toastService.showErrorToast("Error al aceptar la visita. "+(null==M||null===(y=M.error)||void 0===y?void 0:y.errorMessage)),null;o.byvaroState.setRefreshVisitData(!0)}else if((null==c||null===(r=c.data)||void 0===r||null===(r=r.data)||void 0===r||!r.confirmVisit)&&null!=i&&null!==(f=i.visits)&&void 0!==f&&null!==(f=f[0])&&void 0!==f&&f.id){var P;const b=yield o.api.deleteVisitById(null==i?void 0:i.visits[0].id);var w;if(null!=b&&null!==(P=b.error)&&void 0!==P&&P.errorMessage)return o.toastService.showErrorToast("Error al aceptar la visita. "+(null==b||null===(w=b.error)||void 0===w?void 0:w.errorMessage)),null;o.byvaroState.setRefreshVisitData(!0)}const E=yield o.api.approveOperationRegister(t);var F;return null!=E&&null!==(p=E.error)&&void 0!==p&&p.errorMessage?(o.toastService.showErrorToast("Error al aceptar el registro. "+(null==E||null===(F=E.error)||void 0===F?void 0:F.errorMessage)),null):E}return console.log("Modal closed without confirmation"),null})()}rejectOperationRegister(t){var i=this;return(0,_.A)(function*(){return yield i.api.rejectOperationRegister(t)})()}onSearchInputChange(t){const i=t.target.value;clearTimeout(this.debounceTime),this.debounceTime=setTimeout(()=>{this.searchString=i,this.getData()},800)}onToggleAside(){this.aside.visible=!this.aside.visible}onGoNextPage(){(this.pagination.page+1)*this.pagination.itemsPerPage<this.allSystemOperationsCount&&(this.pagination.page++,this.getData())}onGoPreviousPage(){this.pagination.page>0&&(this.pagination.page--,this.getData())}onToggleAllCheckboxes(t){}onShowMenuSelectAll(t){}onSort(t){}getTimeAgo(t){const o=Math.floor(((new Date).getTime()-t.getTime())/1e3);if(o<60)return`Hace ${o} segundo${1===o?"":"s"}`;const l=Math.floor(o/60);if(l<60)return`Hace ${l} minuto${1===l?"":"s"}`;const c=Math.floor(l/60);if(c<24)return`Hace ${c} hora${1===c?"":"s"}`;const g=Math.floor(c/24);if(g<30)return`Hace ${g} d\xeda${1===g?"":"s"}`;const d=Math.floor(g/30);if(d<12)return`Hace ${d} mes${1===d?"":"es"}`;const r=Math.floor(d/12);return`Hace ${r} a\xf1o${1===r?"":"s"}`}onClickMoreTools(t){var i=this;return(0,_.A)(function*(){const o=yield i.popoversService.onShowMenuPopover(t,"contacts-list-more-tools");console.log("Popover result:",o)})()}updatePagination(){return{startIndex:this.pagination.page*this.pagination.itemsPerPage+1,endIndex:Math.min((this.pagination.page+1)*this.pagination.itemsPerPage,this.allSystemOperationsCount)}}onColumnClick(t){["createdAt","contactName","contactPhone","contactNationality","promotion.projectName","agency.name","createdBy.name","status"].includes(t.column.key)&&(this.sort={field:t.column.key,order:t.order},this.getData())}}return(a=m).\u0275fac=function(t){return new(t||a)(e.rXU(T.m),e.rXU(k.i),e.rXU(L.a),e.rXU(I.d),e.rXU(B.f),e.rXU(x.up),e.rXU(G.M),e.rXU(v.c))},a.\u0275cmp=e.VBU({type:a,selectors:[["app-registers-list"]],inputs:{options:"options",isMainPage:"isMainPage",promotionId:"promotionId"},decls:20,vars:15,consts:[[1,"crm-block-body"],[3,"ngClass"],[1,"crm-header-modal",3,"ngClass"],[1,"crm-input"],[1,"crm-input-input","crm-input-input-searchbar"],[1,"fas","fa-search"],["type","text","placeholder","Buscar registro",3,"input"],[1,"crm-buttons-group"],[1,"crm-button"],[1,"crm-button-secondary",3,"click","ngClass"],[1,"crm-button-secondary","crm-button-secondary-icon-solo",3,"click"],[1,"fa","fa-ellipsis"],[1,"pagination-container"],[1,"pagination-container",3,"ngClass"],[1,"crm-block-body-blue-content"],[1,"crm-section"],[1,"crm-block-content-aside"],[1,"crm-button",3,"click"],[1,"fa","fa-plus"],[1,"fa","fa-times"],[1,"fa","fa-filter"],[3,"goPreviousPage","goNextPage","sort","listPaginationConfig"],[1,"crm-section-title","crm-section-margin-top"],[3,"columnClick","actionButtonClick","rowClicked","table"],[1,"crm-section-title"]],template:function(t,i){1&t&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),e.nrm(5,"i",5),e.j41(6,"input",6),e.bIt("input",function(l){return i.onSearchInputChange(l)}),e.k0s()()(),e.j41(7,"div",7),e.DNE(8,W,3,0,"button",8),e.j41(9,"button",9),e.bIt("click",function(){return i.onToggleAside()}),e.DNE(10,Y,2,0)(11,J,2,1),e.k0s(),e.j41(12,"button",10),e.bIt("click",function(l){return i.onClickMoreTools(l)}),e.nrm(13,"i",11),e.k0s()()(),e.DNE(14,Q,2,7,"div",12),e.k0s(),e.DNE(15,Z,2,10,"div",13),e.j41(16,"div",14),e.DNE(17,ee,0,0)(18,ie,5,2,"div",15),e.k0s()(),e.DNE(19,oe,2,1,"div",16)),2&t&&(e.R7$(),e.Y8G("ngClass",e.eq3(9,z,!(null!=i.options&&i.options.fatherObj))),e.R7$(),e.Y8G("ngClass",e.eq3(11,X,!i.isMainPage)),e.R7$(6),e.vxM(null!=i.options&&i.options.fatherObj?-1:8),e.R7$(),e.Y8G("ngClass",e.eq3(13,H,!("filters"===(null==i.aside?null:i.aside.type)&&null!=i.aside&&i.aside.visible)&&i.filters)),e.R7$(),e.vxM("filters"===(null==i.aside?null:i.aside.type)&&null!=i.aside&&i.aside.visible?10:11),e.R7$(4),e.vxM(null!=i.options&&i.options.fatherObj?-1:14),e.R7$(),e.vxM(null!=i.options&&i.options.fatherObj?15:-1),e.R7$(2),e.vxM(i.loadingList?17:18),e.R7$(2),e.vxM(null!=i.aside&&i.aside.visible?19:-1))},dependencies:[R.YU,A.O,j.k],styles:[".pagination-container[_ngcontent-%COMP%]{background-color:#fff}.embedded-page-header[_ngcontent-%COMP%], .embedded-pagination-container[_ngcontent-%COMP%]{width:98%;margin:0 auto}"]}),m})()}}]);