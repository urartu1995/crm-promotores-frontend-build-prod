"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3070],{3070:(yn,Y,l)=>{l.r(Y),l.d(Y,{PromotionDetailsPageModule:()=>un});var u=l(177),c=l(9417),g=l(9465),R=l(5188),C=l(467),t=l(3953),B=l(2081),at=l(4501),N=l(8397),G=l(6552),V=l(1213),rt=l(5786),P=l(3955),X=l(2606),lt=l(2465),mt=l(9604),ct=l(4821),dt=l(4426),pt=l(8323),_t=l(5180),U=l(293),w=l(8857),A=l(7221),y=l(7376),E=l(1792),D=l(8129);const ut=e=>({"crm-section-disabled-inputs":e}),gt=(e,a)=>({"fa-solid fa-chevron-down":e,"fa-solid fa-chevron-up":a});function vt(e,a){if(1&e){const o=t.RV6();t.j41(0,"button",7),t.bIt("click",function(){t.eBV(o);const n=t.XpG(2);return t.Njj(n.onEdit())}),t.nrm(1,"i",8),t.EFF(2),t.nI1(3,"translate"),t.k0s()}if(2&e){const o=t.XpG(2);t.Y8G("appLoadingButton",o.loadingButton),t.R7$(2),t.SpI(" ",t.bMT(3,2,"text.edit")," ")}}function yt(e,a){if(1&e&&t.DNE(0,vt,4,4,"button",6),2&e){const o=t.XpG();t.Y8G("ngIf","promoter"===(null==o.currentUser?null:o.currentUser.accountType))}}function ht(e,a){if(1&e){const o=t.RV6();t.j41(0,"button",10),t.bIt("click",function(){t.eBV(o);const n=t.XpG(2);return t.Njj(n.onSave())}),t.nrm(1,"i",11),t.EFF(2),t.nI1(3,"translate"),t.k0s()}if(2&e){const o=t.XpG(2);t.Y8G("appLoadingButton",o.loadingButton),t.R7$(2),t.SpI(" ",t.bMT(3,2,"text.save")," ")}}function bt(e,a){if(1&e&&t.DNE(0,ht,4,4,"button",9),2&e){const o=t.XpG();t.Y8G("ngIf","promoter"===(null==o.currentUser?null:o.currentUser.accountType))}}function Pt(e,a){if(1&e){const o=t.RV6();t.j41(0,"div",30)(1,"ion-checkbox",31),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG(3);return t.DH7(s.promotion.freeSell,n)||(s.promotion.freeSell=n),t.Njj(n)}),t.k0s()()}if(2&e){const o=t.XpG(3);t.R7$(),t.R50("ngModel",o.promotion.freeSell)}}function Ct(e,a){if(1&e){const o=t.RV6();t.j41(0,"div",32),t.bIt("click",function(){t.eBV(o);const n=t.XpG(3);return t.Njj(n.promotion.freeSell=!n.promotion.freeSell)}),t.j41(1,"div",1),t.EFF(2),t.nI1(3,"translate"),t.k0s()()}2&e&&(t.R7$(2),t.SpI(" ",t.bMT(3,1,"text.free_sale")," "))}function ft(e,a){1&e&&(t.j41(0,"div",33),t.nrm(1,"i",34),t.j41(2,"div",35),t.EFF(3),t.nI1(4,"translate"),t.k0s()()),2&e&&(t.R7$(3),t.SpI(" ",t.bMT(4,1,"text.free_sale_warning")," "))}function Dt(e,a){if(1&e){const o=t.RV6();t.j41(0,"div",15),t.EFF(1),t.nI1(2,"translate"),t.k0s(),t.j41(3,"div",16)(4,"div",17)(5,"div",18),t.EFF(6),t.nI1(7,"translate"),t.k0s(),t.j41(8,"div",19)(9,"input",20),t.nI1(10,"translate"),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG(2);return t.DH7(s.promotion.sellCommissionPercentage,n)||(s.promotion.sellCommissionPercentage=n),t.Njj(n)}),t.k0s(),t.j41(11,"div",21),t.EFF(12," % "),t.k0s()()(),t.j41(13,"div",17)(14,"div",18),t.EFF(15),t.nI1(16,"translate"),t.k0s(),t.j41(17,"div",19)(18,"select",22),t.nI1(19,"translate"),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG(2);return t.DH7(s.promotion.sellCommissionTaxes,n)||(s.promotion.sellCommissionTaxes=n),t.Njj(n)}),t.j41(20,"option",23),t.EFF(21),t.nI1(22,"translate"),t.k0s(),t.j41(23,"option",24),t.EFF(24),t.nI1(25,"translate"),t.k0s()()()()(),t.j41(26,"div",25)(27,"div",26),t.DNE(28,Pt,2,1,"div",27)(29,Ct,4,3,"div",28),t.k0s()(),t.DNE(30,ft,5,3,"div",29)}if(2&e){const o=t.XpG(2);t.R7$(),t.SpI(" ",t.bMT(2,18,"text.sale_commission_title"),"\n"),t.R7$(5),t.SpI(" ",t.bMT(7,20,"text.sale_commission")," "),t.R7$(2),t.Y8G("appInputViewMode",o.isDisabled)("externalInputValue",o.promotion.sellCommissionPercentage),t.R7$(),t.Y8G("disabled",o.isDisabled)("placeholder",t.bMT(10,22,"text.name")),t.R50("ngModel",o.promotion.sellCommissionPercentage),t.R7$(6),t.SpI(" ",t.bMT(16,24,"text.vat")," "),t.R7$(2),t.Y8G("appInputViewMode",o.isDisabled)("externalInputValue",o.promotion.sellCommissionTaxes),t.R7$(),t.Y8G("disabled",o.isDisabled),t.R50("ngModel",o.promotion.sellCommissionTaxes),t.BMQ("placeholder",t.bMT(19,26,"text.select")),t.R7$(3),t.JRh(t.bMT(22,28,"text.vat_included")),t.R7$(3),t.JRh(t.bMT(25,30,"text.vat_not_included")),t.R7$(4),t.Y8G("ngIf",!o.isDisabled),t.R7$(),t.Y8G("ngIf",o.isDisabled&&o.promotion.freeSell||!o.isDisabled),t.R7$(),t.Y8G("ngIf",(null==o.promotion?null:o.promotion.freeSell)&&!o.isDisabled)}}function xt(e,a){if(1&e){const o=t.RV6();t.j41(0,"button",36),t.bIt("click",function(){t.eBV(o);const n=t.XpG(2);return t.Njj(n.showAdvancedOptions=!n.showAdvancedOptions)}),t.nrm(1,"i",12),t.EFF(2),t.nI1(3,"translate"),t.k0s()}if(2&e){const o=t.XpG(2);t.R7$(),t.Y8G("ngClass",t.l_i(4,gt,!o.showAdvancedOptions,o.showAdvancedOptions)),t.R7$(),t.SpI(" ",t.bMT(3,2,"text.show_advanced_options"),"\n")}}function It(e,a){if(1&e){const o=t.RV6();t.j41(0,"div",15),t.EFF(1),t.nI1(2,"translate"),t.k0s(),t.j41(3,"div",16)(4,"div",17)(5,"div",18),t.EFF(6),t.nI1(7,"translate"),t.k0s(),t.j41(8,"div",19)(9,"input",20),t.nI1(10,"translate"),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG(3);return t.DH7(s.promotion.nationalCustomersComissionPercentage,n)||(s.promotion.nationalCustomersComissionPercentage=n),t.Njj(n)}),t.k0s(),t.j41(11,"div",21),t.EFF(12," % "),t.k0s()()(),t.j41(13,"div",17)(14,"div",18),t.EFF(15),t.nI1(16,"translate"),t.k0s(),t.j41(17,"div",19)(18,"select",22),t.nI1(19,"translate"),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG(3);return t.DH7(s.promotion.nationalCustomersComissionTaxes,n)||(s.promotion.nationalCustomersComissionTaxes=n),t.Njj(n)}),t.j41(20,"option",37),t.EFF(21),t.nI1(22,"translate"),t.k0s(),t.j41(23,"option",24),t.EFF(24),t.nI1(25,"translate"),t.k0s()()()()()}if(2&e){const o=t.XpG(3);t.R7$(),t.SpI(" ",t.bMT(2,15,"text.commission_national_clients")," "),t.R7$(5),t.SpI(" ",t.bMT(7,17,"text.sale_commission")," "),t.R7$(2),t.Y8G("appInputViewMode",o.isDisabled)("externalInputValue",o.promotion.nationalCustomersComissionPercentage),t.R7$(),t.Y8G("disabled",o.isDisabled)("placeholder",t.bMT(10,19,"text.name")),t.R50("ngModel",o.promotion.nationalCustomersComissionPercentage),t.R7$(6),t.SpI(" ",t.bMT(16,21,"text.vat")," "),t.R7$(2),t.Y8G("appInputViewMode",o.isDisabled)("externalInputValue",o.promotion.nationalCustomersComissionTaxes),t.R7$(),t.Y8G("disabled",o.isDisabled),t.R50("ngModel",o.promotion.nationalCustomersComissionTaxes),t.BMQ("placeholder",t.bMT(19,23,"text.select")),t.R7$(3),t.JRh(t.bMT(22,25,"text.vat_included")),t.R7$(3),t.JRh(t.bMT(25,27,"text.vat_not_included"))}}function Rt(e,a){if(1&e){const o=t.RV6();t.j41(0,"div",38),t.EFF(1),t.nI1(2,"translate"),t.k0s(),t.j41(3,"div",16)(4,"div",17)(5,"div",18),t.EFF(6),t.nI1(7,"translate"),t.k0s(),t.j41(8,"div",19)(9,"input",20),t.nI1(10,"translate"),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG(3);return t.DH7(s.promotion.internationalCustomersComissionPercentage,n)||(s.promotion.internationalCustomersComissionPercentage=n),t.Njj(n)}),t.k0s(),t.j41(11,"div",21),t.EFF(12," % "),t.k0s()()(),t.j41(13,"div",17)(14,"div",18),t.EFF(15),t.nI1(16,"translate"),t.k0s(),t.j41(17,"div",19)(18,"select",22),t.nI1(19,"translate"),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG(3);return t.DH7(s.promotion.internationalCustomersComissionTaxes,n)||(s.promotion.internationalCustomersComissionTaxes=n),t.Njj(n)}),t.j41(20,"option",37),t.EFF(21),t.nI1(22,"translate"),t.k0s(),t.j41(23,"option",24),t.EFF(24),t.nI1(25,"translate"),t.k0s()()()()()}if(2&e){const o=t.XpG(3);t.R7$(),t.SpI(" ",t.bMT(2,15,"text.commission_international_clients"),"\n"),t.R7$(5),t.SpI(" ",t.bMT(7,17,"text.sale_commission")," "),t.R7$(2),t.Y8G("appInputViewMode",o.isDisabled)("externalInputValue",o.promotion.internationalCustomersComissionPercentage),t.R7$(),t.Y8G("disabled",o.isDisabled)("placeholder",t.bMT(10,19,"text.name")),t.R50("ngModel",o.promotion.internationalCustomersComissionPercentage),t.R7$(6),t.SpI(" ",t.bMT(16,21,"text.vat")," "),t.R7$(2),t.Y8G("appInputViewMode",o.isDisabled)("externalInputValue",o.promotion.internationalCustomersComissionTaxes),t.R7$(),t.Y8G("disabled",o.isDisabled),t.R50("ngModel",o.promotion.internationalCustomersComissionTaxes),t.BMQ("placeholder",t.bMT(19,23,"text.select")),t.R7$(3),t.JRh(t.bMT(22,25,"text.vat_included")),t.R7$(3),t.JRh(t.bMT(25,27,"text.vat_not_included"))}}function Mt(e,a){if(1&e){const o=t.RV6();t.j41(0,"div",38),t.EFF(1),t.nI1(2,"translate"),t.k0s(),t.j41(3,"div",16)(4,"div",17)(5,"div",18),t.EFF(6),t.nI1(7,"translate"),t.k0s(),t.j41(8,"div",19)(9,"input",20),t.nI1(10,"translate"),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG(3);return t.DH7(s.promotion.collaboratorsNoAccompanyingCustomersToVisitPercentage,n)||(s.promotion.collaboratorsNoAccompanyingCustomersToVisitPercentage=n),t.Njj(n)}),t.k0s(),t.j41(11,"div",21),t.EFF(12," % "),t.k0s()()(),t.j41(13,"div",17)(14,"div",18),t.EFF(15),t.nI1(16,"translate"),t.k0s(),t.j41(17,"div",19)(18,"select",22),t.nI1(19,"translate"),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG(3);return t.DH7(s.promotion.collaboratorsNoAccompanyingCustomersToVisitTaxes,n)||(s.promotion.collaboratorsNoAccompanyingCustomersToVisitTaxes=n),t.Njj(n)}),t.j41(20,"option",37),t.EFF(21),t.nI1(22,"translate"),t.k0s(),t.j41(23,"option",24),t.EFF(24),t.nI1(25,"translate"),t.k0s()()()()()}if(2&e){const o=t.XpG(3);t.R7$(),t.SpI(" ",t.bMT(2,15,"text.commission_collaborators_no_visit"),"\n"),t.R7$(5),t.SpI(" ",t.bMT(7,17,"text.sale_commission")," "),t.R7$(2),t.Y8G("appInputViewMode",o.isDisabled)("externalInputValue",o.promotion.collaboratorsNoAccompanyingCustomersToVisitPercentage),t.R7$(),t.Y8G("disabled",o.isDisabled)("placeholder",t.bMT(10,19,"text.name")),t.R50("ngModel",o.promotion.collaboratorsNoAccompanyingCustomersToVisitPercentage),t.R7$(6),t.SpI(" ",t.bMT(16,21,"text.vat")," "),t.R7$(2),t.Y8G("appInputViewMode",o.isDisabled)("externalInputValue",o.promotion.collaboratorsNoAccompanyingCustomersToVisitTaxes),t.R7$(),t.Y8G("disabled",o.isDisabled),t.R50("ngModel",o.promotion.collaboratorsNoAccompanyingCustomersToVisitTaxes),t.BMQ("placeholder",t.bMT(19,23,"text.select")),t.R7$(3),t.JRh(t.bMT(22,25,"text.vat_included")),t.R7$(3),t.JRh(t.bMT(25,27,"text.vat_not_included"))}}function Ft(e,a){if(1&e){const o=t.RV6();t.j41(0,"div",38),t.EFF(1),t.nI1(2,"translate"),t.k0s(),t.j41(3,"div",16)(4,"div",17)(5,"div",18),t.EFF(6),t.nI1(7,"translate"),t.k0s(),t.j41(8,"div",19)(9,"input",20),t.nI1(10,"translate"),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG(3);return t.DH7(s.promotion.referralCommissionPercentage,n)||(s.promotion.referralCommissionPercentage=n),t.Njj(n)}),t.k0s(),t.j41(11,"div",21),t.EFF(12," % "),t.k0s()()(),t.j41(13,"div",17)(14,"div",18),t.EFF(15),t.nI1(16,"translate"),t.k0s(),t.j41(17,"div",19)(18,"select",22),t.nI1(19,"translate"),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG(3);return t.DH7(s.promotion.referralCommissionTaxes,n)||(s.promotion.referralCommissionTaxes=n),t.Njj(n)}),t.j41(20,"option",37),t.EFF(21),t.nI1(22,"translate"),t.k0s(),t.j41(23,"option",24),t.EFF(24),t.nI1(25,"translate"),t.k0s()()()()()}if(2&e){const o=t.XpG(3);t.R7$(),t.SpI(" ",t.bMT(2,15,"text.commission_referral_clients"),"\n"),t.R7$(5),t.SpI(" ",t.bMT(7,17,"text.sale_commission")," "),t.R7$(2),t.Y8G("appInputViewMode",o.isDisabled)("externalInputValue",o.promotion.referralCommissionPercentage),t.R7$(),t.Y8G("disabled",o.isDisabled)("placeholder",t.bMT(10,19,"text.name")),t.R50("ngModel",o.promotion.referralCommissionPercentage),t.R7$(6),t.SpI(" ",t.bMT(16,21,"text.vat")," "),t.R7$(2),t.Y8G("appInputViewMode",o.isDisabled)("externalInputValue",o.promotion.referralCommissionTaxes),t.R7$(),t.Y8G("disabled",o.isDisabled),t.R50("ngModel",o.promotion.referralCommissionTaxes),t.BMQ("placeholder",t.bMT(19,23,"text.select")),t.R7$(3),t.JRh(t.bMT(22,25,"text.vat_included")),t.R7$(3),t.JRh(t.bMT(25,27,"text.vat_not_included"))}}function Tt(e,a){if(1&e&&(t.j41(0,"div"),t.DNE(1,It,26,29)(2,Rt,26,29)(3,Mt,26,29)(4,Ft,26,29),t.k0s()),2&e){const o=t.XpG(2);t.R7$(),t.vxM(o.isDisabled&&o.promotion.nationalCustomersComissionPercentage||!o.isDisabled?1:-1),t.R7$(),t.vxM(o.isDisabled&&o.promotion.internationalCustomersComissionPercentage||!o.isDisabled?2:-1),t.R7$(),t.vxM(o.isDisabled&&o.promotion.collaboratorsNoAccompanyingCustomersToVisitPercentage||!o.isDisabled?3:-1),t.R7$(),t.vxM(o.isDisabled&&o.promotion.referralCommissionPercentage||!o.isDisabled?4:-1)}}function kt(e,a){if(1&e&&(t.j41(0,"div",12),t.DNE(1,Dt,31,32)(2,xt,4,7,"button",13)(3,Tt,5,4,"div",14),t.k0s()),2&e){const o=t.XpG();t.Y8G("ngClass",t.eq3(4,ut,o.isDisabled)),t.R7$(),t.vxM(o.isDisabled&&(!o.isDisabled||null!=o.promotion&&o.promotion.nationalCustomersComissionPercentage||null!=o.promotion&&o.promotion.internationalCustomersComissionPercentage||null!=o.promotion&&o.promotion.collaboratorsNoAccompanyingCustomersToVisitPercentage||null!=o.promotion&&o.promotion.referralCommissionPercentage)?-1:1),t.R7$(),t.Y8G("ngIf",!o.isDisabled),t.R7$(),t.Y8G("ngIf",!o.isDisabled&&o.showAdvancedOptions||o.isDisabled)}}let O=(()=>{var e;class a{constructor(){this.promotionUpdated=new t.bkB,this.loadingButton=!1,this.isDisabled=!0,this.showAdvancedOptions=!1}ngOnInit(){}set promotionData(i){this.promotion=i}onEdit(){this.isDisabled=!this.isDisabled}onSave(){this.savePromotion(),this.isDisabled=!0}savePromotion(){this.promotionUpdated.emit({sellCommissionPercentage:this.promotion.sellCommissionPercentage,sellCommissionTaxes:this.promotion.sellCommissionTaxes,freeSell:this.promotion.freeSell,nationalCustomersComissionPercentage:this.promotion.nationalCustomersComissionPercentage,nationalCustomersComissionTaxes:this.promotion.nationalCustomersComissionTaxes,internationalCustomersComissionPercentage:this.promotion.internationalCustomersComissionPercentage,internationalCustomersComissionTaxes:this.promotion.internationalCustomersComissionTaxes,collaboratorsNoAccompanyingCustomersToVisitPercentage:this.promotion.collaboratorsNoAccompanyingCustomersToVisitPercentage,collaboratorsNoAccompanyingCustomersToVisitTaxes:this.promotion.collaboratorsNoAccompanyingCustomersToVisitTaxes,referralCommissionPercentage:this.promotion.referralCommissionPercentage,referralCommissionTaxes:this.promotion.referralCommissionTaxes})}}return(e=a).\u0275fac=function(i){return new(i||e)},e.\u0275cmp=t.VBU({type:e,selectors:[["app-promotion-payments-details-commission"]],inputs:{currentUser:"currentUser"},outputs:{promotionUpdated:"promotionUpdated"},decls:6,vars:2,consts:[[1,"crm-header-modal","crm-header-modal-empty"],[1,"crm-section-smaller-title"],[1,"crm-buttons-group"],[1,"crm-button-secondary","crm-button-secondary-primary",3,"appLoadingButton"],[1,"crm-button","crm-button-success",3,"appLoadingButton"],[3,"ngClass",4,"ngIf"],["class","crm-button-secondary crm-button-secondary-primary",3,"appLoadingButton","click",4,"ngIf"],[1,"crm-button-secondary","crm-button-secondary-primary",3,"click","appLoadingButton"],[1,"fa-solid","fa-edit"],["class","crm-button crm-button-success",3,"appLoadingButton","click",4,"ngIf"],[1,"crm-button","crm-button-success",3,"click","appLoadingButton"],[1,"fa-solid","fa-check"],[3,"ngClass"],["class","crm-button-secondary crm-button-secondary-primary crm-section-margin-top crm-section-margin-bottom",3,"click",4,"ngIf"],[4,"ngIf"],[1,"crm-title-14"],[1,"crm-section-inputs-double-input","crm-section-margin-top"],[1,"crm-input"],[1,"crm-input-label"],[1,"crm-input-input",3,"appInputViewMode","externalInputValue"],["type","number",3,"ngModelChange","disabled","placeholder","ngModel"],[1,"crm-input-input-symbol"],[3,"ngModelChange","disabled","ngModel"],["value","iva"],["value","no_iva"],[1,"crm-section-inline-checkboxes","crm-section-margin-top",2,"margin-top","24px"],[1,"crm-card-user-header"],["class","crm-input-checkbox",4,"ngIf"],["class","crm-card-user-header-data",3,"click",4,"ngIf"],["class","crm-info-banner red-icon",4,"ngIf"],[1,"crm-input-checkbox"],[3,"ngModelChange","ngModel"],[1,"crm-card-user-header-data",3,"click"],[1,"crm-info-banner","red-icon"],[1,"fa-solid","fa-triangle-exclamation"],[1,"crm-text"],[1,"crm-button-secondary","crm-button-secondary-primary","crm-section-margin-top","crm-section-margin-bottom",3,"click"],["value","iva","default",""],[1,"crm-title-14","crm-section-margin-top"]],template:function(i,n){1&i&&(t.j41(0,"div",0),t.nrm(1,"div",1),t.j41(2,"div",2),t.DNE(3,yt,1,1,"button",3)(4,bt,1,1,"button",4),t.k0s()(),t.DNE(5,kt,4,6,"div",5)),2&i&&(t.R7$(3),t.vxM(n.isDisabled?3:4),t.R7$(2),t.Y8G("ngIf",n.promotion))},dependencies:[u.YU,u.bT,c.xH,c.y7,c.me,c.Q0,c.wz,c.BC,c.vS,g.eY,g.hB,E.M,D.K,P.D9],styles:[".crm-header-modal-empty[_ngcontent-%COMP%]{padding-right:0;padding-left:0}"]}),a})();const jt=e=>({"crm-section-disabled-inputs":e}),L=e=>({"crm-section-invisible":e}),J=e=>({opacity:e}),S=e=>({"crm-input-input-error":e}),W=e=>({value:e});function Gt(e,a){if(1&e){const o=t.RV6();t.j41(0,"button",7),t.bIt("click",function(){t.eBV(o);const n=t.XpG(2);return t.Njj(n.onEdit())}),t.nrm(1,"i",8),t.EFF(2),t.nI1(3,"translate"),t.k0s()}if(2&e){const o=t.XpG(2);t.Y8G("appLoadingButton",o.loadingButton),t.R7$(2),t.SpI(" ",t.bMT(3,2,"text.edit")," ")}}function Et(e,a){if(1&e&&t.DNE(0,Gt,4,4,"button",6),2&e){const o=t.XpG();t.Y8G("ngIf","promoter"===(null==o.currentUser?null:o.currentUser.accountType))}}function St(e,a){if(1&e){const o=t.RV6();t.j41(0,"button",10),t.bIt("click",function(){t.eBV(o);const n=t.XpG(2);return t.Njj(n.onSave())}),t.nrm(1,"i",11),t.EFF(2),t.nI1(3,"translate"),t.k0s()}if(2&e){const o=t.XpG(2);t.Y8G("appLoadingButton",o.loadingButton),t.R7$(2),t.SpI(" ",t.bMT(3,2,"text.save")," ")}}function $t(e,a){if(1&e&&t.DNE(0,St,4,4,"button",9),2&e){const o=t.XpG();t.Y8G("ngIf","promoter"===(null==o.currentUser?null:o.currentUser.accountType))}}function Bt(e,a){if(1&e){const o=t.RV6();t.j41(0,"div",41)(1,"ion-checkbox",42),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG(2);return t.DH7(s.promotion.deliveryDateModalityByStatus,n)||(s.promotion.deliveryDateModalityByStatus=n),t.Njj(n)}),t.bIt("ionChange",function(){t.eBV(o);const n=t.XpG(2);return t.Njj(n.onSelectModality("deliveryDateModalityByStatus"))}),t.k0s()()}if(2&e){const o=t.XpG(2);t.R7$(),t.R50("ngModel",o.promotion.deliveryDateModalityByStatus)}}function Nt(e,a){1&e&&(t.j41(0,"div",43),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"text.construction_status_required")," "))}function Vt(e,a){1&e&&(t.EFF(0),t.nI1(1,"translate")),2&e&&t.SpI(" ",t.bMT(1,1,"text.deliverys_date.completion_date")," ")}function Yt(e,a){1&e&&(t.EFF(0),t.nI1(1,"translate")),2&e&&t.SpI(" ",t.bMT(1,1,"text.deliverys_date.key_delivery")," ")}function Xt(e,a){1&e&&(t.j41(0,"div",43),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"text.deliverys_date.required")," "))}function Ut(e,a){1&e&&(t.EFF(0),t.nI1(1,"translate")),2&e&&t.SpI(" ",t.bMT(1,1,"text.apply_to_all_units")," ")}function wt(e,a){1&e&&(t.EFF(0),t.nI1(1,"translate")),2&e&&t.SpI(" ",t.bMT(1,1,"text.different_dates_per_unit")," ")}function At(e,a){if(1&e&&(t.j41(0,"div",44),t.DNE(1,Ut,2,3)(2,wt,2,3),t.k0s()),2&e){const o=t.XpG(2);t.R7$(),t.vxM(null!=o.promotion&&o.promotion.applyingDeliveryDateForAllProperties?1:2)}}function Ot(e,a){1&e&&(t.j41(0,"div",43),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"text.select_option_required")," "))}function Lt(e,a){if(1&e){const o=t.RV6();t.j41(0,"div",45)(1,"ion-radio-group",46),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG(2);return t.DH7(s.promotion.applyingDeliveryDateForAllProperties,n)||(s.promotion.applyingDeliveryDateForAllProperties=n),t.Njj(n)}),t.j41(2,"div",47),t.nrm(3,"ion-radio",48),t.j41(4,"div",49),t.EFF(5),t.nI1(6,"translate"),t.k0s()(),t.j41(7,"div",47),t.nrm(8,"ion-radio",48),t.j41(9,"div",49),t.EFF(10),t.nI1(11,"translate"),t.k0s()()(),t.DNE(12,Ot,3,3,"div",33),t.k0s()}if(2&e){const o=t.XpG(2);t.Y8G("appInputViewMode",o.isDisabled)("externalInputValue",o.promotion.applyingDeliveryDateForAllProperties),t.R7$(),t.R50("ngModel",o.promotion.applyingDeliveryDateForAllProperties),t.Y8G("ngClass",t.eq3(13,S,o.isFieldInvalid("applyingDeliveryDateForAllProperties","status"))),t.R7$(2),t.Y8G("value",!0),t.R7$(2),t.SpI(" ",t.bMT(6,9,"text.apply_to_all_units")," "),t.R7$(3),t.Y8G("value",!1),t.R7$(2),t.SpI(" ",t.bMT(11,11,"text.different_dates_per_unit")," "),t.R7$(2),t.Y8G("ngIf",o.isFieldInvalid("applyingDeliveryDateForAllProperties","status"))}}function Jt(e,a){if(1&e){const o=t.RV6();t.j41(0,"div",41)(1,"ion-checkbox",42),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG(2);return t.DH7(s.promotion.deliveryDateModalityByMonths,n)||(s.promotion.deliveryDateModalityByMonths=n),t.Njj(n)}),t.bIt("ionChange",function(){t.eBV(o);const n=t.XpG(2);return t.Njj(n.onSelectModality("deliveryDateModalityByMonths"))}),t.k0s()()}if(2&e){const o=t.XpG(2);t.R7$(),t.R50("ngModel",o.promotion.deliveryDateModalityByMonths)}}function Wt(e,a){if(1&e&&(t.j41(0,"option",48),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e){const o=a.$implicit;t.Y8G("value",o),t.R7$(),t.JRh(t.i5U(2,2,"text.months_label",t.eq3(5,W,o)))}}function Ht(e,a){if(1&e){const o=t.RV6();t.j41(0,"div",50)(1,"select",51),t.nI1(2,"translate"),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG(2);return t.DH7(s.promotion.deliveryDateModalityByMonthsValue,n)||(s.promotion.deliveryDateModalityByMonthsValue=n),t.Njj(n)}),t.DNE(3,Wt,3,7,"option",52),t.k0s()()}if(2&e){const o=t.XpG(2);t.R7$(),t.R50("ngModel",o.promotion.deliveryDateModalityByMonthsValue),t.Y8G("disabled",o.isDisabled),t.BMQ("placeholder",t.bMT(2,4,"text.select")),t.R7$(2),t.Y8G("ngForOf",o.months)}}function Qt(e,a){if(1&e&&(t.j41(0,"span"),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e){const o=t.XpG(3);t.R7$(),t.SpI(" ",t.i5U(2,1,"text.months_label",t.eq3(4,W,o.promotion.deliveryDateModalityByMonthsValue))," ")}}function zt(e,a){if(1&e&&(t.j41(0,"div",53),t.DNE(1,Qt,3,6,"span",54),t.k0s()),2&e){const o=t.XpG(2);t.R7$(),t.Y8G("ngIf",o.promotion.deliveryDateModalityByMonthsValue)}}function qt(e,a){1&e&&(t.EFF(0),t.nI1(1,"translate")),2&e&&t.SpI(" ",t.bMT(1,1,"text.from_contract_signature")," ")}function Kt(e,a){1&e&&(t.EFF(0),t.nI1(1,"translate")),2&e&&t.SpI(" ",t.bMT(1,1,"text.from_license_obtaining")," ")}function Zt(e,a){if(1&e&&(t.j41(0,"div",44),t.DNE(1,qt,2,3)(2,Kt,2,3),t.k0s()),2&e){const o=t.XpG(2);t.R7$(),t.vxM("contractSignature"===(null==o.promotion?null:o.promotion.deliveryMonthsFrom)?1:2)}}function to(e,a){1&e&&(t.j41(0,"div",43),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"text.select_date_origin_required")," "))}function oo(e,a){if(1&e){const o=t.RV6();t.j41(0,"div",45)(1,"ion-radio-group",46),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG(2);return t.DH7(s.promotion.deliveryMonthsFrom,n)||(s.promotion.deliveryMonthsFrom=n),t.Njj(n)}),t.j41(2,"div",47),t.nrm(3,"ion-radio",48),t.j41(4,"div",49),t.EFF(5),t.nI1(6,"translate"),t.k0s()(),t.j41(7,"div",47),t.nrm(8,"ion-radio",48),t.j41(9,"div",49),t.EFF(10),t.nI1(11,"translate"),t.k0s()()(),t.DNE(12,to,3,3,"div",33),t.k0s()}if(2&e){const o=t.XpG(2);t.Y8G("appInputViewMode",o.isDisabled)("externalInputValue",o.promotion.deliveryMonthsFrom),t.R7$(),t.R50("ngModel",o.promotion.deliveryMonthsFrom),t.Y8G("ngClass",t.eq3(13,S,o.isFieldInvalid("deliveryMonthsFrom","months"))),t.R7$(2),t.Y8G("value","contractSignature"),t.R7$(2),t.SpI(" ",t.bMT(6,9,"text.from_contract_signature")," "),t.R7$(3),t.Y8G("value","license"),t.R7$(2),t.SpI(" ",t.bMT(11,11,"text.from_license_obtaining")," "),t.R7$(2),t.Y8G("ngIf",o.isFieldInvalid("deliveryMonthsFrom","months"))}}function eo(e,a){if(1&e){const o=t.RV6();t.j41(0,"div",12)(1,"div",13)(2,"div",14),t.DNE(3,Bt,2,1,"div",15),t.j41(4,"div",16)(5,"div",1)(6,"b",17),t.EFF(7),t.nI1(8,"translate"),t.k0s(),t.EFF(9),t.nI1(10,"translate"),t.k0s()()(),t.j41(11,"div",18)(12,"div",19)(13,"div",20)(14,"div",21),t.EFF(15),t.nI1(16,"translate"),t.k0s(),t.j41(17,"div",22)(18,"select",23),t.nI1(19,"translate"),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG();return t.DH7(s.promotion.constructionStatus,n)||(s.promotion.constructionStatus=n),t.Njj(n)}),t.j41(20,"option",24),t.EFF(21),t.nI1(22,"translate"),t.k0s(),t.j41(23,"option",25),t.EFF(24),t.nI1(25,"translate"),t.k0s(),t.j41(26,"option",26),t.EFF(27),t.nI1(28,"translate"),t.k0s(),t.j41(29,"option",27),t.EFF(30),t.nI1(31,"translate"),t.k0s(),t.j41(32,"option",28),t.EFF(33),t.nI1(34,"translate"),t.k0s(),t.j41(35,"option",29),t.EFF(36),t.nI1(37,"translate"),t.k0s(),t.j41(38,"option",30),t.EFF(39),t.nI1(40,"translate"),t.k0s(),t.j41(41,"option",31),t.EFF(42),t.nI1(43,"translate"),t.k0s(),t.j41(44,"option",32),t.EFF(45),t.nI1(46,"translate"),t.k0s()()(),t.DNE(47,Nt,3,3,"div",33),t.k0s(),t.j41(48,"div",20)(49,"div",21),t.DNE(50,Vt,2,3)(51,Yt,2,3),t.k0s(),t.j41(52,"div",22)(53,"input",34),t.nI1(54,"translate"),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG();return t.DH7(s.promotion.keyDeliveryDate,n)||(s.promotion.keyDeliveryDate=n),t.Njj(n)}),t.k0s()(),t.DNE(55,Xt,3,3,"div",33),t.k0s()(),t.j41(56,"div",35),t.DNE(57,At,3,1,"div",36)(58,Lt,13,15,"div",37),t.k0s()()(),t.j41(59,"div",13)(60,"div",14),t.DNE(61,Jt,2,1,"div",15),t.j41(62,"div",16)(63,"div",1)(64,"b",17),t.EFF(65),t.nI1(66,"translate"),t.k0s(),t.EFF(67),t.nI1(68,"translate"),t.k0s()()(),t.j41(69,"div",18)(70,"div",19)(71,"div",38)(72,"div",21),t.EFF(73),t.nI1(74,"translate"),t.k0s(),t.DNE(75,Ht,4,6,"div",39)(76,zt,2,1,"div",40),t.k0s(),t.nrm(77,"div",38),t.k0s(),t.j41(78,"div",35),t.DNE(79,Zt,3,1,"div",36)(80,oo,13,15,"div",37),t.k0s()()()()}if(2&e){const o=t.XpG();t.Y8G("ngClass",t.eq3(77,jt,o.isDisabled)),t.R7$(),t.Y8G("ngClass",t.eq3(79,L,!(o.isDisabled&&o.promotion.deliveryDateModalityByStatus||!o.isDisabled))),t.R7$(2),t.Y8G("ngIf",!o.isDisabled),t.R7$(4),t.JRh(t.bMT(8,43,"text.delivery_date_by_status_title")),t.R7$(2),t.SpI(" ",t.bMT(10,45,"text.delivery_date_by_status_description")," "),t.R7$(2),t.Y8G("ngStyle",t.eq3(81,J,o.promotion.deliveryDateModalityByStatus?"1":"0.3")),t.R7$(2),t.Y8G("appInputViewMode",o.isDisabled)("externalInputValue",o.promotion.constructionStatus),t.R7$(2),t.SpI(" ",t.bMT(16,47,"text.construction_status")," "),t.R7$(2),t.Y8G("ngClass",t.eq3(83,S,o.isFieldInvalid("constructionStatus","status"))),t.R7$(),t.Y8G("disabled",o.isDisabled),t.R50("ngModel",o.promotion.constructionStatus),t.BMQ("placeholder",t.bMT(19,49,"text.select")),t.R7$(3),t.JRh(t.bMT(22,51,"text.proyecto-sin-licencia")),t.R7$(3),t.JRh(t.bMT(25,53,"text.proyecto-con-licencia")),t.R7$(3),t.JRh(t.bMT(28,55,"text.fase-excavacion")),t.R7$(3),t.JRh(t.bMT(31,57,"text.cimentacion-completada")),t.R7$(3),t.JRh(t.bMT(34,59,"text.estructura-construccion")),t.R7$(3),t.JRh(t.bMT(37,61,"text.cerramiento-completado")),t.R7$(3),t.JRh(t.bMT(40,63,"text.instalaciones-proceso")),t.R7$(3),t.JRh(t.bMT(43,65,"text.acabados-interiores")),t.R7$(3),t.JRh(t.bMT(46,67,"text.obra-finalizada")),t.R7$(2),t.Y8G("ngIf",o.isFieldInvalid("constructionStatus","status")),t.R7$(),t.Y8G("appInputViewMode",o.isDisabled)("externalInputValue",o.promotion.keyDeliveryDate),t.R7$(2),t.vxM("obra-finalizada"===(null==o.promotion?null:o.promotion.constructionStatus)?50:51),t.R7$(2),t.Y8G("ngClass",t.eq3(85,S,o.isFieldInvalid("keyDeliveryDate","status"))),t.R7$(),t.Y8G("disabled",o.isDisabled)("placeholder",t.bMT(54,69,"text.name")),t.R50("ngModel",o.promotion.keyDeliveryDate),t.R7$(2),t.Y8G("ngIf",o.isFieldInvalid("keyDeliveryDate","status")),t.R7$(2),t.Y8G("ngIf",o.isDisabled),t.R7$(),t.Y8G("ngIf",!o.isDisabled),t.R7$(),t.Y8G("ngClass",t.eq3(87,L,!(o.isDisabled&&o.promotion.deliveryDateModalityByMonths||!o.isDisabled))),t.R7$(2),t.Y8G("ngIf",!o.isDisabled),t.R7$(4),t.JRh(t.bMT(66,71,"text.delivery_date_by_months_title")),t.R7$(2),t.SpI(" ",t.bMT(68,73,"text.delivery_date_by_months_description")," "),t.R7$(2),t.Y8G("ngStyle",t.eq3(89,J,o.promotion.deliveryDateModalityByMonths?"1":"0.3")),t.R7$(4),t.SpI(" ",t.bMT(74,75,"text.delivery_in")," "),t.R7$(2),t.Y8G("ngIf",!o.isDisabled),t.R7$(),t.Y8G("ngIf",o.isDisabled),t.R7$(3),t.Y8G("ngIf",o.isDisabled),t.R7$(),t.Y8G("ngIf",!o.isDisabled)}}let H=(()=>{var e;class a{constructor(i){this.utils=i,this.promotionUpdated=new t.bkB,this.loadingButton=!1,this.isDisabled=!0,this.months=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36]}ngOnInit(){}set promotionData(i){var n,s;this.promotion=i,null!==(n=this.promotion)&&void 0!==n&&n.deliveryDateModalityByStatus||null!==(s=this.promotion)&&void 0!==s&&s.deliveryDateModalityByMonths||(this.promotion.deliveryDateModalityByStatus=!0)}onEdit(){var i,n;this.isDisabled=!this.isDisabled,null!==(i=this.promotion)&&void 0!==i&&i.deliveryDateModalityByStatus||null!==(n=this.promotion)&&void 0!==n&&n.deliveryDateModalityByMonths||(this.promotion.deliveryDateModalityByStatus=!0),console.log("Editing promotion details:",this.promotion),this.promotion.keyDeliveryDate&&(console.log("Converting keyDeliveryDate to frontend date input format"),console.log(this.utils.parseBackendDateToFrontendDateInput(this.promotion.keyDeliveryDate)),this.promotion.keyDeliveryDate=this.utils.parseBackendDateToFrontendDateInput(this.promotion.keyDeliveryDate))}onSave(){!this.isDisabled&&!this.isFormValid()||(this.savePromotion(),this.isDisabled=!0)}onSelectModality(i){"deliveryDateModalityByStatus"===i&&(this.promotion.deliveryDateModalityByMonths=!1),"deliveryDateModalityByMonths"===i&&(this.promotion.deliveryDateModalityByStatus=!1)}savePromotion(){const i={deliveryDateModalityByStatus:this.promotion.deliveryDateModalityByStatus,constructionStatus:this.promotion.constructionStatus,keyDeliveryDate:this.promotion.keyDeliveryDate,applyingDeliveryDateForAllProperties:this.promotion.applyingDeliveryDateForAllProperties,deliveryDateModalityByMonths:this.promotion.deliveryDateModalityByMonths,deliveryMonthsFrom:this.promotion.deliveryMonthsFrom,deliveryDateModalityByMonthsValue:parseInt(this.promotion.deliveryDateModalityByMonthsValue)};this.promotionUpdated.emit(i)}isFieldInvalid(i,n){if(this.isDisabled||!this.promotion||"status"===n&&!this.promotion.deliveryDateModalityByStatus||"months"===n&&!this.promotion.deliveryDateModalityByMonths)return!1;const s=this.promotion[i];return null==s||"string"==typeof s&&""===s.trim()}isFormValid(){let i=!0;return this.promotion.deliveryDateModalityByStatus&&(i=i&&!this.isFieldInvalid("constructionStatus","status")&&!this.isFieldInvalid("keyDeliveryDate","status")&&!this.isFieldInvalid("applyingDeliveryDateForAllProperties","status")),this.promotion.deliveryDateModalityByMonths&&(i=i&&!this.isFieldInvalid("deliveryMonthsFrom","months")),i}}return(e=a).\u0275fac=function(i){return new(i||e)(t.rXU(G.T))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-promotion-payments-details-delivery-date"]],inputs:{currentUser:"currentUser"},outputs:{promotionUpdated:"promotionUpdated"},decls:6,vars:2,consts:[[1,"crm-header-modal","crm-header-modal-empty"],[1,"crm-section-smaller-title"],[1,"crm-buttons-group"],[1,"crm-button-secondary","crm-button-secondary-primary",3,"appLoadingButton"],[1,"crm-button","crm-button-success",3,"appLoadingButton"],[3,"ngClass",4,"ngIf"],["class","crm-button-secondary crm-button-secondary-primary",3,"appLoadingButton","click",4,"ngIf"],[1,"crm-button-secondary","crm-button-secondary-primary",3,"click","appLoadingButton"],[1,"fa-solid","fa-edit"],["class","crm-button crm-button-success",3,"appLoadingButton","click",4,"ngIf"],[1,"crm-button","crm-button-success",3,"click","appLoadingButton"],[1,"fa-solid","fa-check"],[3,"ngClass"],[1,"crm-card-user","crm-section-margin-top",3,"ngClass"],[1,"crm-card-user-header"],["class","crm-input-checkbox",4,"ngIf"],[1,"crm-card-user-header-data"],[2,"font-weight","bold !important"],[1,"crm-card-user-body",2,"margin-bottom","0",3,"ngStyle"],[1,"crm-section-inputs-double-input"],[1,"crm-input",3,"appInputViewMode","externalInputValue"],[1,"crm-input-label"],[1,"crm-input-input",3,"ngClass"],[3,"ngModelChange","disabled","ngModel"],["value","proyecto-sin-licencia"],["value","proyecto-con-licencia"],["value","fase-excavacion"],["value","cimentacion-completada"],["value","estructura-construccion"],["value","cerramiento-completado"],["value","instalaciones-proceso"],["value","acabados-interiores"],["value","obra-finalizada"],["class","crm-input-error",4,"ngIf"],["type","date",3,"ngModelChange","disabled","placeholder","ngModel"],[1,"crm-section-inline-checkboxes","crm-section-margin-top",2,"margin-top","24px"],["class","crm-text",4,"ngIf"],["class","crm-input crm-input-radio-box",3,"appInputViewMode","externalInputValue",4,"ngIf"],[1,"crm-input"],["class","crm-input-input",4,"ngIf"],["class","crm-input-view",4,"ngIf"],[1,"crm-input-checkbox"],[3,"ngModelChange","ionChange","ngModel"],[1,"crm-input-error"],[1,"crm-text"],[1,"crm-input","crm-input-radio-box",3,"appInputViewMode","externalInputValue"],[1,"crm-input-radios",3,"ngModelChange","ngModel","ngClass"],[1,"crm-input-radio"],[3,"value"],[1,"crm-input-radio-label"],[1,"crm-input-input"],[3,"ngModelChange","ngModel","disabled"],[3,"value",4,"ngFor","ngForOf"],[1,"crm-input-view"],[4,"ngIf"]],template:function(i,n){1&i&&(t.j41(0,"div",0),t.nrm(1,"div",1),t.j41(2,"div",2),t.DNE(3,Et,1,1,"button",3)(4,$t,1,1,"button",4),t.k0s()(),t.DNE(5,eo,81,91,"div",5)),2&i&&(t.R7$(3),t.vxM(n.isDisabled?3:4),t.R7$(2),t.Y8G("ngIf",n.promotion))},dependencies:[u.YU,u.Sq,u.bT,u.B3,c.xH,c.y7,c.me,c.wz,c.BC,c.vS,g.eY,g.KO,g.f0,g.hB,g.Je,E.M,D.K,P.D9],styles:[".crm-header-modal-empty[_ngcontent-%COMP%]{padding-right:0;padding-left:0}"]}),a})();const no=e=>({"crm-section-disabled-inputs":e}),M=e=>({"crm-input-input-error":e}),io=e=>({value:e});function so(e,a){if(1&e){const o=t.RV6();t.j41(0,"button",7),t.bIt("click",function(){t.eBV(o);const n=t.XpG(2);return t.Njj(n.onEdit())}),t.nrm(1,"i",8),t.EFF(2),t.nI1(3,"translate"),t.k0s()}if(2&e){const o=t.XpG(2);t.Y8G("appLoadingButton",o.loadingButton),t.R7$(2),t.SpI(" ",t.bMT(3,2,"text.edit")," ")}}function ao(e,a){if(1&e&&t.DNE(0,so,4,4,"button",6),2&e){const o=t.XpG();t.Y8G("ngIf","promoter"===(null==o.currentUser?null:o.currentUser.accountType))}}function ro(e,a){if(1&e){const o=t.RV6();t.j41(0,"button",10),t.bIt("click",function(){t.eBV(o);const n=t.XpG(2);return t.Njj(n.onSave())}),t.nrm(1,"i",11),t.EFF(2),t.nI1(3,"translate"),t.k0s()}if(2&e){const o=t.XpG(2);t.Y8G("appLoadingButton",o.loadingButton),t.R7$(2),t.SpI(" ",t.bMT(3,2,"text.save")," ")}}function lo(e,a){if(1&e&&t.DNE(0,ro,4,4,"button",9),2&e){const o=t.XpG();t.Y8G("ngIf","promoter"===(null==o.currentUser?null:o.currentUser.accountType))}}function mo(e,a){1&e&&(t.j41(0,"div",35),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"text.reserve_payment_required")," "))}function co(e,a){1&e&&(t.j41(0,"div",35),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"text.expiration_required")," "))}function po(e,a){1&e&&(t.j41(0,"div",35),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"text.contract_required")," "))}function _o(e,a){1&e&&(t.j41(0,"div",35),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"text.payment_percentage_required")," "))}function uo(e,a){1&e&&(t.j41(0,"div",35),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"text.remaining_required")," "))}function go(e,a){1&e&&(t.j41(0,"div",35),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"text.remaining_when_required")," "))}function vo(e,a){if(1&e){const o=t.RV6();t.j41(0,"div",36)(1,"ion-radio-group",37),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG(2);return t.DH7(s.promotion.buyAndSellContractPaymentRestantWhen,n)||(s.promotion.buyAndSellContractPaymentRestantWhen=n),t.Njj(n)}),t.j41(2,"div",38),t.nrm(3,"ion-radio",39),t.j41(4,"div",40),t.EFF(5),t.nI1(6,"translate"),t.k0s()(),t.j41(7,"div",38),t.nrm(8,"ion-radio",41),t.j41(9,"div",40),t.EFF(10),t.nI1(11,"translate"),t.k0s()()(),t.DNE(12,go,3,3,"div",20),t.k0s()}if(2&e){const o=t.XpG(2);t.Y8G("appInputViewMode",o.isDisabled)("externalInputValue",o.promotion.buyAndSellContractPaymentRestantWhen),t.R7$(),t.R50("ngModel",o.promotion.buyAndSellContractPaymentRestantWhen),t.R7$(4),t.SpI(" ",t.bMT(6,6,"text.remaining_when.public_signing")," "),t.R7$(5),t.SpI(" ",t.bMT(11,8,"text.remaining_when.certification")," "),t.R7$(2),t.Y8G("ngIf",o.isFieldInvalid("buyAndSellContractPaymentRestantWhen"))}}function yo(e,a){if(1&e){const o=t.RV6();t.j41(0,"button",67),t.bIt("click",function(){t.eBV(o);const n=t.XpG().$index,s=t.XpG(3);return t.Njj(s.onDelete(n))}),t.nrm(1,"i",68),t.k0s()}}function ho(e,a){if(1&e){const o=t.RV6();t.j41(0,"div",42)(1,"div",45),t.EFF(2),t.k0s(),t.j41(3,"div",15)(4,"div",46)(5,"input",18),t.nI1(6,"translate"),t.mxI("ngModelChange",function(n){const s=t.eBV(o).$implicit;return t.DH7(s.percentage,n)||(s.percentage=n),t.Njj(n)}),t.bIt("ngModelChange",function(){t.eBV(o);const n=t.XpG(3);return t.Njj(n.onQuantityPercentageChange())}),t.k0s(),t.j41(7,"div",19),t.EFF(8," % "),t.k0s()()(),t.j41(9,"div",15)(10,"div",46)(11,"select",47),t.nI1(12,"translate"),t.mxI("ngModelChange",function(n){const s=t.eBV(o).$implicit;return t.DH7(s.typeOfPercentage,n)||(s.typeOfPercentage=n),t.Njj(n)}),t.j41(13,"option",48),t.EFF(14),t.nI1(15,"translate"),t.k0s(),t.j41(16,"option",49),t.EFF(17),t.nI1(18,"translate"),t.k0s(),t.j41(19,"option",50),t.EFF(20),t.nI1(21,"translate"),t.k0s(),t.j41(22,"option",51),t.EFF(23),t.nI1(24,"translate"),t.k0s(),t.j41(25,"option",52),t.EFF(26),t.nI1(27,"translate"),t.k0s(),t.j41(28,"option",53),t.EFF(29),t.nI1(30,"translate"),t.k0s(),t.j41(31,"option",54),t.EFF(32),t.nI1(33,"translate"),t.k0s(),t.j41(34,"option",55),t.EFF(35),t.nI1(36,"translate"),t.k0s(),t.j41(37,"option",56),t.EFF(38),t.nI1(39,"translate"),t.k0s(),t.j41(40,"option",57),t.EFF(41),t.nI1(42,"translate"),t.k0s(),t.j41(43,"option",58),t.EFF(44),t.nI1(45,"translate"),t.k0s(),t.j41(46,"option",59),t.EFF(47),t.nI1(48,"translate"),t.k0s(),t.j41(49,"option",60),t.EFF(50),t.nI1(51,"translate"),t.k0s(),t.j41(52,"option",61),t.EFF(53),t.nI1(54,"translate"),t.k0s(),t.j41(55,"option",62),t.EFF(56),t.nI1(57,"translate"),t.k0s(),t.j41(58,"option",63),t.EFF(59),t.nI1(60,"translate"),t.k0s(),t.j41(61,"option",64),t.EFF(62),t.nI1(63,"translate"),t.k0s(),t.j41(64,"option",65),t.EFF(65),t.nI1(66,"translate"),t.k0s()()()(),t.DNE(67,yo,2,0,"button",66),t.k0s()}if(2&e){const o=a.$implicit,i=a.$index,n=t.XpG(3);t.R7$(2),t.SpI(" ",i+1," "),t.R7$(),t.Y8G("appInputViewMode",n.isDisabled)("externalInputValue",o.percentage),t.R7$(2),t.Y8G("disabled",n.isDisabled)("placeholder",t.bMT(6,29,"text.certification_percentage_placeholder")),t.R50("ngModel",o.percentage),t.R7$(4),t.Y8G("appInputViewMode",n.isDisabled)("externalInputValue",o.typeOfPercentage),t.R7$(2),t.R50("ngModel",o.typeOfPercentage),t.BMQ("placeholder",t.bMT(12,31,"text.select")),t.R7$(3),t.JRh(t.bMT(15,33,"text.movimiento_tierras")),t.R7$(3),t.JRh(t.bMT(18,35,"text.cimentacion")),t.R7$(3),t.JRh(t.bMT(21,37,"text.estructura")),t.R7$(3),t.JRh(t.bMT(24,39,"text.cerramientos_exteriores")),t.R7$(3),t.JRh(t.bMT(27,41,"text.cubierta_tejado")),t.R7$(3),t.JRh(t.bMT(30,43,"text.carpinteria_exterior")),t.R7$(3),t.JRh(t.bMT(33,45,"text.instalaciones_basicas")),t.R7$(3),t.JRh(t.bMT(36,47,"text.tabiqueria_revestimientos")),t.R7$(3),t.JRh(t.bMT(39,49,"text.yeso_enlucidos")),t.R7$(3),t.JRh(t.bMT(42,51,"text.solados_alicatados")),t.R7$(3),t.JRh(t.bMT(45,53,"text.carpinteria_interior")),t.R7$(3),t.JRh(t.bMT(48,55,"text.pintura_interior")),t.R7$(3),t.JRh(t.bMT(51,57,"text.sanitarios_griferias")),t.R7$(3),t.JRh(t.bMT(54,59,"text.ascensores_comunes")),t.R7$(3),t.JRh(t.bMT(57,61,"text.zonas_comunes")),t.R7$(3),t.JRh(t.bMT(60,63,"text.finalizacion_obra")),t.R7$(3),t.JRh(t.bMT(63,65,"text.licencia_ocupacion")),t.R7$(3),t.JRh(t.bMT(66,67,"text.entrega_llaves")),t.R7$(2),t.Y8G("ngIf",!n.isDisabled)}}function bo(e,a){if(1&e&&(t.j41(0,"div",69),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e){const o=t.XpG(3);t.R7$(),t.SpI(" ",t.i5U(2,1,"text.total_certification_error",t.eq3(4,io,o.promotion.buyAndSellContractPaymentRestantPercentage))," ")}}function Po(e,a){if(1&e){const o=t.RV6();t.j41(0,"div",70)(1,"button",71),t.bIt("click",function(){t.eBV(o);const n=t.XpG(3);return t.Njj(n.onAddCharge())}),t.nrm(2,"i",72),t.EFF(3),t.nI1(4,"translate"),t.k0s()()}2&e&&(t.R7$(3),t.SpI(" ",t.bMT(4,1,"text.add_more_payments")," "))}function Co(e,a){if(1&e&&(t.j41(0,"div",30),t.EFF(1),t.nI1(2,"translate"),t.k0s(),t.Z7z(3,ho,68,69,"div",42,t.fX1),t.DNE(5,bo,3,6,"div",43)(6,Po,5,3,"div",44)),2&e){const o=t.XpG(2);t.R7$(),t.SpI(" ",t.bMT(2,3,"text.define_certifications")," "),t.R7$(2),t.Dyx(null==o.promotion?null:o.promotion.certificationsCharges),t.R7$(2),t.Y8G("ngIf",o.percentagesOverflowsMaximum),t.R7$(),t.Y8G("ngIf",!o.isDisabled)}}function fo(e,a){if(1&e){const o=t.RV6();t.j41(0,"div",12)(1,"div",13),t.EFF(2),t.nI1(3,"translate"),t.k0s(),t.j41(4,"div",14)(5,"div",15)(6,"div",16),t.EFF(7),t.nI1(8,"translate"),t.k0s(),t.j41(9,"div",17)(10,"input",18),t.nI1(11,"translate"),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG();return t.DH7(s.promotion.reservePayment,n)||(s.promotion.reservePayment=n),t.Njj(n)}),t.k0s(),t.j41(12,"div",19),t.EFF(13," \u20ac "),t.k0s()(),t.DNE(14,mo,3,3,"div",20),t.k0s(),t.j41(15,"div",15)(16,"div",16),t.EFF(17),t.nI1(18,"translate"),t.k0s(),t.j41(19,"div",17)(20,"select",21),t.nI1(21,"translate"),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG();return t.DH7(s.promotion.reservePaymentExpirationDays,n)||(s.promotion.reservePaymentExpirationDays=n),t.Njj(n)}),t.j41(22,"option",22),t.EFF(23),t.nI1(24,"translate"),t.k0s(),t.j41(25,"option",23),t.EFF(26),t.nI1(27,"translate"),t.k0s(),t.j41(28,"option",24),t.EFF(29),t.nI1(30,"translate"),t.k0s(),t.j41(31,"option",25),t.EFF(32),t.nI1(33,"translate"),t.k0s(),t.j41(34,"option",26),t.EFF(35),t.nI1(36,"translate"),t.k0s(),t.j41(37,"option",27),t.EFF(38),t.nI1(39,"translate"),t.k0s(),t.j41(40,"option",28),t.EFF(41),t.nI1(42,"translate"),t.k0s(),t.j41(43,"option",29),t.EFF(44),t.nI1(45,"translate"),t.k0s()()(),t.DNE(46,co,3,3,"div",20),t.k0s()(),t.j41(47,"div",30),t.EFF(48),t.nI1(49,"translate"),t.k0s(),t.j41(50,"div",14)(51,"div",15)(52,"div",16),t.EFF(53),t.nI1(54,"translate"),t.k0s(),t.j41(55,"div",17)(56,"select",21),t.nI1(57,"translate"),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG();return t.DH7(s.promotion.buyAndSellContractInDays,n)||(s.promotion.buyAndSellContractInDays=n),t.Njj(n)}),t.j41(58,"option",22),t.EFF(59),t.nI1(60,"translate"),t.k0s(),t.j41(61,"option",23),t.EFF(62),t.nI1(63,"translate"),t.k0s(),t.j41(64,"option",24),t.EFF(65),t.nI1(66,"translate"),t.k0s(),t.j41(67,"option",25),t.EFF(68),t.nI1(69,"translate"),t.k0s(),t.j41(70,"option",26),t.EFF(71),t.nI1(72,"translate"),t.k0s(),t.j41(73,"option",27),t.EFF(74),t.nI1(75,"translate"),t.k0s(),t.j41(76,"option",28),t.EFF(77),t.nI1(78,"translate"),t.k0s(),t.j41(79,"option",29),t.EFF(80),t.nI1(81,"translate"),t.k0s()()(),t.DNE(82,po,3,3,"div",20),t.k0s(),t.j41(83,"div",15)(84,"div",16),t.EFF(85),t.nI1(86,"translate"),t.k0s(),t.j41(87,"div",17)(88,"input",18),t.nI1(89,"translate"),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG();return t.DH7(s.promotion.buyAndSellContractPaymentQuantityPercentage,n)||(s.promotion.buyAndSellContractPaymentQuantityPercentage=n),t.Njj(n)}),t.bIt("ngModelChange",function(){t.eBV(o);const n=t.XpG();return t.Njj(n.onQuantityPercentageChange())}),t.k0s(),t.j41(90,"div",19),t.EFF(91," % "),t.k0s()(),t.DNE(92,_o,3,3,"div",20),t.k0s()(),t.j41(93,"div",31)(94,"div",15)(95,"div",16),t.EFF(96),t.nI1(97,"translate"),t.k0s(),t.j41(98,"div",17)(99,"input",18),t.nI1(100,"translate"),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG();return t.DH7(s.promotion.buyAndSellContractPaymentRestantPercentage,n)||(s.promotion.buyAndSellContractPaymentRestantPercentage=n),t.Njj(n)}),t.bIt("ngModelChange",function(){t.eBV(o);const n=t.XpG();return t.Njj(n.onQuantityPercentageChange())}),t.k0s(),t.j41(101,"div",19),t.EFF(102," % "),t.k0s()(),t.DNE(103,uo,3,3,"div",20),t.k0s(),t.nrm(104,"div",32),t.k0s(),t.j41(105,"div",33),t.DNE(106,vo,13,10,"div",34),t.k0s(),t.DNE(107,Co,7,5),t.k0s()}if(2&e){const o=t.XpG();t.Y8G("ngClass",t.eq3(117,no,o.isDisabled)),t.R7$(2),t.SpI(" ",t.bMT(3,61,"text.reserve")," "),t.R7$(3),t.Y8G("appInputViewMode",o.isDisabled)("externalInputValue",o.promotion.reservePayment),t.R7$(2),t.SpI(" ",t.bMT(8,63,"text.reserve_payment")," "),t.R7$(2),t.Y8G("ngClass",t.eq3(119,M,o.isFieldInvalid("reservePayment"))),t.R7$(),t.Y8G("disabled",o.isDisabled)("placeholder",t.bMT(11,65,"text.name")),t.R50("ngModel",o.promotion.reservePayment),t.R7$(4),t.Y8G("ngIf",o.isFieldInvalid("reservePayment")),t.R7$(),t.Y8G("appInputViewMode",o.isDisabled)("externalInputValue",o.promotion.reservePaymentExpirationDays),t.R7$(2),t.SpI(" ",t.bMT(18,67,"text.expires_in")," "),t.R7$(2),t.Y8G("ngClass",t.eq3(121,M,o.isFieldInvalid("reservePaymentExpirationDays"))),t.R7$(),t.Y8G("disabled",o.isDisabled),t.R50("ngModel",o.promotion.reservePaymentExpirationDays),t.BMQ("placeholder",t.bMT(21,69,"text.select")),t.R7$(3),t.JRh(t.bMT(24,71,"text.expiration.7_days")),t.R7$(3),t.JRh(t.bMT(27,73,"text.expiration.14_days")),t.R7$(3),t.JRh(t.bMT(30,75,"text.expiration.21_days")),t.R7$(3),t.JRh(t.bMT(33,77,"text.expiration.28_days")),t.R7$(3),t.JRh(t.bMT(36,79,"text.expiration.2_months")),t.R7$(3),t.JRh(t.bMT(39,81,"text.expiration.3_months")),t.R7$(3),t.JRh(t.bMT(42,83,"text.expiration.4_months")),t.R7$(3),t.JRh(t.bMT(45,85,"text.expiration.undefined")),t.R7$(2),t.Y8G("ngIf",o.isFieldInvalid("reservePaymentExpirationDays")),t.R7$(2),t.SpI(" ",t.bMT(49,87,"text.buy_sell")," "),t.R7$(3),t.Y8G("appInputViewMode",o.isDisabled)("externalInputValue",o.promotion.buyAndSellContractInDays),t.R7$(2),t.SpI(" ",t.bMT(54,89,"text.contract_days")," "),t.R7$(2),t.Y8G("ngClass",t.eq3(123,M,o.isFieldInvalid("buyAndSellContractInDays"))),t.R7$(),t.Y8G("disabled",o.isDisabled),t.R50("ngModel",o.promotion.buyAndSellContractInDays),t.BMQ("placeholder",t.bMT(57,91,"text.select")),t.R7$(3),t.JRh(t.bMT(60,93,"text.expiration.7_days")),t.R7$(3),t.JRh(t.bMT(63,95,"text.expiration.14_days")),t.R7$(3),t.JRh(t.bMT(66,97,"text.expiration.21_days")),t.R7$(3),t.JRh(t.bMT(69,99,"text.expiration.28_days")),t.R7$(3),t.JRh(t.bMT(72,101,"text.expiration.2_months")),t.R7$(3),t.JRh(t.bMT(75,103,"text.expiration.3_months")),t.R7$(3),t.JRh(t.bMT(78,105,"text.expiration.4_months")),t.R7$(3),t.JRh(t.bMT(81,107,"text.expiration.undefined")),t.R7$(2),t.Y8G("ngIf",o.isFieldInvalid("buyAndSellContractInDays")),t.R7$(),t.Y8G("appInputViewMode",o.isDisabled)("externalInputValue",o.promotion.buyAndSellContractPaymentQuantityPercentage),t.R7$(2),t.SpI(" ",t.bMT(86,109,"text.payment_percentage")," "),t.R7$(2),t.Y8G("ngClass",t.eq3(125,M,o.isFieldInvalid("buyAndSellContractPaymentQuantityPercentage"))),t.R7$(),t.Y8G("disabled",o.isDisabled)("placeholder",t.bMT(89,111,"text.payment_percentage_placeholder")),t.R50("ngModel",o.promotion.buyAndSellContractPaymentQuantityPercentage),t.R7$(4),t.Y8G("ngIf",o.isFieldInvalid("buyAndSellContractPaymentQuantityPercentage")),t.R7$(2),t.Y8G("appInputViewMode",o.isDisabled)("externalInputValue",o.promotion.buyAndSellContractPaymentRestantPercentage),t.R7$(2),t.SpI(" ",t.bMT(97,113,"text.remaining")," "),t.R7$(2),t.Y8G("ngClass",t.eq3(127,M,o.isFieldInvalid("buyAndSellContractPaymentRestantPercentage"))),t.R7$(),t.Y8G("disabled",o.isDisabled)("placeholder",t.bMT(100,115,"text.certification_percentage_placeholder")),t.R50("ngModel",o.promotion.buyAndSellContractPaymentRestantPercentage),t.R7$(4),t.Y8G("ngIf",o.isFieldInvalid("buyAndSellContractPaymentRestantPercentage")),t.R7$(3),t.Y8G("ngIf",!o.isDisabled),t.R7$(),t.vxM("by_certification"===(null==o.promotion?null:o.promotion.buyAndSellContractPaymentRestantWhen)?107:-1)}}let Q=(()=>{var e;class a{constructor(){this.promotionUpdated=new t.bkB,this.loadingButton=!1,this.isDisabled=!0,this.percentagesOverflowsMaximum=!1}ngOnInit(){}set promotionData(i){this.promotion=i}onEdit(){var i,n;this.isDisabled=!this.isDisabled,null!==(i=this.promotion)&&void 0!==i&&i.deliveryDateModalityByStatus||null!==(n=this.promotion)&&void 0!==n&&n.deliveryDateModalityByMonths||(this.promotion.deliveryDateModalityByStatus=!0),(!this.promotion.certificationsCharges||!this.promotion.certificationsCharges.length)&&(this.promotion.certificationsCharges=[],this.promotion.certificationsCharges.push({typeOfPercentage:"",percentage:0}))}onSave(){!this.isDisabled&&!this.isFormValid()||(this.savePromotion(),this.isDisabled=!0)}onQuantityPercentageChange(){setTimeout(()=>{var i;const n=null===(i=this.promotion)||void 0===i?void 0:i.buyAndSellContractPaymentQuantityPercentage;this.promotion.buyAndSellContractPaymentRestantPercentage=100-n;let s=0;for(let r of this.promotion.certificationsCharges)s+=r.percentage;this.percentagesOverflowsMaximum=s>this.promotion.buyAndSellContractPaymentRestantPercentage})}onAddCharge(){this.promotion.certificationsCharges?this.promotion.certificationsCharges.push({typeOfPercentage:"",percentage:0}):this.promotion.certificationsCharges=[{typeOfPercentage:null,percentage:null}]}onDelete(i){this.promotion.certificationsCharges.splice(i,1)}savePromotion(){this.promotionUpdated.emit({reservePayment:this.promotion.reservePayment,reservePaymentExpirationDays:this.promotion.reservePaymentExpirationDays,buyAndSellContractInDays:this.promotion.buyAndSellContractInDays,buyAndSellContractPaymentQuantityPercentage:this.promotion.buyAndSellContractPaymentQuantityPercentage,buyAndSellContractPaymentRestantPercentage:this.promotion.buyAndSellContractPaymentRestantPercentage,buyAndSellContractPaymentRestantWhen:this.promotion.buyAndSellContractPaymentRestantWhen,certificationsCharges:this.promotion.certificationsCharges})}isFieldInvalid(i){if(this.isDisabled||!this.promotion)return!1;const n=this.promotion[i];return null==n||"string"==typeof n&&""===n.trim()}isFormValid(){return!(this.isFieldInvalid("reservePayment")||this.isFieldInvalid("reservePaymentExpirationDays")||this.isFieldInvalid("buyAndSellContractInDays")||this.isFieldInvalid("buyAndSellContractPaymentQuantityPercentage")||this.isFieldInvalid("buyAndSellContractPaymentRestantPercentage")||this.isFieldInvalid("buyAndSellContractPaymentRestantWhen"))}}return(e=a).\u0275fac=function(i){return new(i||e)},e.\u0275cmp=t.VBU({type:e,selectors:[["app-promotion-payments-details-payment-method"]],inputs:{currentUser:"currentUser"},outputs:{promotionUpdated:"promotionUpdated"},decls:6,vars:2,consts:[[1,"crm-header-modal","crm-header-modal-empty"],[1,"crm-section-smaller-title"],[1,"crm-buttons-group"],[1,"crm-button-secondary","crm-button-secondary-primary",3,"appLoadingButton"],[1,"crm-button","crm-button-success",3,"appLoadingButton"],[3,"ngClass",4,"ngIf"],["class","crm-button-secondary crm-button-secondary-primary",3,"appLoadingButton","click",4,"ngIf"],[1,"crm-button-secondary","crm-button-secondary-primary",3,"click","appLoadingButton"],[1,"fa-solid","fa-edit"],["class","crm-button crm-button-success",3,"appLoadingButton","click",4,"ngIf"],[1,"crm-button","crm-button-success",3,"click","appLoadingButton"],[1,"fa-solid","fa-check"],[3,"ngClass"],[1,"crm-title-14"],[1,"crm-section-inputs-double-input","crm-section-margin-top"],[1,"crm-input",3,"appInputViewMode","externalInputValue"],[1,"crm-input-label"],[1,"crm-input-input",3,"ngClass"],["type","number",3,"ngModelChange","disabled","placeholder","ngModel"],[1,"crm-input-input-symbol"],["class","crm-input-error",4,"ngIf"],[3,"ngModelChange","disabled","ngModel"],["value","7"],["value","14"],["value","21"],["value","28"],["value","60"],["value","90"],["value","120"],["value","No defined"],[1,"crm-title-14","crm-section-margin-top-medium"],[1,"crm-section-inputs-double-input","crm-section-margin-top-medium"],[1,"crm-input"],[1,"crm-section-inline-checkboxes","crm-section-margin-top",2,"margin-top","24px"],["class","crm-input crm-input-radio-box",3,"appInputViewMode","externalInputValue",4,"ngIf"],[1,"crm-input-error"],[1,"crm-input","crm-input-radio-box",3,"appInputViewMode","externalInputValue"],[1,"crm-input-radios",3,"ngModelChange","ngModel"],[1,"crm-input-radio"],["value","when_public_signing"],[1,"crm-input-radio-label"],["value","by_certification"],[1,"crm-section-inputs-double-input","crm-section-margin-top-medium",2,"align-items","center"],["class","crm-input-error crm-section-margin-top",4,"ngIf"],["class","crm-section-margin-top","style","display: flex; justify-content: center;",4,"ngIf"],[1,"crm-text"],[1,"crm-input-input"],[3,"ngModelChange","ngModel"],["value","movimiento_tierras"],["value","cimentacion"],["value","estructura"],["value","cerramientos_exteriores"],["value","cubierta_tejado"],["value","carpinteria_exterior"],["value","instalaciones_basicas"],["value","tabiqueria_revestimientos"],["value","yeso_enlucidos"],["value","solados_alicatados"],["value","carpinteria_interior"],["value","pintura_interior"],["value","sanitarios_griferias"],["value","ascensores_comunes"],["value","zonas_comunes"],["value","finalizacion_obra"],["value","licencia_ocupacion"],["value","entrega_llaves"],["class","crm-button-icon-solo",3,"click",4,"ngIf"],[1,"crm-button-icon-solo",3,"click"],[1,"fas","fa-trash"],[1,"crm-input-error","crm-section-margin-top"],[1,"crm-section-margin-top",2,"display","flex","justify-content","center"],[1,"crm-button-secondary","crm-button-secondary-primary",3,"click"],[1,"fa-solid","fa-add"]],template:function(i,n){1&i&&(t.j41(0,"div",0),t.nrm(1,"div",1),t.j41(2,"div",2),t.DNE(3,ao,1,1,"button",3)(4,lo,1,1,"button",4),t.k0s()(),t.DNE(5,fo,108,129,"div",5)),2&i&&(t.R7$(3),t.vxM(n.isDisabled?3:4),t.R7$(2),t.Y8G("ngIf",n.promotion))},dependencies:[u.YU,u.bT,c.xH,c.y7,c.me,c.Q0,c.wz,c.BC,c.vS,g.KO,g.f0,g.Je,E.M,D.K,P.D9],styles:[".crm-header-modal-empty[_ngcontent-%COMP%]{padding-right:0;padding-left:0}"]}),a})();var Do=l(1748);const xo=e=>({"crm-section-disabled-inputs":e}),z=e=>({"crm-section-invisible":e}),q=e=>({opacity:e}),K=e=>({"crm-input-input-error":e});function Io(e,a){if(1&e){const o=t.RV6();t.j41(0,"button",7),t.bIt("click",function(){t.eBV(o);const n=t.XpG(2);return t.Njj(n.onEdit())}),t.nrm(1,"i",8),t.EFF(2),t.nI1(3,"translate"),t.k0s()}if(2&e){const o=t.XpG(2);t.Y8G("appLoadingButton",o.loadingButton),t.R7$(2),t.SpI(" ",t.bMT(3,2,"text.edit")," ")}}function Ro(e,a){if(1&e&&t.DNE(0,Io,4,4,"button",6),2&e){const o=t.XpG();t.Y8G("ngIf","promoter"===(null==o.currentUser?null:o.currentUser.accountType))}}function Mo(e,a){if(1&e){const o=t.RV6();t.j41(0,"button",10),t.bIt("click",function(){t.eBV(o);const n=t.XpG(2);return t.Njj(n.onSave())}),t.nrm(1,"i",11),t.EFF(2),t.nI1(3,"translate"),t.k0s()}if(2&e){const o=t.XpG(2);t.Y8G("appLoadingButton",o.loadingButton),t.R7$(2),t.SpI(" ",t.bMT(3,2,"text.save")," ")}}function Fo(e,a){if(1&e&&t.DNE(0,Mo,4,4,"button",9),2&e){const o=t.XpG();t.Y8G("ngIf","promoter"===(null==o.currentUser?null:o.currentUser.accountType))}}function To(e,a){if(1&e){const o=t.RV6();t.j41(0,"div",40)(1,"ion-checkbox",41),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG(2);return t.DH7(s.promotion.registersWithPreRegister,n)||(s.promotion.registersWithPreRegister=n),t.Njj(n)}),t.bIt("ionChange",function(){t.eBV(o);const n=t.XpG(2);return t.Njj(n.onSelectModality("registersWithPreRegister"))}),t.k0s()()}if(2&e){const o=t.XpG(2);t.R7$(),t.R50("ngModel",o.promotion.registersWithPreRegister)}}function ko(e,a){1&e&&(t.j41(0,"div",42),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"text.expiration_required")," "))}function jo(e,a){if(1&e){const o=t.RV6();t.j41(0,"div",40)(1,"ion-checkbox",41),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG(2);return t.DH7(s.promotion.registersWithoutPreRegister,n)||(s.promotion.registersWithoutPreRegister=n),t.Njj(n)}),t.bIt("ionChange",function(){t.eBV(o);const n=t.XpG(2);return t.Njj(n.onSelectModality("registersWithoutPreRegister"))}),t.k0s()()}if(2&e){const o=t.XpG(2);t.R7$(),t.R50("ngModel",o.promotion.registersWithoutPreRegister)}}function Go(e,a){1&e&&(t.j41(0,"div",42),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"text.expiration_required")," "))}function Eo(e,a){if(1&e){const o=t.RV6();t.j41(0,"div",43)(1,"div",33)(2,"div",44)(3,"div",45)(4,"ion-checkbox",46),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG(2);return t.DH7(s.promotion.registerNecessaryFieldsName,n)||(s.promotion.registerNecessaryFieldsName=n),t.Njj(n)}),t.k0s(),t.j41(5,"div",47),t.EFF(6),t.nI1(7,"translate"),t.k0s()(),t.j41(8,"div",45)(9,"ion-checkbox",46),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG(2);return t.DH7(s.promotion.registerNecessaryFieldsNationality,n)||(s.promotion.registerNecessaryFieldsNationality=n),t.Njj(n)}),t.k0s(),t.j41(10,"div",47),t.EFF(11),t.nI1(12,"translate"),t.k0s()(),t.j41(13,"div",45)(14,"ion-checkbox",46),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG(2);return t.DH7(s.promotion.registerNecessaryFieldsLast4DigitsPhone,n)||(s.promotion.registerNecessaryFieldsLast4DigitsPhone=n),t.Njj(n)}),t.k0s(),t.j41(15,"div",47),t.EFF(16),t.nI1(17,"translate"),t.k0s()(),t.j41(18,"div",45)(19,"ion-checkbox",46),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG(2);return t.DH7(s.promotion.registerNecessaryFieldsEmail,n)||(s.promotion.registerNecessaryFieldsEmail=n),t.Njj(n)}),t.k0s(),t.j41(20,"div",47),t.EFF(21),t.nI1(22,"translate"),t.k0s()()()()()}if(2&e){const o=t.XpG(2);t.R7$(4),t.R50("ngModel",o.promotion.registerNecessaryFieldsName),t.R7$(2),t.JRh(t.bMT(7,8,"text.name_lastname")),t.R7$(3),t.R50("ngModel",o.promotion.registerNecessaryFieldsNationality),t.R7$(2),t.JRh(t.bMT(12,10,"text.nationality")),t.R7$(3),t.R50("ngModel",o.promotion.registerNecessaryFieldsLast4DigitsPhone),t.R7$(2),t.JRh(t.bMT(17,12,"text.last4_phone")),t.R7$(3),t.R50("ngModel",o.promotion.registerNecessaryFieldsEmail),t.R7$(2),t.JRh(t.bMT(22,14,"text.email_not_recommended"))}}function So(e,a){1&e&&(t.j41(0,"div",33)(1,"div",49),t.EFF(2),t.nI1(3,"translate"),t.k0s()()),2&e&&(t.R7$(2),t.JRh(t.bMT(3,1,"text.no_info")))}function $o(e,a){1&e&&(t.j41(0,"div",33)(1,"div",50),t.nrm(2,"i",51),t.j41(3,"span"),t.EFF(4),t.nI1(5,"translate"),t.k0s()()()),2&e&&(t.R7$(4),t.JRh(t.bMT(5,1,"text.name_lastname")))}function Bo(e,a){1&e&&(t.j41(0,"div",33)(1,"div",50),t.nrm(2,"i",51),t.j41(3,"span"),t.EFF(4),t.nI1(5,"translate"),t.k0s()()()),2&e&&(t.R7$(4),t.JRh(t.bMT(5,1,"text.nationality")))}function No(e,a){1&e&&(t.j41(0,"div",33)(1,"div",50),t.nrm(2,"i",51),t.j41(3,"span"),t.EFF(4),t.nI1(5,"translate"),t.k0s()()()),2&e&&(t.R7$(4),t.JRh(t.bMT(5,1,"text.last4_phone")))}function Vo(e,a){1&e&&(t.j41(0,"div",33)(1,"div",50),t.nrm(2,"i",51),t.j41(3,"span"),t.EFF(4),t.nI1(5,"translate"),t.k0s()()()),2&e&&(t.R7$(4),t.JRh(t.bMT(5,1,"text.email_not_recommended")))}function Yo(e,a){if(1&e&&(t.j41(0,"div",43),t.DNE(1,So,4,3,"div",48)(2,$o,6,3,"div",48)(3,Bo,6,3,"div",48)(4,No,6,3,"div",48)(5,Vo,6,3,"div",48),t.k0s()),2&e){const o=t.XpG(2);t.R7$(),t.Y8G("ngIf",!(o.promotion.registerNecessaryFieldsName||o.promotion.registerNecessaryFieldsNationality||o.promotion.registerNecessaryFieldsLast4DigitsPhone||o.promotion.registerNecessaryFieldsEmail)),t.R7$(),t.Y8G("ngIf",o.promotion.registerNecessaryFieldsName),t.R7$(),t.Y8G("ngIf",o.promotion.registerNecessaryFieldsNationality),t.R7$(),t.Y8G("ngIf",o.promotion.registerNecessaryFieldsLast4DigitsPhone),t.R7$(),t.Y8G("ngIf",o.promotion.registerNecessaryFieldsEmail)}}function Xo(e,a){if(1&e){const o=t.RV6();t.j41(0,"div",12)(1,"div",13)(2,"div",14),t.DNE(3,To,2,1,"div",15),t.j41(4,"div",16)(5,"div",1),t.EFF(6),t.nI1(7,"translate"),t.k0s()()(),t.j41(8,"div",17)(9,"div",18)(10,"div",19)(11,"div",20),t.EFF(12),t.nI1(13,"translate"),t.k0s(),t.j41(14,"div",21)(15,"select",22),t.nI1(16,"translate"),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG();return t.DH7(s.promotion.registersWithPreRegisterExpireIn,n)||(s.promotion.registersWithPreRegisterExpireIn=n),t.Njj(n)}),t.j41(17,"option",23),t.EFF(18),t.nI1(19,"translate"),t.k0s(),t.j41(20,"option",24),t.EFF(21),t.nI1(22,"translate"),t.k0s(),t.j41(23,"option",25),t.EFF(24),t.nI1(25,"translate"),t.k0s(),t.j41(26,"option",26),t.EFF(27),t.nI1(28,"translate"),t.k0s(),t.j41(29,"option",27),t.EFF(30),t.nI1(31,"translate"),t.k0s(),t.j41(32,"option",28),t.EFF(33),t.nI1(34,"translate"),t.k0s(),t.j41(35,"option",29),t.EFF(36),t.nI1(37,"translate"),t.k0s(),t.j41(38,"option",30),t.EFF(39),t.nI1(40,"translate"),t.k0s(),t.j41(41,"option",31),t.EFF(42),t.nI1(43,"translate"),t.k0s()()(),t.DNE(44,ko,3,3,"div",32),t.k0s(),t.nrm(45,"div",33),t.k0s(),t.j41(46,"div",34),t.EFF(47),t.nI1(48,"translate"),t.k0s()()(),t.j41(49,"div",35)(50,"div",14),t.DNE(51,jo,2,1,"div",15),t.j41(52,"div",16)(53,"div",1),t.EFF(54),t.nI1(55,"translate"),t.k0s()()(),t.j41(56,"div",17)(57,"div",18)(58,"div",33)(59,"div",20),t.EFF(60),t.nI1(61,"translate"),t.k0s(),t.j41(62,"div",21)(63,"select",22),t.nI1(64,"translate"),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG();return t.DH7(s.promotion.registersWithoutPreRegisterExpireIn,n)||(s.promotion.registersWithoutPreRegisterExpireIn=n),t.Njj(n)}),t.j41(65,"option",23),t.EFF(66,"7 d\xedas"),t.k0s(),t.j41(67,"option",24),t.EFF(68,"14 d\xedas"),t.k0s(),t.j41(69,"option",25),t.EFF(70,"21 d\xedas"),t.k0s(),t.j41(71,"option",26),t.EFF(72,"28 d\xedas"),t.k0s(),t.j41(73,"option",27),t.EFF(74,"2 meses"),t.k0s(),t.j41(75,"option",28),t.EFF(76,"3 meses"),t.k0s(),t.j41(77,"option",29),t.EFF(78,"4 meses"),t.k0s(),t.j41(79,"option",36),t.EFF(80,"No definido"),t.k0s(),t.j41(81,"option",31),t.EFF(82,"No expira nunca"),t.k0s()()(),t.DNE(83,Go,3,3,"div",32),t.k0s(),t.nrm(84,"div",33),t.k0s(),t.j41(85,"div",37),t.EFF(86),t.nI1(87,"translate"),t.k0s()()(),t.j41(88,"div",38),t.EFF(89),t.nI1(90,"translate"),t.k0s(),t.DNE(91,Eo,23,16,"div",39)(92,Yo,6,5,"div",39),t.k0s()}if(2&e){const o=t.XpG();t.Y8G("ngClass",t.eq3(75,xo,o.isDisabled)),t.R7$(),t.Y8G("ngClass",t.eq3(77,z,!(o.isDisabled&&o.promotion.registersWithPreRegister||!o.isDisabled))),t.R7$(2),t.Y8G("ngIf",!o.isDisabled),t.R7$(3),t.SpI(" ",t.bMT(7,39,"text.register_with_pre")," "),t.R7$(2),t.Y8G("ngStyle",t.eq3(79,q,o.promotion.registersWithPreRegister?"1":"0.3")),t.R7$(2),t.Y8G("appInputViewMode",o.isDisabled)("externalInputValue",o.promotion.registersWithPreRegisterExpireIn),t.R7$(2),t.SpI(" ",t.bMT(13,41,"text.expires_in")," "),t.R7$(2),t.Y8G("appInputViewMode",o.isDisabled)("ngClass",t.eq3(81,K,o.isFieldInvalid("registersWithPreRegisterExpireIn","preRegister"))),t.R7$(),t.Y8G("disabled",o.isDisabled),t.R50("ngModel",o.promotion.registersWithPreRegisterExpireIn),t.BMQ("placeholder",t.bMT(16,43,"text.select")),t.R7$(3),t.JRh(t.bMT(19,45,"text.expiration.7_days")),t.R7$(3),t.JRh(t.bMT(22,47,"text.expiration.14_days")),t.R7$(3),t.JRh(t.bMT(25,49,"text.expiration.21_days")),t.R7$(3),t.JRh(t.bMT(28,51,"text.expiration.28_days")),t.R7$(3),t.JRh(t.bMT(31,53,"text.expiration.2_months")),t.R7$(3),t.JRh(t.bMT(34,55,"text.expiration.3_months")),t.R7$(3),t.JRh(t.bMT(37,57,"text.expiration.4_months")),t.R7$(3),t.JRh(t.bMT(40,59,"text.expiration.undefined")),t.R7$(3),t.JRh(t.bMT(43,61,"text.expiration.never_expires")),t.R7$(2),t.Y8G("ngIf",o.isFieldInvalid("registersWithPreRegisterExpireIn","preRegister")),t.R7$(3),t.SpI(" ",t.bMT(48,63,"text.pre_register_info")," "),t.R7$(2),t.Y8G("ngClass",t.eq3(83,z,!(o.isDisabled&&o.promotion.registersWithoutPreRegister||!o.isDisabled))),t.R7$(2),t.Y8G("ngIf",!o.isDisabled),t.R7$(3),t.SpI(" ",t.bMT(55,65,"text.register_without_pre")," "),t.R7$(2),t.Y8G("ngStyle",t.eq3(85,q,o.promotion.registersWithoutPreRegister?"1":"0.5")),t.R7$(4),t.SpI(" ",t.bMT(61,67,"text.expires_in")," "),t.R7$(2),t.Y8G("appInputViewMode",o.isDisabled)("ngClass",t.eq3(87,K,o.isFieldInvalid("registersWithoutPreRegisterExpireIn","withoutPreRegister"))),t.R7$(),t.Y8G("disabled",o.isDisabled),t.R50("ngModel",o.promotion.registersWithoutPreRegisterExpireIn),t.BMQ("placeholder",t.bMT(64,69,"text.select")),t.R7$(20),t.Y8G("ngIf",o.isFieldInvalid("registersWithoutPreRegisterExpireIn","withoutPreRegister")),t.R7$(3),t.SpI(" ",t.bMT(87,71,"text.without_pre_register_info")," "),t.R7$(3),t.SpI(" ",t.bMT(90,73,"text.register_required_fields")," "),t.R7$(2),t.Y8G("ngIf",!o.isDisabled),t.R7$(),t.Y8G("ngIf",o.isDisabled)}}let Z=(()=>{var e;class a{constructor(){this.promotionUpdated=new t.bkB,this.loadingButton=!1,this.isDisabled=!0}ngOnInit(){}set promotionData(i){var n,s;this.promotion=i,null!==(n=this.promotion)&&void 0!==n&&n.registersWithoutPreRegister||null!==(s=this.promotion)&&void 0!==s&&s.registersWithPreRegister||(this.promotion.registersWithPreRegister=!0)}onEdit(){this.isDisabled=!this.isDisabled}onSave(){!this.isDisabled&&!this.isFormValid()||(this.savePromotion(),this.isDisabled=!0)}onSelectModality(i){"registersWithPreRegister"===i&&(this.promotion.registersWithoutPreRegister=!1),"registersWithoutPreRegister"===i&&(this.promotion.registersWithPreRegister=!1)}savePromotion(){this.promotionUpdated.emit({registersWithPreRegister:this.promotion.registersWithPreRegister||!1,registersWithPreRegisterExpireIn:this.promotion.registersWithPreRegisterExpireIn,registersWithoutPreRegister:this.promotion.registersWithoutPreRegister||!1,registersWithoutPreRegisterExpireIn:this.promotion.registersWithoutPreRegisterExpireIn,registerNecessaryFieldsName:this.promotion.registerNecessaryFieldsName||!1,registerNecessaryFieldsNationality:this.promotion.registerNecessaryFieldsNationality||!1,registerNecessaryFieldsLast4DigitsPhone:this.promotion.registerNecessaryFieldsLast4DigitsPhone||!1,registerNecessaryFieldsEmail:this.promotion.registerNecessaryFieldsEmail||!1})}isFieldInvalid(i,n){if(this.isDisabled||!this.promotion||"preRegister"===n&&!this.promotion.registersWithPreRegister||"withoutPreRegister"===n&&!this.promotion.registersWithoutPreRegister)return!1;const s=this.promotion[i];return null==s||"string"==typeof s&&""===s.trim()}isFormValid(){let i=!0;return this.promotion.registersWithPreRegister&&(i=i&&!this.isFieldInvalid("registersWithPreRegisterExpireIn","preRegister")),this.promotion.registersWithoutPreRegister&&(i=i&&!this.isFieldInvalid("registersWithoutPreRegisterExpireIn","withoutPreRegister")),i}}return(e=a).\u0275fac=function(i){return new(i||e)},e.\u0275cmp=t.VBU({type:e,selectors:[["app-promotion-payments-details-registers"]],inputs:{currentUser:"currentUser"},outputs:{promotionUpdated:"promotionUpdated"},decls:6,vars:2,consts:[[1,"crm-header-modal","crm-header-modal-empty"],[1,"crm-section-smaller-title"],[1,"crm-buttons-group"],[1,"crm-button-secondary","crm-button-secondary-primary",3,"appLoadingButton"],[1,"crm-button","crm-button-success",3,"appLoadingButton"],[3,"ngClass",4,"ngIf"],["class","crm-button-secondary crm-button-secondary-primary",3,"appLoadingButton","click",4,"ngIf"],[1,"crm-button-secondary","crm-button-secondary-primary",3,"click","appLoadingButton"],[1,"fa-solid","fa-edit"],["class","crm-button crm-button-success",3,"appLoadingButton","click",4,"ngIf"],[1,"crm-button","crm-button-success",3,"click","appLoadingButton"],[1,"fa-solid","fa-check"],[3,"ngClass"],[1,"crm-card-user",3,"ngClass"],[1,"crm-card-user-header"],["class","crm-input-checkbox",4,"ngIf"],[1,"crm-card-user-header-data"],[1,"crm-card-user-body",2,"margin-bottom","0",3,"ngStyle"],[1,"crm-section-inputs-double-input"],[1,"crm-input",3,"appInputViewMode","externalInputValue"],[1,"crm-input-label"],[1,"crm-input-input",3,"appInputViewMode","ngClass"],[3,"ngModelChange","disabled","ngModel"],["value","7"],["value","14"],["value","21"],["value","28"],["value","60"],["value","90"],["value","120"],["value","No defined"],["value","no_expira"],["class","crm-input-error",4,"ngIf"],[1,"crm-input"],[1,"crm-text","crm-section-margin-top"],[1,"crm-card-user","crm-section-margin-top",3,"ngClass"],["value","no_defined"],[1,"crm-text","crm-section-margin-top",2,"color","red"],[1,"crm-title-14","crm-section-margin-top-big"],["class","crm-section-inputs crm-section-margin-top-small crm-section-inputs-grid-input-100",4,"ngIf"],[1,"crm-input-checkbox"],[3,"ngModelChange","ionChange","ngModel"],[1,"crm-input-error"],[1,"crm-section-inputs","crm-section-margin-top-small","crm-section-inputs-grid-input-100"],[1,"crm-input-checkboxes"],["appToggleCheckbox","",1,"crm-input-checkbox"],[3,"ngModelChange","ngModel"],[1,"crm-input-checkbox-label"],["class","crm-input",4,"ngIf"],[1,"crm-input-view"],[1,"crm-input-view-checkbox",2,"display","flex","align-items","center"],[1,"fa","fa-check",2,"color","green","margin-right","5px"]],template:function(i,n){1&i&&(t.j41(0,"div",0),t.nrm(1,"div",1),t.j41(2,"div",2),t.DNE(3,Ro,1,1,"button",3)(4,Fo,1,1,"button",4),t.k0s()(),t.DNE(5,Xo,93,89,"div",5)),2&i&&(t.R7$(3),t.vxM(n.isDisabled?3:4),t.R7$(2),t.Y8G("ngIf",n.promotion))},dependencies:[u.YU,u.bT,u.B3,c.xH,c.y7,c.wz,c.BC,c.vS,g.eY,g.hB,E.M,Do.z,D.K,P.D9],styles:[".crm-header-modal-empty[_ngcontent-%COMP%]{padding-right:0;padding-left:0}.crm-input-view-checkbox[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], i[_ngcontent-%COMP%]{font-size:13px}"]}),a})(),Uo=(()=>{var e;class a{constructor(){}ngOnInit(){}set promotionData(i){this.promotion=i}}return(e=a).\u0275fac=function(i){return new(i||e)},e.\u0275cmp=t.VBU({type:e,selectors:[["app-promotion-payments-details-restrictions"]],decls:2,vars:0,template:function(i,n){1&i&&(t.j41(0,"p"),t.EFF(1," promotion-payments-details-restrictions works!\n"),t.k0s())},styles:[".crm-header-modal-empty[_ngcontent-%COMP%]{padding-right:0;padding-left:0}"]}),a})();const wo=e=>({"crm-section-disabled-inputs":e});function Ao(e,a){if(1&e){const o=t.RV6();t.j41(0,"button",7),t.bIt("click",function(){t.eBV(o);const n=t.XpG(2);return t.Njj(n.onEdit())}),t.nrm(1,"i",8),t.EFF(2),t.nI1(3,"translate"),t.k0s()}if(2&e){const o=t.XpG(2);t.Y8G("appLoadingButton",o.loadingButton),t.R7$(2),t.SpI(" ",t.bMT(3,2,"text.edit")," ")}}function Oo(e,a){if(1&e&&t.DNE(0,Ao,4,4,"button",6),2&e){const o=t.XpG();t.Y8G("ngIf","promoter"===(null==o.currentUser?null:o.currentUser.accountType))}}function Lo(e,a){if(1&e){const o=t.RV6();t.j41(0,"button",10),t.bIt("click",function(){t.eBV(o);const n=t.XpG(2);return t.Njj(n.onSave())}),t.nrm(1,"i",11),t.EFF(2),t.nI1(3,"translate"),t.k0s()}if(2&e){const o=t.XpG(2);t.Y8G("appLoadingButton",o.loadingButton),t.R7$(2),t.SpI(" ",t.bMT(3,2,"text.save")," ")}}function Jo(e,a){if(1&e&&t.DNE(0,Lo,4,4,"button",9),2&e){const o=t.XpG();t.Y8G("ngIf","promoter"===(null==o.currentUser?null:o.currentUser.accountType))}}function Wo(e,a){1&e&&(t.j41(0,"div",16),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"text.select_commission_payment_method"),"\n"))}function Ho(e,a){if(1&e){const o=t.RV6();t.j41(0,"div",17)(1,"ion-radio-group",18),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG(2);return t.DH7(s.promotion.methodToPayCommissions,n)||(s.promotion.methodToPayCommissions=n),t.Njj(n)}),t.j41(2,"div",19),t.nrm(3,"ion-radio",20),t.j41(4,"div",21),t.EFF(5),t.nI1(6,"translate"),t.k0s()(),t.j41(7,"div",19),t.nrm(8,"ion-radio",20),t.j41(9,"div",21),t.EFF(10),t.nI1(11,"translate"),t.k0s()(),t.j41(12,"div",19),t.nrm(13,"ion-radio",20),t.j41(14,"div",21),t.EFF(15),t.nI1(16,"translate"),t.k0s()()()()}if(2&e){const o=t.XpG(2);t.R7$(),t.R50("ngModel",o.promotion.methodToPayCommissions),t.R7$(2),t.Y8G("value","by_the_buyer_pays"),t.R7$(2),t.SpI(" ",t.bMT(6,7,"text.commission_option.buyer_pays")," "),t.R7$(3),t.Y8G("value","when_public_signing"),t.R7$(2),t.SpI(" ",t.bMT(11,9,"text.commission_option.public_signing")," "),t.R7$(3),t.Y8G("value","by_config"),t.R7$(2),t.SpI(" ",t.bMT(16,11,"text.commission_option.completed_payment")," ")}}function Qo(e,a){1&e&&(t.EFF(0),t.nI1(1,"translate")),2&e&&t.SpI(" ",t.bMT(1,1,"text.commission_option.buyer_pays")," ")}function zo(e,a){1&e&&(t.EFF(0),t.nI1(1,"translate")),2&e&&t.SpI(" ",t.bMT(1,1,"text.commission_option.public_signing")," ")}function qo(e,a){1&e&&(t.EFF(0),t.nI1(1,"translate")),2&e&&t.SpI(" ",t.bMT(1,1,"text.commission_option.completed_payment")," ")}function Ko(e,a){if(1&e&&(t.j41(0,"div",22),t.DNE(1,Qo,2,3)(2,zo,2,3)(3,qo,2,3),t.k0s()),2&e){const o=t.XpG(2);t.R7$(),t.vxM("by_the_buyer_pays"===(null==o.promotion?null:o.promotion.methodToPayCommissions)?1:"when_public_signing"===(null==o.promotion?null:o.promotion.methodToPayCommissions)?2:"by_config"===(null==o.promotion?null:o.promotion.methodToPayCommissions)?3:-1)}}function Zo(e,a){if(1&e&&(t.j41(0,"div",28),t.EFF(1),t.k0s()),2&e){const o=t.XpG().$implicit;t.R7$(),t.SpI(" ",o.percentageClientPaid," % ")}}function te(e,a){if(1&e){const o=t.RV6();t.j41(0,"div",29)(1,"input",31),t.nI1(2,"translate"),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG().$implicit;return t.DH7(s.percentageClientPaid,n)||(s.percentageClientPaid=n),t.Njj(n)}),t.bIt("ngModelChange",function(){t.eBV(o);const n=t.XpG(4);return t.Njj(n.checkPercentagesOverflow())}),t.k0s(),t.j41(3,"div",32),t.EFF(4,"%"),t.k0s()()}if(2&e){const o=t.XpG().$implicit,i=t.XpG(3);t.R7$(),t.Y8G("disabled",i.isDisabled)("placeholder",t.bMT(2,3,"text.placeholder.insert_percentage")),t.R50("ngModel",o.percentageClientPaid)}}function oe(e,a){if(1&e&&(t.j41(0,"div",28),t.EFF(1),t.k0s()),2&e){const o=t.XpG().$implicit;t.R7$(),t.SpI(" ",o.percentageToPayCollaborator," % ")}}function ee(e,a){if(1&e){const o=t.RV6();t.j41(0,"div",29)(1,"input",31),t.nI1(2,"translate"),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG().$implicit;return t.DH7(s.percentageToPayCollaborator,n)||(s.percentageToPayCollaborator=n),t.Njj(n)}),t.bIt("ngModelChange",function(){t.eBV(o);const n=t.XpG(4);return t.Njj(n.checkPercentagesOverflow())}),t.k0s(),t.j41(3,"div",32),t.EFF(4,"%"),t.k0s()()}if(2&e){const o=t.XpG().$implicit,i=t.XpG(3);t.R7$(),t.Y8G("disabled",i.isDisabled)("placeholder",t.bMT(2,3,"text.placeholder.insert_percentage")),t.R50("ngModel",o.percentageToPayCollaborator)}}function ne(e,a){if(1&e){const o=t.RV6();t.j41(0,"button",33),t.bIt("click",function(){t.eBV(o);const n=t.XpG().$index,s=t.XpG(3);return t.Njj(s.onDelete(n))}),t.nrm(1,"i",34),t.k0s()}}function ie(e,a){if(1&e&&(t.j41(0,"div",23)(1,"div",22),t.EFF(2),t.k0s(),t.j41(3,"div",26)(4,"div",27),t.EFF(5),t.nI1(6,"translate"),t.k0s(),t.DNE(7,Zo,2,1,"div",28)(8,te,5,5,"div",29),t.k0s(),t.j41(9,"div",26)(10,"div",27),t.EFF(11),t.nI1(12,"translate"),t.k0s(),t.DNE(13,oe,2,1,"div",28)(14,ee,5,5,"div",29),t.k0s(),t.DNE(15,ne,2,0,"button",30),t.k0s()),2&e){const o=a.$index,i=t.XpG(3);t.R7$(2),t.SpI(" ",o+1," "),t.R7$(3),t.SpI(" ",t.bMT(6,6,"text.client_paid_percentage")," "),t.R7$(2),t.vxM(i.isDisabled?7:8),t.R7$(4),t.SpI(" ",t.bMT(12,8,"text.collaborator_payment")," "),t.R7$(2),t.vxM(i.isDisabled?13:14),t.R7$(2),t.Y8G("ngIf",!i.isDisabled)}}function se(e,a){1&e&&(t.j41(0,"div",35),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"text.percentages_overflow_error")," "))}function ae(e,a){if(1&e){const o=t.RV6();t.j41(0,"div",36)(1,"button",37),t.bIt("click",function(){t.eBV(o);const n=t.XpG(3);return t.Njj(n.onAddTable())}),t.nrm(2,"i",38),t.EFF(3),t.nI1(4,"translate"),t.k0s()()}2&e&&(t.R7$(3),t.SpI(" ",t.bMT(4,1,"text.add_more_tables")," "))}function re(e,a){if(1&e&&(t.Z7z(0,ie,16,10,"div",23,t.fX1),t.DNE(2,se,3,3,"div",24)(3,ae,5,3,"div",25)),2&e){const o=t.XpG(2);t.Dyx(null==o.promotion?null:o.promotion.methodToPayCommissionsTables),t.R7$(2),t.Y8G("ngIf",o.percentagesOverflowsMaximum&&!o.isDisabled),t.R7$(),t.Y8G("ngIf",!o.isDisabled)}}function le(e,a){if(1&e&&(t.j41(0,"div",12),t.DNE(1,Wo,3,3,"div",13)(2,Ho,17,13,"div",14)(3,Ko,4,1,"div",15)(4,re,4,2),t.k0s()),2&e){const o=t.XpG();t.Y8G("ngClass",t.eq3(5,wo,o.isDisabled)),t.R7$(),t.Y8G("ngIf",!o.isDisabled),t.R7$(),t.Y8G("ngIf",!o.isDisabled),t.R7$(),t.Y8G("ngIf",o.isDisabled),t.R7$(),t.vxM("by_config"===(null==o.promotion?null:o.promotion.methodToPayCommissions)?4:-1)}}let tt=(()=>{var e;class a{constructor(){this.promotionUpdated=new t.bkB,this.loadingButton=!1,this.isDisabled=!0,this.percentagesOverflowsMaximum=!1}ngOnInit(){}set promotionData(i){this.promotion=i}onEdit(){this.isDisabled=!this.isDisabled}onSave(){this.checkPercentagesOverflow(),!this.percentagesOverflowsMaximum&&(this.savePromotion(),this.isDisabled=!0)}onAddTable(){this.promotion.methodToPayCommissionsTables&&this.promotion.methodToPayCommissionsTables.length?this.promotion.methodToPayCommissionsTables.push({percentageClientPaid:null,percentageToPayCollaborator:null}):this.promotion.methodToPayCommissionsTables=[{percentageClientPaid:null,percentageToPayCollaborator:null}]}onDelete(i){this.promotion.methodToPayCommissionsTables.splice(i,1)}savePromotion(){this.promotionUpdated.emit({methodToPayCommissions:this.promotion.methodToPayCommissions,methodToPayCommissionsTables:this.promotion.methodToPayCommissionsTables})}checkPercentagesOverflow(){var i;const n=(null===(i=this.promotion)||void 0===i?void 0:i.methodToPayCommissionsTables)||[],s=n.reduce((m,d)=>m+(Number(d.percentageClientPaid)||0),0),r=n.reduce((m,d)=>m+(Number(d.percentageToPayCollaborator)||0),0);this.percentagesOverflowsMaximum=s>100||r>100}}return(e=a).\u0275fac=function(i){return new(i||e)},e.\u0275cmp=t.VBU({type:e,selectors:[["app-promotion-payments-details-commission-payment-method"]],inputs:{currentUser:"currentUser"},outputs:{promotionUpdated:"promotionUpdated"},decls:6,vars:2,consts:[[1,"crm-header-modal","crm-header-modal-empty"],[1,"crm-section-smaller-title"],[1,"crm-buttons-group"],[1,"crm-button-secondary","crm-button-secondary-primary",3,"appLoadingButton"],[1,"crm-button","crm-button-success",3,"appLoadingButton"],[3,"ngClass",4,"ngIf"],["class","crm-button-secondary crm-button-secondary-primary",3,"appLoadingButton","click",4,"ngIf"],[1,"crm-button-secondary","crm-button-secondary-primary",3,"click","appLoadingButton"],[1,"fa-solid","fa-edit"],["class","crm-button crm-button-success",3,"appLoadingButton","click",4,"ngIf"],[1,"crm-button","crm-button-success",3,"click","appLoadingButton"],[1,"fa-solid","fa-check"],[3,"ngClass"],["class","crm-title-14",4,"ngIf"],["class","crm-input crm-input-radio-box crm-section-margin-top",4,"ngIf"],["class","crm-text",4,"ngIf"],[1,"crm-title-14"],[1,"crm-input","crm-input-radio-box","crm-section-margin-top"],[1,"crm-input-radios-vertical",3,"ngModelChange","ngModel"],[1,"crm-input-radio"],[3,"value"],[1,"crm-input-radio-label"],[1,"crm-text"],[1,"crm-section-inputs-double-input","crm-section-margin-top-medium",2,"align-items","center"],["class","crm-input-error crm-section-margin-top",4,"ngIf"],["class","crm-section-margin-top","style","display: flex; justify-content: center;",4,"ngIf"],[1,"crm-input"],[1,"crm-input-label"],[1,"crm-input-view"],[1,"crm-input-input"],["class","crm-button-icon-solo",3,"click",4,"ngIf"],["type","number",3,"ngModelChange","disabled","placeholder","ngModel"],[1,"crm-input-input-symbol"],[1,"crm-button-icon-solo",3,"click"],[1,"fas","fa-trash"],[1,"crm-input-error","crm-section-margin-top"],[1,"crm-section-margin-top",2,"display","flex","justify-content","center"],[1,"crm-button-secondary","crm-button-secondary-primary",3,"click"],[1,"fa-solid","fa-add"]],template:function(i,n){1&i&&(t.j41(0,"div",0),t.nrm(1,"div",1),t.j41(2,"div",2),t.DNE(3,Oo,1,1,"button",3)(4,Jo,1,1,"button",4),t.k0s()(),t.DNE(5,le,5,7,"div",5)),2&i&&(t.R7$(3),t.vxM(n.isDisabled?3:4),t.R7$(2),t.Y8G("ngIf",n.promotion))},dependencies:[u.YU,u.bT,c.me,c.Q0,c.BC,c.vS,g.KO,g.f0,g.Je,D.K,P.D9],styles:[".crm-header-modal-empty[_ngcontent-%COMP%]{padding-right:0;padding-left:0}"]}),a})();var me=l(8392),ce=l(9333),de=l(4035);const pe=e=>({"crm-section-disabled-inputs":e}),ot=()=>({});function _e(e,a){if(1&e){const o=t.RV6();t.j41(0,"button",7),t.bIt("click",function(){t.eBV(o);const n=t.XpG(2);return t.Njj(n.onEdit())}),t.nrm(1,"i",8),t.EFF(2," Editar "),t.k0s()}if(2&e){const o=t.XpG(2);t.Y8G("appLoadingButton",o.loadingButton)}}function ue(e,a){if(1&e&&t.DNE(0,_e,3,1,"button",6),2&e){const o=t.XpG();t.Y8G("ngIf","promoter"===(null==o.currentUser?null:o.currentUser.accountType))}}function ge(e,a){if(1&e){const o=t.RV6();t.j41(0,"button",10),t.bIt("click",function(){t.eBV(o);const n=t.XpG(2);return t.Njj(n.onSave())}),t.nrm(1,"i",11),t.EFF(2," Guardar "),t.k0s()}if(2&e){const o=t.XpG(2);t.Y8G("appLoadingButton",o.loadingButton)}}function ve(e,a){if(1&e&&t.DNE(0,ge,3,1,"button",9),2&e){const o=t.XpG();t.Y8G("ngIf","promoter"===(null==o.currentUser?null:o.currentUser.accountType))}}function ye(e,a){if(1&e&&(t.j41(0,"div",15)(1,"div",17)(2,"div",18),t.nrm(3,"img",19),t.k0s(),t.j41(4,"div",20)(5,"div",21),t.EFF(6),t.k0s(),t.j41(7,"div",22),t.EFF(8),t.k0s()()()()),2&e){const o=t.XpG(3);t.R7$(3),t.Y8G("src",(null==o.selectedCompany?null:o.selectedCompany.photoUrl)||"assets/images/avatar.png",t.B4B),t.R7$(3),t.SpI(" ",null==o.selectedCompany?null:o.selectedCompany.name," "),t.R7$(2),t.SpI(" ",null==o.selectedCompany||null==o.selectedCompany.emails?null:o.selectedCompany.emails[0]," ")}}function he(e,a){if(1&e){const o=t.RV6();t.j41(0,"div")(1,"app-contacts-searchbar",16),t.bIt("changeInput",function(n){t.eBV(o);const s=t.XpG(2);return t.Njj(s.onSearchCompany(n))})("contactSelected",function(n){t.eBV(o);const s=t.XpG(2);return t.Njj(s.onSelectCompany(n))}),t.k0s(),t.DNE(2,ye,9,3,"div",15),t.k0s()}if(2&e){const o=t.XpG(2);t.R7$(2),t.vxM(o.selectedCompany?2:-1)}}function be(e,a){if(1&e&&(t.j41(0,"div",15)(1,"div",17)(2,"div",18),t.nrm(3,"img",19),t.k0s(),t.j41(4,"div",20)(5,"div",21),t.EFF(6),t.k0s(),t.j41(7,"div",22),t.EFF(8),t.k0s()()()()),2&e){const o=t.XpG(2);t.R7$(3),t.Y8G("src",(null==o.promotion||null==o.promotion.contactAsCompany?null:o.promotion.contactAsCompany.photoUrl)||"assets/images/avatar.png",t.B4B),t.R7$(3),t.SpI(" ",null==o.promotion||null==o.promotion.contactAsCompany?null:o.promotion.contactAsCompany.name," "),t.R7$(2),t.SpI(" ",null==o.promotion||null==o.promotion.contactAsCompany||null==o.promotion.contactAsCompany.emails?null:o.promotion.contactAsCompany.emails[0]," ")}}function Pe(e,a){if(1&e){const o=t.RV6();t.j41(0,"div",23)(1,"div",24)(2,"ion-checkbox",25),t.bIt("ionChange",function(){const n=t.eBV(o).$implicit,s=t.XpG(3);return t.Njj(s.onClickCheckbox(null==n||null==n.contactRelated?null:n.contactRelated.id))}),t.k0s()(),t.j41(3,"div",26)(4,"div",17)(5,"div",18),t.nrm(6,"img",19),t.k0s(),t.j41(7,"div",20)(8,"div",21),t.EFF(9),t.k0s(),t.j41(10,"div",22),t.EFF(11),t.k0s()()()()()}if(2&e){const o=a.$implicit,i=t.XpG(3);t.R7$(2),t.Y8G("checked",i.selectedContacts.includes(null==o||null==o.contactRelated?null:o.contactRelated.id)),t.R7$(4),t.Y8G("src",(null==o||null==o.contactRelated?null:o.contactRelated.photoUrl)||"assets/images/avatar.png",t.B4B),t.R7$(3),t.SpI(" ",null==o||null==o.contactRelated?null:o.contactRelated.name," "),t.R7$(2),t.SpI(" ",null==o||null==o.contactRelated||null==o.contactRelated.emails?null:o.contactRelated.emails[0]," ")}}function Ce(e,a){if(1&e&&t.Z7z(0,Pe,12,4,"div",23,t.fX1),2&e){const o=t.XpG(2);t.Dyx(null==o.selectedCompany?null:o.selectedCompany.contactsRelation)}}function fe(e,a){if(1&e&&(t.j41(0,"div",23)(1,"div",26)(2,"div",17)(3,"div",18),t.nrm(4,"img",19),t.k0s(),t.j41(5,"div",20)(6,"div",21),t.EFF(7),t.k0s(),t.j41(8,"div",22),t.EFF(9),t.k0s()()()()()),2&e){const o=t.XpG().$implicit;t.R7$(4),t.Y8G("src",(null==o||null==o.contactRelated?null:o.contactRelated.photoUrl)||"assets/images/avatar.png",t.B4B),t.R7$(3),t.SpI(" ",null==o||null==o.contactRelated?null:o.contactRelated.name," "),t.R7$(2),t.SpI(" ",null==o||null==o.contactRelated||null==o.contactRelated.emails?null:o.contactRelated.emails[0]," ")}}function De(e,a){if(1&e&&t.DNE(0,fe,10,3,"div",23),2&e){const o=a.$implicit,i=t.XpG(3);t.vxM(i.selectedContacts.includes(null==o||null==o.contactRelated?null:o.contactRelated.id)?0:-1)}}function xe(e,a){if(1&e&&t.Z7z(0,De,1,1,null,null,t.fX1),2&e){const o=t.XpG(2);t.Dyx(null==o.promotion.contactAsCompany?null:o.promotion.contactAsCompany.contactsRelation)}}function Ie(e,a){if(1&e&&(t.j41(0,"div",12)(1,"div",13),t.EFF(2," Empresa "),t.k0s(),t.j41(3,"div",14),t.DNE(4,he,3,1,"div")(5,be,9,3,"div",15),t.k0s(),t.j41(6,"div",13),t.EFF(7," Contacto asociado "),t.k0s(),t.j41(8,"div",14),t.DNE(9,Ce,2,0)(10,xe,2,0),t.k0s()()),2&e){const o=t.XpG();t.Y8G("ngClass",t.eq3(5,pe,o.isDisabled)),t.R7$(3),t.Y8G("ngClass",t.lJ4(7,ot)),t.R7$(),t.vxM(o.isDisabled?o.isDisabled&&o.promotion.contactAsCompany?5:-1:4),t.R7$(4),t.Y8G("ngClass",t.lJ4(8,ot)),t.R7$(),t.vxM(!o.isDisabled&&o.selectedCompany&&null!=o.selectedCompany&&o.selectedCompany.contactsRelation?9:o.isDisabled&&o.promotion.contactAsCompany?10:-1)}}let et=(()=>{var e;class a{constructor(i){this.contactsService=i,this.promotionUpdated=new t.bkB,this.loadingButton=!1,this.isDisabled=!0,this.selectedCompany=null,this.selectedContacts=[],this.contactFormOptions=me.R}ngOnInit(){}onEdit(){var i;this.isDisabled=!this.isDisabled,this.selectedCompany=null===(i=this.promotion)||void 0===i?void 0:i.contactAsCompany}set promotionData(i){var n,s,r,m;this.promotion=i,null!==(n=this.promotion)&&void 0!==n&&n.contactAsCompany&&(this.selectedContacts=null===(m=this.promotion)||void 0===m||null===(m=m.contactAsCompany)||void 0===m?void 0:m.companyResponsibleContactsIds),null!==(s=this.promotion)&&void 0!==s&&s.registersWithoutPreRegister||null!==(r=this.promotion)&&void 0!==r&&r.registersWithPreRegister||(this.promotion.registersWithPreRegister=!0)}onSave(){this.savePromotion(),this.isDisabled=!0}onSelectCompany(i){i=y.cloneDeep(i),this.selectedCompany=i}onSearchCompany(i){}onClickCheckbox(i){if(this.selectedContacts.includes(i)){const n=this.selectedContacts.filter(s=>s!==i);this.selectedContacts=n}else this.selectedContacts.push(i)}savePromotion(){var i=this;return(0,C.A)(function*(){let n=i.selectedCompany.id,s=i.selectedContacts;i.promotionUpdated.emit({contactAsCompanyId:n}),yield i.contactsService.updateContactById(n,{companyResponsibleContactsIds:s})})()}}return(e=a).\u0275fac=function(i){return new(i||e)(t.rXU(ce.F))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-promotion-payments-details-company"]],inputs:{currentUser:"currentUser"},outputs:{promotionUpdated:"promotionUpdated"},decls:6,vars:2,consts:[[1,"crm-header-modal","crm-header-modal-empty"],[1,"crm-section-smaller-title"],[1,"crm-buttons-group"],[1,"crm-button-secondary","crm-button-secondary-primary",3,"appLoadingButton"],[1,"crm-button","crm-button-success",3,"appLoadingButton"],[3,"ngClass",4,"ngIf"],["class","crm-button-secondary crm-button-secondary-primary",3,"appLoadingButton","click",4,"ngIf"],[1,"crm-button-secondary","crm-button-secondary-primary",3,"click","appLoadingButton"],[1,"fa-solid","fa-edit"],["class","crm-button crm-button-success",3,"appLoadingButton","click",4,"ngIf"],[1,"crm-button","crm-button-success",3,"click","appLoadingButton"],[1,"fa-solid","fa-check"],[3,"ngClass"],[1,"crm-section-smaller-title","py-[10px]"],[1,"crm-card-user",3,"ngClass"],[1,"crm-item-associated-user","mt-10"],["context","show_create_contact",3,"changeInput","contactSelected"],[1,"crm-item-associated-user-left"],[1,"crm-item-associated-user-left-image"],["alt","",3,"src"],[1,"crm-item-associated-user-left-info"],[1,"crm-item-associated-user-left-info-name"],[1,"crm-item-associated-user-left-info-email"],[1,"flex","justify-start","items-center"],[1,"mt-[15px]"],[3,"ionChange","checked"],[1,"crm-item-associated-user","mt-10","justify-start"]],template:function(i,n){1&i&&(t.j41(0,"div",0),t.nrm(1,"div",1),t.j41(2,"div",2),t.DNE(3,ue,1,1,"button",3)(4,ve,1,1,"button",4),t.k0s()(),t.DNE(5,Ie,11,9,"div",5)),2&i&&(t.R7$(3),t.vxM(n.isDisabled?3:4),t.R7$(2),t.Y8G("ngIf",n.promotion))},dependencies:[u.YU,u.bT,g.eY,g.hB,D.K,de.y]}),a})();const F=e=>({"background-color":e}),I=e=>({"crm-section-invisible":e});let nt=(()=>{var e;class a{constructor(i,n,s,r,m){this.utils=i,this.api=n,this.toastService=s,this.state=r,this.translate=m,this.updatePromotion=new t.bkB,this.allSectionsCompleted=new t.bkB,this.dropdownSections={commission:!0,comissionsPaymentMethod:!0,paymentMethod:!0,deliveryDate:!0,registers:!0,restrictions:!0,company:!0},this.incompletedSectionsBackgrounds={commission:null,comissionsPaymentMethod:null,paymentMethod:null,deliveryDate:null,registers:null,restrictions:null,company:null}}ngOnInit(){}set promotionData(i){console.log("QUE TAL "),this.promotion=i,this.deliveryDate.promotionData=y.cloneDeep(i),this.commission.promotionData=y.cloneDeep(i),this.commissionsPaymentMethod.promotionData=y.cloneDeep(i),this.paymentMethod.promotionData=y.cloneDeep(i),this.registers.promotionData=y.cloneDeep(i),this.company.promotionData=y.cloneDeep(i),this.detectIfNoConfigIsSet()}checkIncompletedSections(){}detectIfNoConfigIsSet(){var i,n,s,r,m,d,v,p,f,h,x,T,k,j;this.deliveryDate.isDisabled=(null===(i=this.promotion)||void 0===i?void 0:i.deliveryDateModalityByStatus)||(null===(n=this.promotion)||void 0===n?void 0:n.deliveryDateModalityByMonths),this.incompletedSectionsBackgrounds.deliveryDate=null!==(s=this.promotion)&&void 0!==s&&s.deliveryDateModalityByStatus||null!==(r=this.promotion)&&void 0!==r&&r.deliveryDateModalityByMonths?null:"#f8d7da",this.commission.isDisabled=!(null===(m=this.promotion)||void 0===m||!m.sellCommissionPercentage),this.incompletedSectionsBackgrounds.commission=null!==(d=this.promotion)&&void 0!==d&&d.sellCommissionPercentage?null:"#f8d7da",this.commissionsPaymentMethod.isDisabled=!(null===(v=this.promotion)||void 0===v||!v.methodToPayCommissions),this.incompletedSectionsBackgrounds.comissionsPaymentMethod=null!==(p=this.promotion)&&void 0!==p&&p.methodToPayCommissions?null:"#f8d7da",this.paymentMethod.isDisabled=!(null===(f=this.promotion)||void 0===f||!f.reservePayment),this.incompletedSectionsBackgrounds.paymentMethod=null!==(h=this.promotion)&&void 0!==h&&h.reservePayment?null:"#f8d7da",this.registers.isDisabled=!!(null!==(x=this.promotion)&&void 0!==x&&x.registersWithPreRegister||null!==(T=this.promotion)&&void 0!==T&&T.registersWithoutPreRegister),this.incompletedSectionsBackgrounds.registers=null!==(k=this.promotion)&&void 0!==k&&k.registersWithPreRegister||null!==(j=this.promotion)&&void 0!==j&&j.registersWithoutPreRegister?null:"#f8d7da",console.log("HOLA DETECTED"),this.allSectionsCompleted.emit(null===this.incompletedSectionsBackgrounds.deliveryDate&&null===this.incompletedSectionsBackgrounds.commission&&null===this.incompletedSectionsBackgrounds.comissionsPaymentMethod&&null===this.incompletedSectionsBackgrounds.paymentMethod&&null===this.incompletedSectionsBackgrounds.registers)}onPromotionUpdate(i){var n=this;return(0,C.A)(function*(){var s;const r=n.utils.parseProperties(i);if(null!=r&&r.applyingDeliveryDateForAllProperties){console.log("Applying delivery date for all properties"),console.log(n.promotion);for(const h of n.promotion.properties){console.log("Updating property:",h.id);const x={...h,deliveryDate:r.keyDeliveryDate,status:r.constructionStatus};yield n.api.updatePropertyById(h.id,x)}}yield n.api.updatePromotionById(n.promotion.id,r);const d=yield n.utils.detectIfPromotionIsCompleted(n.promotion);console.log("EL PAYMENT IS COMPLETED?????",d),yield n.api.updatePromotionById(n.promotion.id,{promotionPaymentInfoIsCompleted:d}),n.toastService.showSuccessToast(n.translate.instant("text.promotion_updated_successfully"));const p=yield n.api.getPromotionFullDataById(n.promotion.id),f=null==p||null===(s=p.success)||void 0===s?void 0:s.data;n.promotionData=y.cloneDeep(f),n.detectIfNoConfigIsSet(),n.updatePromotion.emit()})()}}return(e=a).\u0275fac=function(i){return new(i||e)(t.rXU(G.T),t.rXU(B.i),t.rXU(N.f),t.rXU(V.c),t.rXU(P.c$))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-promotion-payments-details"]],viewQuery:function(i,n){if(1&i&&(t.GBs(O,5),t.GBs(Q,5),t.GBs(H,5),t.GBs(Z,5),t.GBs(Uo,5),t.GBs(tt,5),t.GBs(et,5)),2&i){let s;t.mGM(s=t.lsd())&&(n.commission=s.first),t.mGM(s=t.lsd())&&(n.paymentMethod=s.first),t.mGM(s=t.lsd())&&(n.deliveryDate=s.first),t.mGM(s=t.lsd())&&(n.registers=s.first),t.mGM(s=t.lsd())&&(n.restrictions=s.first),t.mGM(s=t.lsd())&&(n.commissionsPaymentMethod=s.first),t.mGM(s=t.lsd())&&(n.company=s.first)}},inputs:{currentUser:"currentUser"},outputs:{updatePromotion:"updatePromotion",allSectionsCompleted:"allSectionsCompleted"},decls:42,vars:59,consts:[[1,"crm-block-dropdown","small","crm-section-margin-top",3,"click","ngStyle"],[1,"crm-section-title"],[1,"crm-block-dropdown-icon"],[3,"name"],[1,"crm-section","size-large",3,"ngClass"],[1,"crm-section-margin-bottom-big",3,"promotionUpdated","currentUser"],[1,"crm-block-dropdown","small",3,"click","ngStyle"],[1,"crm-block-dropdown",3,"click","ngStyle"],[1,"",3,"promotionUpdated","currentUser"]],template:function(i,n){1&i&&(t.j41(0,"div",0),t.bIt("click",function(){return n.dropdownSections.deliveryDate=!n.dropdownSections.deliveryDate}),t.j41(1,"div",1),t.EFF(2),t.nI1(3,"translate"),t.k0s(),t.j41(4,"div",2),t.nrm(5,"ion-icon",3),t.k0s()(),t.j41(6,"div",4)(7,"app-promotion-payments-details-delivery-date",5),t.bIt("promotionUpdated",function(r){return n.onPromotionUpdate(r)}),t.k0s()(),t.j41(8,"div",6),t.bIt("click",function(){return n.dropdownSections.paymentMethod=!n.dropdownSections.paymentMethod}),t.j41(9,"div",1),t.EFF(10),t.nI1(11,"translate"),t.k0s(),t.j41(12,"div",2),t.nrm(13,"ion-icon",3),t.k0s()(),t.j41(14,"div",4)(15,"app-promotion-payments-details-payment-method",5),t.bIt("promotionUpdated",function(r){return n.onPromotionUpdate(r)}),t.k0s()(),t.j41(16,"div",7),t.bIt("click",function(){return n.dropdownSections.commission=!n.dropdownSections.commission}),t.j41(17,"div",1),t.EFF(18),t.nI1(19,"translate"),t.k0s(),t.j41(20,"div",2),t.nrm(21,"ion-icon",3),t.k0s()(),t.j41(22,"div",4)(23,"app-promotion-payments-details-commission",5),t.bIt("promotionUpdated",function(r){return n.onPromotionUpdate(r)}),t.k0s()(),t.j41(24,"div",6),t.bIt("click",function(){return n.dropdownSections.comissionsPaymentMethod=!n.dropdownSections.comissionsPaymentMethod}),t.j41(25,"div",1),t.EFF(26),t.nI1(27,"translate"),t.k0s(),t.j41(28,"div",2),t.nrm(29,"ion-icon",3),t.k0s()(),t.j41(30,"div",4)(31,"app-promotion-payments-details-commission-payment-method",5),t.bIt("promotionUpdated",function(r){return n.onPromotionUpdate(r)}),t.k0s()(),t.j41(32,"div",6),t.bIt("click",function(){return n.dropdownSections.registers=!n.dropdownSections.registers}),t.j41(33,"div",1),t.EFF(34),t.nI1(35,"translate"),t.k0s(),t.j41(36,"div",2),t.nrm(37,"ion-icon",3),t.k0s()(),t.j41(38,"div",4)(39,"app-promotion-payments-details-registers",5),t.bIt("promotionUpdated",function(r){return n.onPromotionUpdate(r)}),t.k0s()(),t.j41(40,"div",4)(41,"app-promotion-payments-details-company",8),t.bIt("promotionUpdated",function(r){return n.onPromotionUpdate(r)}),t.k0s()()),2&i&&(t.Y8G("ngStyle",t.eq3(37,F,n.incompletedSectionsBackgrounds.deliveryDate)),t.R7$(2),t.SpI(" ",t.bMT(3,27,"text.delivery_date")," "),t.R7$(3),t.Y8G("name",n.dropdownSections.deliveryDate?"chevron-up-outline":"chevron-down-outline"),t.R7$(),t.Y8G("ngClass",t.eq3(39,I,!n.dropdownSections.deliveryDate)),t.R7$(),t.Y8G("currentUser",n.currentUser),t.R7$(),t.Y8G("ngStyle",t.eq3(41,F,n.incompletedSectionsBackgrounds.paymentMethod)),t.R7$(2),t.SpI(" ",t.bMT(11,29,"text.payment_method")," "),t.R7$(3),t.Y8G("name",n.dropdownSections.paymentMethod?"chevron-up-outline":"chevron-down-outline"),t.R7$(),t.Y8G("ngClass",t.eq3(43,I,!n.dropdownSections.paymentMethod)),t.R7$(),t.Y8G("currentUser",n.currentUser),t.R7$(),t.Y8G("ngStyle",t.eq3(45,F,n.incompletedSectionsBackgrounds.commission)),t.R7$(2),t.SpI(" ",t.bMT(19,31,"text.commissions")," "),t.R7$(3),t.Y8G("name",n.dropdownSections.commission?"chevron-up-outline":"chevron-down-outline"),t.R7$(),t.Y8G("ngClass",t.eq3(47,I,!n.dropdownSections.commission)),t.R7$(),t.Y8G("currentUser",n.currentUser),t.R7$(),t.Y8G("ngStyle",t.eq3(49,F,n.incompletedSectionsBackgrounds.comissionsPaymentMethod)),t.R7$(2),t.SpI(" ",t.bMT(27,33,"text.commission_payment_method")," "),t.R7$(3),t.Y8G("name",n.dropdownSections.comissionsPaymentMethod?"chevron-up-outline":"chevron-down-outline"),t.R7$(),t.Y8G("ngClass",t.eq3(51,I,!n.dropdownSections.comissionsPaymentMethod)),t.R7$(),t.Y8G("currentUser",n.currentUser),t.R7$(),t.Y8G("ngStyle",t.eq3(53,F,n.incompletedSectionsBackgrounds.registers)),t.R7$(2),t.SpI(" ",t.bMT(35,35,"text.registers")," "),t.R7$(3),t.Y8G("name",n.dropdownSections.registers?"chevron-up-outline":"chevron-down-outline"),t.R7$(),t.Y8G("ngClass",t.eq3(55,I,!n.dropdownSections.registers)),t.R7$(),t.Y8G("currentUser",n.currentUser),t.R7$(),t.Y8G("ngClass",t.eq3(57,I,!n.dropdownSections.company)),t.R7$(),t.Y8G("currentUser",n.currentUser))},dependencies:[u.YU,u.B3,g.iq,O,H,Q,Z,tt,et,P.D9],styles:[".crm-block-dropdown[_ngcontent-%COMP%]{padding-left:8px}"]}),a})();var it=l(5768),Re=l(8031),st=l(2652),Me=l(4476);const Fe=e=>({"crm-section-inputs-grid-input-100":e});function Te(e,a){if(1&e&&(t.j41(0,"div",24),t.nrm(1,"app-general-toast",25),t.k0s()),2&e){const o=t.XpG(2);t.R7$(),t.Y8G("options",o.toastConfig)}}function ke(e,a){if(1&e){const o=t.RV6();t.j41(0,"button",27),t.bIt("click",function(){t.eBV(o);const n=t.XpG(3);return t.Njj(n.onEditPromotion())}),t.nrm(1,"i",28),t.EFF(2),t.nI1(3,"translate"),t.k0s()}if(2&e){const o=t.XpG(3);t.Y8G("appLoadingButton",o.loadingButton),t.R7$(2),t.SpI(" ",t.bMT(3,2,"text.promotion_edit")," ")}}function je(e,a){if(1&e&&t.DNE(0,ke,4,4,"button",26),2&e){const o=t.XpG(2);t.Y8G("ngIf","promoter"===(null==o.currentUser?null:o.currentUser.accountType))}}function Ge(e,a){if(1&e){const o=t.RV6();t.j41(0,"button",30),t.bIt("click",function(){t.eBV(o);const n=t.XpG(3);return t.Njj(n.onSavePromotion())}),t.nrm(1,"i",31),t.EFF(2),t.nI1(3,"translate"),t.k0s()}if(2&e){const o=t.XpG(3);t.Y8G("appLoadingButton",o.loadingButton),t.R7$(2),t.SpI(" ",t.bMT(3,2,"text.promotion_save")," ")}}function Ee(e,a){if(1&e&&t.DNE(0,Ge,4,4,"button",29),2&e){const o=t.XpG(2);t.Y8G("ngIf","promoter"===(null==o.currentUser?null:o.currentUser.accountType))}}function Se(e,a){if(1&e){const o=t.RV6();t.j41(0,"app-file-item-preview",33),t.bIt("click",function(){t.eBV(o);const n=t.XpG().$index,s=t.XpG(2);return t.Njj(s.openLightbox(n))}),t.k0s()}if(2&e){const o=t.XpG().$implicit;t.Y8G("showName",!1)("size","full")("showRemove",!1)("file",o)}}function $e(e,a){if(1&e&&t.DNE(0,Se,1,4,"app-file-item-preview",32),2&e){const o=a.$implicit,i=t.XpG(2);t.vxM(i.utils.isImageFile(null==o?null:o.label)?0:-1)}}function Be(e,a){if(1&e){const o=t.RV6();t.DNE(0,Te,2,1,"div",4),t.j41(1,"div",5)(2,"div",6)(3,"div",7),t.nrm(4,"div",8),t.j41(5,"div",9),t.DNE(6,je,1,1,"button",10)(7,Ee,1,1,"button",11),t.k0s()(),t.j41(8,"div",12),t.Z7z(9,$e,1,1,null,null,t.fX1),t.k0s(),t.j41(11,"div"),t.nrm(12,"app-step-one-promotion-form",13,0)(14,"app-step-three-promotion-form",13,1)(16,"app-step-two-promotion-form",14,2),t.j41(18,"div",15),t.EFF(19),t.nI1(20,"translate"),t.k0s(),t.nrm(21,"br"),t.j41(22,"div",16),t.nrm(23,"br"),t.j41(24,"div",17)(25,"div",18),t.EFF(26,"H1"),t.k0s(),t.j41(27,"div",19)(28,"input",20),t.nI1(29,"translate"),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG();return t.DH7(s.promotion.webH1,n)||(s.promotion.webH1=n),t.Njj(n)}),t.k0s()()(),t.j41(30,"div",17)(31,"div",18),t.EFF(32),t.nI1(33,"translate"),t.k0s(),t.j41(34,"div",21)(35,"textarea",22),t.nI1(36,"translate"),t.mxI("ngModelChange",function(n){t.eBV(o);const s=t.XpG();return t.DH7(s.promotion.webDescription,n)||(s.promotion.webDescription=n),t.Njj(n)}),t.k0s()()()()()(),t.j41(37,"div",6)(38,"app-promotion-payments-details",23,3),t.bIt("updatePromotion",function(){t.eBV(o);const n=t.XpG();return t.Njj(n.reloadPromotionData())}),t.k0s()()()}if(2&e){const o=t.XpG();t.Y8G("ngIf",!(null!=o.promotion&&o.promotion.promotionPaymentInfoIsCompleted)),t.R7$(6),t.vxM(o.disabled?6:7),t.R7$(3),t.Dyx(null==o.promotion?null:o.promotion.promotionFiles),t.R7$(3),t.Y8G("disabled",o.disabled),t.R7$(2),t.Y8G("disabled",o.disabled),t.R7$(2),t.Y8G("isDisabled",o.disabled),t.R7$(3),t.SpI(" ",t.bMT(20,15,"text.more_features")," "),t.R7$(3),t.Y8G("ngClass",t.eq3(23,Fe,!o.disabled)),t.R7$(6),t.R50("ngModel",o.promotion.webH1),t.Y8G("disabled",o.disabled)("placeholder",t.bMT(29,17,"text.input_placeholder_h1")),t.R7$(4),t.JRh(t.bMT(33,19,"text.more_features")),t.R7$(3),t.R50("ngModel",o.promotion.webDescription),t.Y8G("disabled",o.disabled)("placeholder",t.bMT(36,21,"text.input_placeholder_description")),t.R7$(3),t.Y8G("currentUser",o.currentUser)}}let Ne=(()=>{var e;class a{constructor(i,n,s,r,m,d,v,p){this.promotionTransformersService=i,this.utils=n,this.router=s,this.api=r,this.toastService=m,this.state=d,this.modalController=v,this.translate=p,this.reloadPromotion=new t.bkB,this.disabled=!1,this.loadingButton=!1,this.allSectionsCompleted=!0,this.loadingAllData=!0,this.toastConfig={text:this.translate.instant("text.fill_required_fields"),theme:"orange",fullWidth:!0,showCloseButton:!1,smaller:!0}}ngAfterViewInit(){var i=this;return(0,C.A)(function*(){i.disabled=!1,i.loadingAllData=!0,yield i.getCurrentPromotion(),setTimeout(()=>{i.setFormValues(),i.getState(),i.disabled||setTimeout(()=>{i.disabled=!0,i.stepThreeForm.syncFiles()})})})()}getState(){this.state.getState().subscribe(i=>{this.currentUser=i.user})}getCurrentPromotion(){var i=this;return(0,C.A)(function*(){var n;i.loadingAllData=!0;const s=yield i.api.getPromotionFullDataById(i.promotionId);i.promotion=null==s||null===(n=s.success)||void 0===n?void 0:n.data,console.log("PROMOTION",i.promotion),i.loadingAllData=!1})()}setFormValues(){const i=this.promotionTransformersService.transformPromotionFormStepOne(this.promotion);this.stepOneForm.promotionStepOne=i,this.stepTwoForm.promotionStepTwo=this.promotion;const n=this.promotionTransformersService.transformPromotionFormStepThree(this.promotion);console.log("PROMOTION STEP THREE",n),this.stepThreeForm.promotionStepThree=n,this.stepThreeForm.syncFiles(),console.log("HACE ALGO?"),this.paymentDetails.promotionData=y.cloneDeep(this.promotion)}onEditPromotion(){this.disabled=!1,this.stepThreeForm.syncFiles()}onSavePromotion(){var i=this;return(0,C.A)(function*(){i.loadingButton=!0,i.promotion={...i.promotion,...i.stepTwoForm.promotionStepTwo,...i.stepOneForm.promotionStepOne,...i.stepThreeForm.promotionStepThree},y.cloneDeep(i.stepThreeForm.fileUploaderManager.config.files),delete i.promotion.promotionBlocks,delete i.promotion.propertiesCount,delete i.promotion.checked,delete i.promotion.promotionFiles,delete i.promotion.properties,delete i.promotion.promoter,delete i.promotion.contactAsCompany;const s=i.utils.parseProperties(i.promotion),r=yield i.api.updatePromotionById(i.promotion.id,s);if(!r.success)return console.error(r.error),void i.toastService.showToast({text:r.error.errorMessage,theme:"red",time:2e3});{var m,d,v,p;let gn=[...y.cloneDeep(null===(m=i.stepThreeForm)||void 0===m||null===(m=m.fileUploaderManager)||void 0===m||null===(m=m.config)||void 0===m?void 0:m.files)||[],...y.cloneDeep(null===(d=i.stepThreeForm)||void 0===d||null===(d=d.planosFileUploadManagerComponent)||void 0===d||null===(d=d.config)||void 0===d?void 0:d.files)||[],...y.cloneDeep(null===(v=i.stepThreeForm)||void 0===v||null===(v=v.catalogsFileUploadManagerComponent)||void 0===v||null===(v=v.config)||void 0===v?void 0:v.files)||[],...y.cloneDeep(null===(p=i.stepThreeForm)||void 0===p||null===(p=p.videosFileUploadManagerComponent)||void 0===p||null===(p=p.config)||void 0===p?void 0:p.files)||[]];for(let _ of gn){if(null!=_&&_.new){var f,h;const b={promotionId:null===(f=i.promotion)||void 0===f?void 0:f.id,name:"",category:_.category,label:_.label,orderIndex:null==_?void 0:_.orderIndex},$=yield i.api.uploadFile(_.fileBlob),vn=null==$||null===(h=$.success)||void 0===h||null===(h=h.data)||void 0===h?void 0:h.fileName;b.name=vn,yield i.api.addPromotionFile(b)}if(null!=_&&_.deleted&&(yield i.api.removePromotionFileById(null==_?void 0:_.id)),null!=_&&_.moved&&(null==_||!_.deleted)&&(null==_||!_.new)){let b=y.cloneDeep(_);delete b.moved,delete b.fileBase64,delete b.fileBlob,delete b.new,delete b.deleted,delete b.size,delete b.type,console.log("FILE COPYYYYYY "+(null==b?void 0:b.orderIndex),b),yield i.api.editPromotionFile(b)}}i.toastService.showSuccessToast(i.translate.instant("text.promotion_updated_successfully")),i.disabled=!0,i.stepThreeForm.disableFilesInputs(),yield i.reloadPromotionData()}i.loadingButton=!1})()}reloadPromotionData(){var i=this;return(0,C.A)(function*(){i.reloadPromotion.emit(),i.ngAfterViewInit()})()}openLightbox(i){var n=this;return(0,C.A)(function*(){var s,r;console.log("PROMOTION FILES",null===(s=n.promotion)||void 0===s?void 0:s.promotionFiles);let m=y.cloneDeep(null===(r=n.promotion)||void 0===r?void 0:r.promotionFiles).filter(p=>n.utils.isImageFile(null==p?void 0:p.label));const d=yield n.modalController.create({component:it.$,componentProps:{items:m,currentIndex:i||0},cssClass:"lightbox-modal-class",animated:!1});yield d.present();const{data:v}=yield d.onDidDismiss();console.log("Lightbox closed, data returned:",v)})()}}return(e=a).\u0275fac=function(i){return new(i||e)(t.rXU(Re.J),t.rXU(G.T),t.rXU(R.Ix),t.rXU(B.i),t.rXU(N.f),t.rXU(V.c),t.rXU(g.W3),t.rXU(P.c$))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-promotion-details-info"]],viewQuery:function(i,n){if(1&i&&(t.GBs(U.N,5),t.GBs(A.T,5),t.GBs(w.f,5),t.GBs(nt,5)),2&i){let s;t.mGM(s=t.lsd())&&(n.stepOneForm=s.first),t.mGM(s=t.lsd())&&(n.stepTwoForm=s.first),t.mGM(s=t.lsd())&&(n.stepThreeForm=s.first),t.mGM(s=t.lsd())&&(n.paymentDetails=s.first)}},inputs:{promotionId:"promotionId"},outputs:{reloadPromotion:"reloadPromotion"},decls:1,vars:1,consts:[["stepOneForm",""],["stepThreeForm",""],["stepTwoForm",""],["paymentDetails",""],["style","margin-bottom: 16px; width: 100%;","class","crm-section",4,"ngIf"],[1,"crm-boxes-user-create"],[1,"crm-box","crm-section"],[1,"crm-header-modal","crm-header-modal-empty"],[1,"crm-section-title"],[1,"crm-buttons-group"],[1,"crm-button-secondary","crm-button-secondary-primary",3,"appLoadingButton"],[1,"crm-button","crm-button-success",3,"appLoadingButton"],[1,"crm-section-files-previews-promotion-images"],[3,"disabled"],[3,"isDisabled"],[1,"crm-section-smaller-title","crm-section-margin-top"],[1,"crm-section-inputs","crm-section-inputs-grid",3,"ngClass"],[1,"crm-input"],[1,"crm-input-label"],[1,"crm-input-input"],["type","text",3,"ngModelChange","ngModel","disabled","placeholder"],[1,"crm-input-textarea"],[3,"ngModelChange","ngModel","disabled","placeholder"],[3,"updatePromotion","currentUser"],[1,"crm-section",2,"margin-bottom","16px","width","100%"],[3,"options"],["class","crm-button-secondary crm-button-secondary-primary",3,"appLoadingButton","click",4,"ngIf"],[1,"crm-button-secondary","crm-button-secondary-primary",3,"click","appLoadingButton"],[1,"fa-solid","fa-edit"],["class","crm-button crm-button-success",3,"appLoadingButton","click",4,"ngIf"],[1,"crm-button","crm-button-success",3,"click","appLoadingButton"],[1,"fa-solid","fa-check"],[3,"showName","size","showRemove","file"],[3,"click","showName","size","showRemove","file"]],template:function(i,n){1&i&&t.DNE(0,Be,40,25),2&i&&t.vxM(n.loadingAllData?-1:0)},dependencies:[u.YU,u.bT,c.me,c.BC,c.vS,U.N,A.T,w.f,nt,D.K,st.T,Me.l,P.D9]}),a})();var Ve=l(4558);const Ye=["promotionDetailsInfo"],Xe=e=>({"crm-block-body-blue-content-no-padding":e}),Ue=e=>({fatherObj:e,type:"agency"});function we(e,a){if(1&e){const o=t.RV6();t.j41(0,"app-tabs",12),t.bIt("tabClicked",function(n){t.eBV(o);const s=t.XpG();return t.Njj(s.onTabClicked(n))}),t.k0s()}if(2&e){const o=t.XpG();t.Y8G("activeTab",o.activeTab)("tabs",o.promotionTabs)}}function Ae(e,a){if(1&e&&t.nrm(0,"img",16),2&e){const o=t.XpG().$implicit;t.Y8G("src",null==o?null:o.url,t.B4B)}}function Oe(e,a){if(1&e&&t.DNE(0,Ae,1,1,"img",16),2&e){const o=a.$implicit;t.vxM(null!=o&&o.mainImage?0:-1)}}function Le(e,a){if(1&e&&t.Z7z(0,Oe,1,1,null,null,t.fX1),2&e){const o=t.XpG(2);t.Dyx(null==o.promotion?null:o.promotion.promotionFiles)}}function Je(e,a){if(1&e&&t.nrm(0,"img",16),2&e){const o=t.XpG(2);t.Y8G("src",(null==o.promotion||null==o.promotion.promotionFiles?null:o.promotion.promotionFiles.length)>0?null==o.promotion?null:o.promotion.promotionFiles[0].url:"assets/images/building.png",t.B4B)}}function We(e,a){if(1&e){const o=t.RV6();t.j41(0,"img",28),t.bIt("click",function(){t.eBV(o);const n=t.XpG(2);return t.Njj(n.onDeletePromotion())}),t.k0s()}2&e&&t.Y8G("src","assets/icon/trash-icon.svg",t.B4B)}function He(e,a){if(1&e){const o=t.RV6();t.j41(0,"div",10)(1,"div",13)(2,"div",14)(3,"div",15),t.DNE(4,Le,2,0)(5,Je,1,1,"img",16),t.k0s(),t.j41(6,"div",17)(7,"div")(8,"div",18),t.nrm(9,"app-tooltip-text",19),t.k0s(),t.j41(10,"div",20),t.nrm(11,"app-tooltip-text",19),t.k0s()(),t.nrm(12,"div"),t.k0s()(),t.j41(13,"div",21)(14,"div",22)(15,"div",23),t.bIt("click",function(n){t.eBV(o);const s=t.XpG();return t.Njj(s.onRedirectPromoter(n,null==s.promotion?null:s.promotion.promoter))}),t.j41(16,"div"),t.EFF(17),t.k0s()()(),t.j41(18,"div",22)(19,"div",24)(20,"div"),t.EFF(21),t.nI1(22,"translate"),t.k0s()()(),t.j41(23,"div",22)(24,"div",24)(25,"div")(26,"span",25),t.EFF(27),t.k0s(),t.EFF(28),t.k0s()()(),t.j41(29,"div",22)(30,"div",24)(31,"div"),t.EFF(32),t.nI1(33,"translate"),t.k0s()()(),t.j41(34,"div",22)(35,"div",24)(36,"div"),t.EFF(37),t.nI1(38,"translate"),t.k0s()()(),t.j41(39,"div",22)(40,"div",24)(41,"div"),t.EFF(42),t.nI1(43,"thousandSeparator"),t.nI1(44,"thousandSeparator"),t.k0s()()()(),t.j41(45,"div",26),t.DNE(46,We,1,1,"img",27),t.k0s()()()}if(2&e){const o=t.XpG();t.R7$(4),t.vxM(o.thereIsAMainImage?4:5),t.R7$(5),t.Y8G("text",null==o.promotion?null:o.promotion.projectName)("maxLength",20),t.R7$(2),t.Y8G("text",(null==o.promotion?null:o.promotion.city)+" / "+(null==o.promotion?null:o.promotion.province))("maxLength",25),t.R7$(6),t.SpI(" ",null==o.promotion||null==o.promotion.promoter?null:o.promotion.promoter.name," "),t.R7$(4),t.SpI(" ",null!=o.promotion&&o.promotion.constructionType?t.bMT(22,14,"promotion_constructionType_texts."+(null==o.promotion?null:o.promotion.constructionType)):""," "),t.R7$(6),t.SpI(" ",null==o.availableProperties?null:o.availableProperties.length,""),t.R7$(),t.SpI(" / ",null==o.promotion||null==o.promotion.properties?null:o.promotion.properties.length," "),t.R7$(4),t.SpI(" ",null!=o.promotion&&o.promotion.constructionStatus?t.bMT(33,16,"text."+(null==o.promotion?null:o.promotion.constructionStatus)):""," "),t.R7$(5),t.SpI(" ",t.bMT(38,18,"HEADER_TITLES.excavation")," "),t.R7$(5),t.Lme(" ",t.bMT(43,20,null==o.rangeOfPropertiesPrices?null:o.rangeOfPropertiesPrices.min)," \u20ac - ",t.bMT(44,22,null==o.rangeOfPropertiesPrices?null:o.rangeOfPropertiesPrices.max)," \u20ac. "),t.R7$(4),t.Y8G("ngIf","promoter"===(null==o.currentUser?null:o.currentUser.accountType))}}function Qe(e,a){if(1&e){const o=t.RV6();t.j41(0,"app-promotion-details-info",34,0),t.bIt("reloadPromotion",function(){t.eBV(o);const n=t.XpG(2);return t.Njj(n.reloadPromotion())}),t.k0s()}if(2&e){const o=t.XpG(2);t.Y8G("promotionId",o.promotion.id)}}function ze(e,a){if(1&e){const o=t.RV6();t.j41(0,"app-promotion-details-availability",35),t.bIt("changeTab",function(n){t.eBV(o);const s=t.XpG(2);return t.Njj(s.onTabClicked(n))})("reloadPromotion",function(){t.eBV(o);const n=t.XpG(2);return t.Njj(n.reloadPromotion())}),t.k0s()}if(2&e){const o=t.XpG(2);t.Y8G("promotion",o.promotion)}}function qe(e,a){if(1&e&&t.nrm(0,"app-registers-list",31),2&e){const o=t.XpG(2);t.Y8G("promotionId",o.promotionId)("options",t.eq3(3,Ue,o.agency))("isMainPage",!1)}}function Ke(e,a){if(1&e&&t.nrm(0,"app-dashboard",32),2&e){const o=t.XpG(2);t.Y8G("isMainPage",!1)("isAgency",!1)("options",o.promotionDashboardOptions)}}function Ze(e,a){if(1&e&&t.nrm(0,"app-agencies-list",30),2&e){const o=t.XpG(2);t.Y8G("promotion",o.promotion)}}function tn(e,a){if(1&e&&t.nrm(0,"app-file-explorer",33),2&e){const o=t.XpG(2);t.Y8G("directoryBaseElement",o.promotionFolder)}}function on(e,a){if(1&e&&t.DNE(0,Qe,2,1,"app-promotion-details-info",29)(1,ze,1,1,"app-promotion-details-availability",30)(2,qe,1,5,"app-registers-list",31)(3,Ke,1,3,"app-dashboard",32)(4,Ze,1,1,"app-agencies-list",30)(5,tn,1,1,"app-file-explorer",33),2&e){const o=t.XpG();t.vxM("info"===o.activeTab?0:-1),t.R7$(),t.vxM("availability"===o.activeTab?1:-1),t.R7$(),t.vxM("registers"===o.activeTab?2:-1),t.R7$(),t.vxM("promotion_dashboard"===o.activeTab?3:-1),t.R7$(),t.vxM("agencies"===o.activeTab?4:-1),t.R7$(),t.vxM("file-explorer"===o.activeTab?5:-1)}}const en=[{path:"",component:(()=>{var e;class a{constructor(i,n,s,r,m,d,v,p,f,h){this.activatedRoute=i,this.router=n,this.location=s,this.api=r,this.headerService=m,this.toastService=d,this.utils=v,this.state=p,this.modalsService=f,this.translate=h,this.promotionId=null,this.promotion=null,this.promotionTabsForPromoter=[{id:"1",title:"promotion_dashboard",active:!0},{id:"2",title:"availability",active:!1},{id:"3",title:"agencies",active:!1},{id:"4",title:"file-explorer",active:!1},{id:"5",title:"info",active:!1}],this.promotionTabsForAgency=[{id:"1",title:"availability",active:!0},{id:"2",title:"registers",active:!0},{id:"3",title:"file-explorer",active:!1},{id:"4",title:"info",active:!1}],this.promotionTabs=this.promotionTabsForPromoter,this.availableProperties=[],this.rangeOfPropertiesPrices={min:0,max:0},this.rangeOfPropertiesRooms={min:0,max:0},this.activeTab="availability",this.promotionFolder=null,this.thereIsAMainImage=!1,this.promotionDashboardOptions={}}ngOnInit(){this.getState(),this.promotionId=this.activatedRoute.snapshot.paramMap.get("id");const i=this.activatedRoute.snapshot.paramMap.get("tab");i&&this.setActiveTab(i),this.getCurrentPromotion(this.promotionId),this.promotionDashboardOptions={promotionId:this.promotionId}}ionViewWillEnter(){this.headerService.setConfig({title:"promotion_details"})}getCurrentAgency(){var i=this;return(0,C.A)(function*(){var n;const s=yield i.api.getCurrentAgency();null!=s&&null!==(n=s.success)&&void 0!==n&&n.data&&(i.agency=s.success.data)})()}getState(){this.state.getState().subscribe(i=>{this.currentUser=i.user,this.currentUser&&"agency"===this.currentUser.accountType?(this.promotionTabs=this.promotionTabsForAgency,this.getCurrentAgency()):this.promotionTabs=this.promotionTabsForPromoter})}getHeaderInfo(){var i,n,s;this.promotion&&(this.availableProperties=null===(i=this.promotion)||void 0===i||null===(i=i.properties)||void 0===i?void 0:i.filter(r=>"available"===(null==r?void 0:r.availabilityStatus)),this.rangeOfPropertiesPrices=this.utils.calculateRangeOfPropertiesPrices(null===(n=this.promotion)||void 0===n?void 0:n.properties),this.rangeOfPropertiesRooms=this.utils.calculateRangeOfPropertiesRooms(null===(s=this.promotion)||void 0===s?void 0:s.properties))}onRedirectPromoter(i,n){i.stopPropagation(),this.utils.redirectToPromoter(n)}setActiveTab(i){this.activeTab=i,this.promotionTabs.forEach(n=>{n.active=n.title===i})}createCurrentPromotionDirectoryFiles(){this.promotionFolder={type:"promotion_folder",name:this.promotion.projectName,parent:this.promotion}}onDeletePromotion(){var i=this;return(0,C.A)(function*(){if(i.promotion.properties.length>0)return void i.toastService.showToast({text:i.translate.instant("text.promotion.delete_not_allowed"),theme:"red",time:2e3});const n=yield i.modalsService.openConfirmationModal({title:i.translate.instant("text.promotion.delete_title"),message:i.translate.instant("text.promotion.delete_confirm"),icon:"fas fa-trash",iconTheme:"red",buttons:[{text:i.translate.instant("text.cancel"),theme:"btn-secondary",id:"cancel"},{text:i.translate.instant("text.delete"),theme:"btn-red",id:"delete"}]});if("delete"===(null==n?void 0:n.data)){const s=yield i.api.deletePromotionById(i.promotion.id);s.success?window.location.href="/promotions":(console.error(s.error),i.toastService.showToast({text:i.translate.instant("text.promotion.delete_error"),theme:"red",time:2e3}))}})()}onTabClicked(i){this.activeTab=i,this.location.replaceState(`/promotions/${this.promotionId}/${i}`)}getCurrentPromotion(i){var n=this;return(0,C.A)(function*(){var s;const r=yield n.api.getPromotionFullDataById(i);n.promotion=r.success.data,n.createCurrentPromotionDirectoryFiles(),n.thereIsAMainImage=null===(s=n.promotion)||void 0===s||null===(s=s.promotionFiles)||void 0===s?void 0:s.some(m=>m.mainImage),n.getHeaderInfo()})()}reloadPromotion(){var i=this;return(0,C.A)(function*(){yield i.getCurrentPromotion(i.promotionId)})()}}return(e=a).\u0275fac=function(i){return new(i||e)(t.rXU(R.nX),t.rXU(R.Ix),t.rXU(u.aZ),t.rXU(B.i),t.rXU(at.d),t.rXU(N.f),t.rXU(G.T),t.rXU(V.c),t.rXU(rt.M),t.rXU(P.c$))},e.\u0275cmp=t.VBU({type:e,selectors:[["app-promotion-details"]],viewQuery:function(i,n){if(1&i&&t.GBs(Ye,5),2&i){let s;t.mGM(s=t.lsd())&&(n.promotionDetailsInfo=s.first)}},decls:20,vars:12,consts:[["promotionDetailsInfo",""],[1,"crm-block-body"],[1,"crm-block-body-fixed"],[1,"crm-block-details-header"],[1,"crm-block-breadcrumbs"],[1,"crm-block-breadcrumbs-item"],[1,"crm-block-breadcrumbs-item-text","crm-block-breadcrumbs-item-separator"],[1,"crm-block-breadcrumbs-item-text"],[1,"crm-block-details-bottom"],[3,"activeTab","tabs"],[1,"crm-block-details-header-top"],[1,"crm-block-body-blue-content",3,"ngClass"],[3,"tabClicked","activeTab","tabs"],[1,"d-flex","justify-between","align-center","w-full","p-24"],[1,"crm-block-photo-and-info"],[1,"crm-block-photo-and-info-img","crm-block-photo-and-info-img-promotion"],["alt","",3,"src"],[1,"crm-block-photo-and-info-info"],[1,"crm-block-photo-and-info-info-title"],[3,"text","maxLength"],[1,"crm-card-promotion-left-subtitle"],[1,"crm-block-info-horizontal","ml-20"],[1,"crm-info"],[1,"crm-info-content",3,"click"],[1,"crm-info-content"],[1,"text-black"],[1,"crm-trash-btn"],["alt","",3,"src","click",4,"ngIf"],["alt","",3,"click","src"],[3,"promotionId"],[3,"promotion"],[3,"promotionId","options","isMainPage"],[3,"isMainPage","isAgency","options"],[3,"directoryBaseElement"],[3,"reloadPromotion","promotionId"],[3,"changeTab","reloadPromotion","promotion"]],template:function(i,n){1&i&&(t.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5)(5,"div",6),t.EFF(6),t.nI1(7,"translate"),t.k0s()(),t.j41(8,"div",5)(9,"div",7),t.EFF(10," / "),t.k0s()(),t.j41(11,"div",5)(12,"div",7),t.EFF(13),t.nI1(14,"translate"),t.k0s()()(),t.j41(15,"div",8),t.DNE(16,we,1,2,"app-tabs",9),t.k0s(),t.DNE(17,He,47,24,"div",10),t.k0s()(),t.j41(18,"div",11),t.DNE(19,on,6,6),t.k0s()()),2&i&&(t.R7$(6),t.SpI(" ",t.bMT(7,6,"HEADER_TITLES.promotions")," "),t.R7$(7),t.SpI(" ",t.bMT(14,8,"HEADER_TITLES.text_presentation")," "),t.R7$(3),t.vxM(n.promotionTabs?16:-1),t.R7$(),t.vxM("info"!==n.activeTab?17:-1),t.R7$(),t.Y8G("ngClass",t.eq3(10,Xe,"agencies"===n.activeTab)),t.R7$(),t.vxM(n.promotion?19:-1))},dependencies:[u.YU,u.bT,X.O,lt.F,mt.b,ct.e,dt.O,pt.G,_t.c,Ne,P.D9,Ve.w]}),a})()}];let nn=(()=>{var e;class a{}return(e=a).\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.$C({type:e}),e.\u0275inj=t.G2t({imports:[R.iI.forChild(en),R.iI]}),a})();var sn=l(3895),an=l(802),rn=l(8284),ln=l(9083),mn=l(9662),cn=l(5641),dn=l(7774),pn=l(1414),_n=l(1362);let un=(()=>{var e;class a{}return(e=a).\u0275fac=function(i){return new(i||e)},e.\u0275mod=t.$C({type:e}),e.\u0275inj=t.G2t({imports:[u.MD,c.YN,g.bv,nn,X.O,sn.b,an.AgenciesListPageModule,rn.o,ln.E,P.h,mn.Y,st.T,it.$,cn.D,dn.G,pn.DashboardPageModule,_n.RegistersListPageModule]}),a})()}}]);