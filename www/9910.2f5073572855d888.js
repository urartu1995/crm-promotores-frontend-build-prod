"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9910],{4821:(T,F,m)=>{m.d(F,{e:()=>D});var _=m(3953);let D=(()=>{var g;class C{constructor(f){this.renderer=f,this.text="",this.maxLength=20,this.tooltipClass="",this.tooltipElement=null}ngOnInit(){}get trimmedText(){return this.text?this.text.length>this.maxLength?this.text.slice(0,this.maxLength)+"...":this.text:""}showTooltip(f){this.text.length<=this.maxLength||(this.tooltipElement=this.renderer.createElement("div"),this.tooltipElement.innerText=this.text,this.renderer.addClass(this.tooltipElement,"custom-tooltip"),this.tooltipClass&&this.tooltipClass.split(" ").forEach(v=>{v.trim()&&this.renderer.addClass(this.tooltipElement,v.trim())}),this.renderer.setStyle(this.tooltipElement,"position","fixed"),this.renderer.setStyle(this.tooltipElement,"top",f.clientY-30+"px"),this.renderer.setStyle(this.tooltipElement,"left",`${f.clientX}px`),this.renderer.setStyle(this.tooltipElement,"z-index","9999"),this.renderer.appendChild(document.body,this.tooltipElement))}hideTooltip(){this.tooltipElement&&(this.renderer.removeChild(document.body,this.tooltipElement),this.tooltipElement=null)}}return(g=C).\u0275fac=function(f){return new(f||g)(_.rXU(_.sFG))},g.\u0275cmp=_.VBU({type:g,selectors:[["app-tooltip-text"]],inputs:{text:"text",maxLength:"maxLength",tooltipClass:"tooltipClass"},standalone:!0,features:[_.aNF],decls:2,vars:1,consts:[[1,"text",3,"mouseenter","mouseleave"]],template:function(f,P){1&f&&(_.j41(0,"span",0),_.bIt("mouseenter",function(e){return P.showTooltip(e)})("mouseleave",function(){return P.hideTooltip()}),_.EFF(1),_.k0s()),2&f&&(_.R7$(),_.SpI(" ",P.trimmedText,"\n"))}}),C})()},5551:(T,F,m)=>{m.r(F),m.d(F,{PromotionListPageModule:()=>oe});var _=m(177),D=m(9417),g=m(9465),C=m(5188),b=m(467),f=m(9969),P=m(1413),v=m(152),e=m(3953),k=m(2081),j=m(8397),n=m(4501),c=m(1213),s=m(5970),p=m(904);const y=["provinceInput"],M=["cityInput"],E=()=>({standalone:!0});function B(a,d){if(1&a&&(e.j41(0,"ion-select-option",41),e.EFF(1),e.k0s()),2&a){const u=d.$implicit;e.Y8G("value",u.value),e.R7$(),e.JRh(u.label)}}function I(a,d){if(1&a&&(e.j41(0,"ion-select-option",41),e.EFF(1),e.k0s()),2&a){const u=d.$implicit;e.Y8G("value",u.value),e.R7$(),e.JRh(u.label)}}function O(a,d){if(1&a&&(e.j41(0,"ion-select-option",41),e.EFF(1),e.k0s()),2&a){const u=d.$implicit;e.Y8G("value",u.value),e.R7$(),e.JRh(u.label)}}function N(a,d){if(1&a){const u=e.RV6();e.j41(0,"div",27)(1,"ion-checkbox",42),e.bIt("ionChange",function(t){const r=e.eBV(u).$implicit,l=e.XpG();return e.Njj(l.onCheckboxChange(r.value,t,"bedrooms"))}),e.k0s(),e.j41(2,"div",29),e.EFF(3),e.k0s()()}if(2&a){const u=d.$implicit,o=e.XpG();e.R7$(),e.Y8G("value",u.value)("checked",o.filterData.bedrooms.includes(u.value)),e.R7$(2),e.JRh(u.label)}}function V(a,d){if(1&a){const u=e.RV6();e.j41(0,"div",27)(1,"ion-checkbox",42),e.bIt("ionChange",function(t){const r=e.eBV(u).$implicit,l=e.XpG();return e.Njj(l.onCheckboxChange(r.value,t,"bathrooms"))}),e.k0s(),e.j41(2,"div",29),e.EFF(3),e.k0s()()}if(2&a){const u=d.$implicit,o=e.XpG();e.R7$(),e.Y8G("value",u.value)("checked",o.filterData.bathrooms.includes(u.value)),e.R7$(2),e.JRh(u.label)}}let G=(()=>{var a;class d{constructor(o,t){this.ngZone=o,this.api=t,this.setFilter=new e.bkB,this.onFilter=new e.bkB,this.sort=null,this.pagination={page:0,itemsPerPage:25},this.promotions=[],this.filterData={province:"",city:"",price:{min:null,max:null},propertySubtypes:[],constructionStatus:"",bedrooms:[],bathrooms:[],builtArea:{min:null,max:null},plotArea:{min:null,max:null},extras:{communityPool:!1,privatePool:!1,parking:!1,elevator:!1,touristLicense:!1,storageRoom:!1,basement:!1,solarium:!1,beachfrontFirstLine:!1,beachfrontSecondLine:!1,golfFrontFirstLine:!1,golfFrontSecondLine:!1}},this.bathroomOptions=[{value:1,label:"1"},{value:2,label:"2"},{value:3,label:"3"},{value:4,label:"4 o m\xe1s"}],this.bedroomOptions=[{value:1,label:"1"},{value:2,label:"2"},{value:3,label:"3"},{value:4,label:"4 o m\xe1s"}],this.currentYear=(new Date).getFullYear(),this.currentYearFirstDate=new Date(this.currentYear,0,1),this.currentYearFinalDate=new Date(this.currentYear,11,31),this.nextYearFirstDate=new Date(this.currentYear+1,0,1),this.nextYearFinalDate=new Date(this.currentYear+1,11,31),this.keyDeliveryOption="",this.keyDeliveryOptions=[{value:"tres_meses",label:"Menos de 3 meses"},{value:"seis_meses",label:"Menos de 6 meses"},{value:"este_a\xf1o",label:"Este a\xf1o"},{value:"a\xf1o_siguiente",label:"A\xf1o que viene"}],this.subtypesOptions=[{value:"villa",label:"Villa"},{value:"country_house",label:"Finca"},{value:"chalet",label:"Chalet"},{value:"apartment_flat",label:"Piso / Apartamento"},{value:"duplex",label:"D\xfaplex"},{value:"triplex",label:"Triplex"},{value:"ground_floor_apartment",label:"Apto planta baja"},{value:"penthouse",label:"\xc1tico"},{value:"penthouse_duplex",label:"\xc1tico d\xfaplex"},{value:"studio",label:"Estudio"},{value:"commercial_space",label:"Local comercial"}],this.constructionStateOptions=[{value:"proyecto-sin-licencia",label:"Sin Licencia"},{value:"proyecto-con-licencia",label:"Con Licencia"},{value:"fase-excavacion",label:"Fase Excavaci\xf3n"},{value:"cimentacion-completada",label:"Cimentaci\xf3n Completada"},{value:"estructura-construccion",label:"Estructura Construcci\xf3n"},{value:"cerramiento-completado",label:"Cerramiento Completado"},{value:"instalaciones-proceso",label:"Instalaciones Proceso"},{value:"acabados-interiores",label:"Acabados Interiores"},{value:"obra-finalizada",label:"Obra Finalizada"}]}setSubtypes(o){this.filterData.propertySubtypes=o.detail.value}setConstructionStatus(o){this.filterData.constructionStatus=o.detail.value}setKeyDateOption(o){this.keyDeliveryOption=o.detail.value}calculateDaysBetween(o,t){const r=new Date(o),l=new Date(t),i=Math.abs(l.getTime()-r.getTime());return Math.ceil(i/864e5)}onCheckboxChange(o,t,r){const l=this.filterData[r],i={bedrooms:this.bedroomOptions,bathrooms:this.bathroomOptions}[r].map(h=>h.value);if(t.detail.checked)i.filter(h=>h>=o).forEach(h=>{l.includes(h)||l.push(h)});else{const h=l.indexOf(o);h>-1&&l.splice(h,1)}}onClickFilter(){const o={},t={};this.filterData.province&&(t.province={equals:this.filterData.province}),this.filterData.city&&(t.city={equals:this.filterData.city}),null!=this.filterData.price.min&&null==this.filterData.price.max&&(o.properties={apply:!0,filter:{price:{gte:this.filterData.price.min}},onlyCount:!1}),null==this.filterData.price.min&&null!=this.filterData.price.max&&(o.properties={apply:!0,filter:{price:{lte:this.filterData.price.max}},onlyCount:!1}),null!=this.filterData.price.min&&null!=this.filterData.price.max&&(o.properties={apply:!0,filter:{AND:[{price:{gte:this.filterData.price.min}},{price:{lte:this.filterData.price.max}}]},onlyCount:!1}),""!=this.filterData.constructionStatus&&(t.constructionStatus={equals:this.filterData.constructionStatus}),0!=this.filterData.bedrooms.length&&(o.properties=1==this.filterData.bedrooms.length&&4!=this.filterData.bedrooms[0]?{apply:!0,filter:{bedrooms:{equals:this.filterData.bedrooms[0]}},onlyCount:!1}:{apply:!0,filter:{bedrooms:{gte:this.filterData.bedrooms[0]}},onlyCount:!1}),0!=this.filterData.bathrooms.length&&(o.properties=1==this.filterData.bathrooms.length&&4!=this.filterData.bathrooms[0]?{apply:!0,filter:{bathrooms:{equals:this.filterData.bathrooms[0]}},onlyCount:!1}:{apply:!0,filter:{bathrooms:{gte:this.filterData.bathrooms[0]}},onlyCount:!1}),null!=this.filterData.builtArea.min&&null==this.filterData.builtArea.max&&(o.properties={apply:!0,filter:{totalMeasures_squareMetersBuilt:{gte:this.filterData.builtArea.min}},onlyCount:!1}),null==this.filterData.builtArea.min&&null!=this.filterData.builtArea.max&&(o.properties={apply:!0,filter:{totalMeasures_squareMetersBuilt:{lte:this.filterData.builtArea.max}},onlyCount:!1}),null!=this.filterData.builtArea.min&&null!=this.filterData.builtArea.max&&(o.properties={apply:!0,filter:{AND:[{totalMeasures_squareMetersBuilt:{gte:this.filterData.builtArea.min}},{totalMeasures_squareMetersBuilt:{lte:this.filterData.builtArea.max}}]},onlyCount:!1}),null!=this.filterData.plotArea.min&&null==this.filterData.plotArea.max&&(o.properties={apply:!0,filter:{totalMeasures_squareMetersPatch:{gte:this.filterData.plotArea.min}},onlyCount:!1}),null==this.filterData.plotArea.min&&null!=this.filterData.plotArea.max&&(o.properties={apply:!0,filter:{totalMeasures_squareMetersPatch:{lte:this.filterData.plotArea.max}},onlyCount:!1}),null!=this.filterData.plotArea.min&&null!=this.filterData.plotArea.max&&(o.properties={apply:!0,filter:{AND:[{totalMeasures_squareMetersPatch:{gte:this.filterData.plotArea.min}},{totalMeasures_squareMetersBuilt:{lte:this.filterData.plotArea.max}}]},onlyCount:!1}),"tres_meses"==this.keyDeliveryOption&&(t.keyDeliveryDate={lte:new Date((new Date).getTime()+7776e6)}),"seis_meses"==this.keyDeliveryOption&&(t.keyDeliveryDate={lte:new Date((new Date).getTime()+15552e6)}),"este_a\xf1o"==this.keyDeliveryOption&&(t.keyDeliveryDate={gte:this.currentYearFirstDate,lte:this.currentYearFinalDate}),"a\xf1o_siguiente"==this.keyDeliveryOption&&(t.keyDeliveryDate={gte:this.nextYearFirstDate,lte:this.nextYearFinalDate}),0!=this.filterData.propertySubtypes.length&&(o.properties={apply:!0,filter:{promotionType:{in:this.filterData.propertySubtypes}},onlyCount:!1}),this.filterData.extras.communityPool&&(t.f_pool_comunitaria={equals:!0}),this.filterData.extras.privatePool&&(t.f_pool_privada={equals:!0}),this.filterData.extras.parking&&(t.fcustom_parking={equals:!0}),this.filterData.extras.elevator&&(t.f_general_ascensor={equals:!0}),this.filterData.extras.touristLicense&&(t.f_caracteristicas_LicenciaTuristica={equals:!0}),this.filterData.extras.storageRoom&&(t.fcustom_trastero={equals:!0}),this.filterData.extras.basement&&(t.fcustom_sotano={equals:!0}),this.filterData.extras.solarium&&(t.fcustom_solarium={equals:!0}),this.filterData.extras.beachfrontFirstLine&&(t.f_cercania_PrimeraLineaDePlaya={equals:!0}),this.filterData.extras.beachfrontSecondLine&&(t.f_cercania_SegundaLineaDePlaya={equals:!0}),this.filterData.extras.golfFrontFirstLine&&(t.f_cercania_PrimeraLineaDeGolf={equals:!0}),this.filterData.extras.golfFrontSecondLine&&(t.f_cercania_SegundaLineaDeGolf={equals:!0}),console.log("Filter emitted:",t),console.log("Join emitted:",o),this.setFilter.emit(!0),this.onFilter.emit({filter:t,joinTables:o})}onResetFilters(){this.keyDeliveryOption="",this.filterData={province:"",city:"",price:{min:null,max:null},propertySubtypes:[],constructionStatus:"",bedrooms:[],bathrooms:[],builtArea:{min:null,max:null},plotArea:{min:null,max:null},extras:{communityPool:!1,privatePool:!1,parking:!1,elevator:!1,touristLicense:!1,storageRoom:!1,basement:!1,solarium:!1,beachfrontFirstLine:!1,beachfrontSecondLine:!1,golfFrontFirstLine:!1,golfFrontSecondLine:!1}},this.setFilter.emit(!1),this.onFilter.emit({filter:{},joinTables:{}})}ngOnInit(){}getPromotions(){var o=this;return(0,b.A)(function*(){const t=yield o.api.getPromotions({},o.sort,o.pagination,null);o.promotions=t.success.data||[]})()}ngAfterViewInit(){this.getPromotions(),this.provinceAutocomplete=new google.maps.places.Autocomplete(this.provinceInput.nativeElement,{types:["(regions)"],componentRestrictions:{country:"es"},fields:["address_component","geometry"]}),this.provinceAutocomplete.addListener("place_changed",()=>{this.ngZone.run(()=>{var o,t;const r=this.provinceAutocomplete.getPlace(),l=null===(o=r.address_components)||void 0===o?void 0:o.find(i=>i.types.includes("administrative_area_level_2"));l&&(this.filterData.province=l.long_name,this.provinceInput.nativeElement.value=l.long_name),null!==(t=r.geometry)&&void 0!==t&&t.viewport&&this.cityAutocomplete.setBounds(r.geometry.viewport)})}),this.cityAutocomplete=new google.maps.places.Autocomplete(this.cityInput.nativeElement,{types:["locality"],componentRestrictions:{country:"es"},fields:["address_component"]}),this.cityAutocomplete.addListener("place_changed",()=>{this.ngZone.run(()=>{var o;const r=null===(o=this.cityAutocomplete.getPlace().address_components)||void 0===o?void 0:o.find(l=>l.types.includes("locality"));r&&(this.filterData.city=r.long_name,this.cityInput.nativeElement.value=r.long_name)})})}}return(a=d).\u0275fac=function(o){return new(o||a)(e.rXU(e.SKi),e.rXU(k.i))},a.\u0275cmp=e.VBU({type:a,selectors:[["app-promotions-filter-block"]],viewQuery:function(o,t){if(1&o&&(e.GBs(y,5),e.GBs(M,5)),2&o){let r;e.mGM(r=e.lsd())&&(t.provinceInput=r.first),e.mGM(r=e.lsd())&&(t.cityInput=r.first)}},outputs:{setFilter:"setFilter",onFilter:"onFilter"},decls:141,vars:32,consts:[["provinceInput",""],["cityInput",""],[2,"position","relative","background","white"],["autocomplete","off","novalidate",""],["type","text","autocomplete","username",2,"display","none"],["type","password","autocomplete","new-password",2,"display","none"],[1,"crm-header-modal","crm-header-modal-fixed-top"],[1,"crm-modal-header-title"],[1,"crm-buttons-group"],["type","button",1,"crm-button",3,"click"],["type","button",1,"crm-button-secondary","crm-button-secondary-red",3,"click"],[1,"crm-block-inputs","crm-block-filters-inputs"],[1,"crm-input"],[1,"crm-input-label"],[1,"crm-input-input"],["type","text","placeholder","Seleccione provincia","name","province","autocomplete","off","autocorrect","off","spellcheck","false",3,"ngModelChange","ngModel","ngModelOptions"],["type","text","placeholder","Seleccione ciudad","name","city","autocomplete","off","autocorrect","off","spellcheck","false",3,"ngModelChange","ngModel","ngModelOptions"],[1,"crm-section-inputs-double-input"],["type","number","name","priceMin","placeholder","M\xednimo",3,"ngModelChange","ngModel"],["type","number","name","priceMax","placeholder","M\xe1ximo",3,"ngModelChange","ngModel"],["toggleIcon","chevron-down-outline","justify","end","interface","popover","multiple","true","name","constructionSubType",1,"crm-select-item",3,"ngModelChange","ionChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["toggleIcon","chevron-down-outline","justify","end","interface","popover","name","constructionStatus",1,"crm-select-item",3,"ngModelChange","ionChange","ngModel"],["toggleIcon","chevron-down-outline","justify","end","interface","popover","name","deliveryOption",1,"crm-select-item",3,"ngModelChange","ionChange","ngModel"],[1,"crm-input-checkboxes",2,"grid-template-columns","1fr"],["class","crm-input-checkbox",4,"ngFor","ngForOf"],[1,"crm-input-checkboxes"],[1,"crm-input-checkbox"],["name","communityPool",3,"ngModelChange","ngModel"],[1,"crm-input-checkbox-label"],["name","privatePool",3,"ngModelChange","ngModel"],["name","parking",3,"ngModelChange","ngModel"],["name","elevator",3,"ngModelChange","ngModel"],["name","touristLicense",3,"ngModelChange","ngModel"],["name","storageRoom",3,"ngModelChange","ngModel"],["name","basement",3,"ngModelChange","ngModel"],["name","solarium",3,"ngModelChange","ngModel"],["name","beachfrontFirstLine",3,"ngModelChange","ngModel"],["name","beachfrontSecondLine",3,"ngModelChange","ngModel"],["name","golfFrontFirstLine",3,"ngModelChange","ngModel"],["name","golfFrontSecondLine",3,"ngModelChange","ngModel"],[3,"value"],[3,"ionChange","value","checked"]],template:function(o,t){if(1&o){const r=e.RV6();e.j41(0,"div",2)(1,"form",3),e.nrm(2,"input",4)(3,"input",5),e.j41(4,"div",6)(5,"div",7),e.EFF(6,"Filtrar"),e.k0s(),e.j41(7,"div",8)(8,"button",9),e.bIt("click",function(){return e.eBV(r),e.Njj(t.onClickFilter())}),e.EFF(9," Filtrar "),e.k0s(),e.j41(10,"button",10),e.bIt("click",function(){return e.eBV(r),e.Njj(t.onResetFilters())}),e.EFF(11," Reiniciar "),e.k0s()()(),e.j41(12,"div",11)(13,"div",12)(14,"div",13),e.EFF(15,"Provincia"),e.k0s(),e.j41(16,"div",14)(17,"input",15,0),e.mxI("ngModelChange",function(i){return e.eBV(r),e.DH7(t.filterData.province,i)||(t.filterData.province=i),e.Njj(i)}),e.k0s()()(),e.j41(19,"div",12)(20,"div",13),e.EFF(21,"Ciudad"),e.k0s(),e.j41(22,"div",14)(23,"input",16,1),e.mxI("ngModelChange",function(i){return e.eBV(r),e.DH7(t.filterData.city,i)||(t.filterData.city=i),e.Njj(i)}),e.k0s()()(),e.j41(25,"div",17)(26,"div",12)(27,"div",13),e.EFF(28,"Min.Precio"),e.k0s(),e.j41(29,"div",14)(30,"input",18),e.mxI("ngModelChange",function(i){return e.eBV(r),e.DH7(t.filterData.price.min,i)||(t.filterData.price.min=i),e.Njj(i)}),e.k0s()()(),e.j41(31,"div",12)(32,"div",13),e.EFF(33,"Max.Precio"),e.k0s(),e.j41(34,"div",14)(35,"input",19),e.mxI("ngModelChange",function(i){return e.eBV(r),e.DH7(t.filterData.price.max,i)||(t.filterData.price.max=i),e.Njj(i)}),e.k0s()()()(),e.j41(36,"div",12)(37,"div",13),e.EFF(38,"Subtipo propiedad"),e.k0s(),e.j41(39,"ion-list")(40,"ion-item")(41,"ion-select",20),e.mxI("ngModelChange",function(i){return e.eBV(r),e.DH7(t.filterData.propertySubtypes,i)||(t.filterData.propertySubtypes=i),e.Njj(i)}),e.bIt("ionChange",function(i){return e.eBV(r),e.Njj(t.setSubtypes(i))}),e.DNE(42,B,2,2,"ion-select-option",21),e.k0s()()()(),e.j41(43,"div",12)(44,"div",13),e.EFF(45,"Estado de obra"),e.k0s(),e.j41(46,"ion-list")(47,"ion-item")(48,"ion-select",22),e.mxI("ngModelChange",function(i){return e.eBV(r),e.DH7(t.filterData.constructionStatus,i)||(t.filterData.constructionStatus=i),e.Njj(i)}),e.bIt("ionChange",function(i){return e.eBV(r),e.Njj(t.setConstructionStatus(i))}),e.DNE(49,I,2,2,"ion-select-option",21),e.k0s()()()(),e.j41(50,"div",12)(51,"div",13),e.EFF(52,"Entrega"),e.k0s(),e.j41(53,"ion-list")(54,"ion-item")(55,"ion-select",23),e.mxI("ngModelChange",function(i){return e.eBV(r),e.DH7(t.keyDeliveryOption,i)||(t.keyDeliveryOption=i),e.Njj(i)}),e.bIt("ionChange",function(i){return e.eBV(r),e.Njj(t.setKeyDateOption(i))}),e.DNE(56,O,2,2,"ion-select-option",21),e.k0s()()()(),e.j41(57,"div",12)(58,"div",13),e.EFF(59,"Dormitorios"),e.k0s(),e.j41(60,"div",24),e.DNE(61,N,4,3,"div",25),e.k0s()(),e.j41(62,"div",12)(63,"div",13),e.EFF(64,"Ba\xf1os"),e.k0s(),e.j41(65,"div",24),e.DNE(66,V,4,3,"div",25),e.k0s()(),e.j41(67,"div",17)(68,"div",12)(69,"div",13),e.EFF(70,"Min.m2 Const"),e.k0s(),e.j41(71,"div",14)(72,"input",18),e.mxI("ngModelChange",function(i){return e.eBV(r),e.DH7(t.filterData.builtArea.min,i)||(t.filterData.builtArea.min=i),e.Njj(i)}),e.k0s()()(),e.j41(73,"div",12)(74,"div",13),e.EFF(75,"Max.m2 Const"),e.k0s(),e.j41(76,"div",14)(77,"input",19),e.mxI("ngModelChange",function(i){return e.eBV(r),e.DH7(t.filterData.builtArea.max,i)||(t.filterData.builtArea.max=i),e.Njj(i)}),e.k0s()()()(),e.j41(78,"div",17)(79,"div",12)(80,"div",13),e.EFF(81,"Min.m2 Parcela"),e.k0s(),e.j41(82,"div",14)(83,"input",18),e.mxI("ngModelChange",function(i){return e.eBV(r),e.DH7(t.filterData.plotArea.min,i)||(t.filterData.plotArea.min=i),e.Njj(i)}),e.k0s()()(),e.j41(84,"div",12)(85,"div",13),e.EFF(86,"Max.m2 Parcela"),e.k0s(),e.j41(87,"div",14)(88,"input",19),e.mxI("ngModelChange",function(i){return e.eBV(r),e.DH7(t.filterData.plotArea.max,i)||(t.filterData.plotArea.max=i),e.Njj(i)}),e.k0s()()()(),e.j41(89,"div",12)(90,"div",13),e.EFF(91,"Extras"),e.k0s(),e.j41(92,"div",26)(93,"div",27)(94,"ion-checkbox",28),e.mxI("ngModelChange",function(i){return e.eBV(r),e.DH7(t.filterData.extras.communityPool,i)||(t.filterData.extras.communityPool=i),e.Njj(i)}),e.k0s(),e.j41(95,"div",29),e.EFF(96,"Piscina Comunidad"),e.k0s()(),e.j41(97,"div",27)(98,"ion-checkbox",30),e.mxI("ngModelChange",function(i){return e.eBV(r),e.DH7(t.filterData.extras.privatePool,i)||(t.filterData.extras.privatePool=i),e.Njj(i)}),e.k0s(),e.j41(99,"div",29),e.EFF(100,"Piscina Privada"),e.k0s()(),e.j41(101,"div",27)(102,"ion-checkbox",31),e.mxI("ngModelChange",function(i){return e.eBV(r),e.DH7(t.filterData.extras.parking,i)||(t.filterData.extras.parking=i),e.Njj(i)}),e.k0s(),e.j41(103,"div",29),e.EFF(104,"Parking"),e.k0s()(),e.j41(105,"div",27)(106,"ion-checkbox",32),e.mxI("ngModelChange",function(i){return e.eBV(r),e.DH7(t.filterData.extras.elevator,i)||(t.filterData.extras.elevator=i),e.Njj(i)}),e.k0s(),e.j41(107,"div",29),e.EFF(108,"Ascensor"),e.k0s()(),e.j41(109,"div",27)(110,"ion-checkbox",33),e.mxI("ngModelChange",function(i){return e.eBV(r),e.DH7(t.filterData.extras.touristLicense,i)||(t.filterData.extras.touristLicense=i),e.Njj(i)}),e.k0s(),e.j41(111,"div",29),e.EFF(112,"Licencia tur\xedstica"),e.k0s()(),e.j41(113,"div",27)(114,"ion-checkbox",34),e.mxI("ngModelChange",function(i){return e.eBV(r),e.DH7(t.filterData.extras.storageRoom,i)||(t.filterData.extras.storageRoom=i),e.Njj(i)}),e.k0s(),e.j41(115,"div",29),e.EFF(116,"Trastero"),e.k0s()(),e.j41(117,"div",27)(118,"ion-checkbox",35),e.mxI("ngModelChange",function(i){return e.eBV(r),e.DH7(t.filterData.extras.basement,i)||(t.filterData.extras.basement=i),e.Njj(i)}),e.k0s(),e.j41(119,"div",29),e.EFF(120,"S\xf3tano"),e.k0s()(),e.j41(121,"div",27)(122,"ion-checkbox",36),e.mxI("ngModelChange",function(i){return e.eBV(r),e.DH7(t.filterData.extras.solarium,i)||(t.filterData.extras.solarium=i),e.Njj(i)}),e.k0s(),e.j41(123,"div",29),e.EFF(124,"Solarium"),e.k0s()(),e.j41(125,"div",27)(126,"ion-checkbox",37),e.mxI("ngModelChange",function(i){return e.eBV(r),e.DH7(t.filterData.extras.beachfrontFirstLine,i)||(t.filterData.extras.beachfrontFirstLine=i),e.Njj(i)}),e.k0s(),e.j41(127,"div",29),e.EFF(128,"1\xaa l\xednea de playa"),e.k0s()(),e.j41(129,"div",27)(130,"ion-checkbox",38),e.mxI("ngModelChange",function(i){return e.eBV(r),e.DH7(t.filterData.extras.beachfrontSecondLine,i)||(t.filterData.extras.beachfrontSecondLine=i),e.Njj(i)}),e.k0s(),e.j41(131,"div",29),e.EFF(132,"2\xaa l\xednea de playa"),e.k0s()(),e.j41(133,"div",27)(134,"ion-checkbox",39),e.mxI("ngModelChange",function(i){return e.eBV(r),e.DH7(t.filterData.extras.golfFrontFirstLine,i)||(t.filterData.extras.golfFrontFirstLine=i),e.Njj(i)}),e.k0s(),e.j41(135,"div",29),e.EFF(136,"1\xaa l\xednea de golf"),e.k0s()(),e.j41(137,"div",27)(138,"ion-checkbox",40),e.mxI("ngModelChange",function(i){return e.eBV(r),e.DH7(t.filterData.extras.golfFrontSecondLine,i)||(t.filterData.extras.golfFrontSecondLine=i),e.Njj(i)}),e.k0s(),e.j41(139,"div",29),e.EFF(140,"2\xaa l\xednea de golf"),e.k0s()()()()()()()}2&o&&(e.R7$(17),e.R50("ngModel",t.filterData.province),e.Y8G("ngModelOptions",e.lJ4(30,E)),e.R7$(6),e.R50("ngModel",t.filterData.city),e.Y8G("ngModelOptions",e.lJ4(31,E)),e.R7$(7),e.R50("ngModel",t.filterData.price.min),e.R7$(5),e.R50("ngModel",t.filterData.price.max),e.R7$(6),e.R50("ngModel",t.filterData.propertySubtypes),e.R7$(),e.Y8G("ngForOf",t.subtypesOptions),e.R7$(6),e.R50("ngModel",t.filterData.constructionStatus),e.R7$(),e.Y8G("ngForOf",t.constructionStateOptions),e.R7$(6),e.R50("ngModel",t.keyDeliveryOption),e.R7$(),e.Y8G("ngForOf",t.keyDeliveryOptions),e.R7$(5),e.Y8G("ngForOf",t.bedroomOptions),e.R7$(5),e.Y8G("ngForOf",t.bathroomOptions),e.R7$(6),e.R50("ngModel",t.filterData.builtArea.min),e.R7$(5),e.R50("ngModel",t.filterData.builtArea.max),e.R7$(6),e.R50("ngModel",t.filterData.plotArea.min),e.R7$(5),e.R50("ngModel",t.filterData.plotArea.max),e.R7$(6),e.R50("ngModel",t.filterData.extras.communityPool),e.R7$(4),e.R50("ngModel",t.filterData.extras.privatePool),e.R7$(4),e.R50("ngModel",t.filterData.extras.parking),e.R7$(4),e.R50("ngModel",t.filterData.extras.elevator),e.R7$(4),e.R50("ngModel",t.filterData.extras.touristLicense),e.R7$(4),e.R50("ngModel",t.filterData.extras.storageRoom),e.R7$(4),e.R50("ngModel",t.filterData.extras.basement),e.R7$(4),e.R50("ngModel",t.filterData.extras.solarium),e.R7$(4),e.R50("ngModel",t.filterData.extras.beachfrontFirstLine),e.R7$(4),e.R50("ngModel",t.filterData.extras.beachfrontSecondLine),e.R7$(4),e.R50("ngModel",t.filterData.extras.golfFrontFirstLine),e.R7$(4),e.R50("ngModel",t.filterData.extras.golfFrontSecondLine))},dependencies:[_.Sq,D.qT,D.me,D.Q0,D.BC,D.cb,D.vS,D.cV,g.eY,g.uz,g.nf,g.Nm,g.Ip,g.hB,g.Je],styles:[".max-price-input[_ngcontent-%COMP%]{margin-top:15px}.crm-select-item[_ngcontent-%COMP%]{font-size:var(--crm-input-input-font-size)}.crm-select-item[_ngcontent-%COMP%]   ion-select-option[_ngcontent-%COMP%]{font-size:var(--crm-input-input-font-size)}"]}),d})();const w=a=>({"crm-button-secondary-primary":a});function Y(a,d){1&a&&(e.j41(0,"button",33),e.nrm(1,"i",34),e.EFF(2," A\xf1adir promoci\xf3n "),e.k0s()),2&a&&e.Y8G("routerLink","/promotions/create")}function $(a,d){1&a&&(e.nrm(0,"i",35),e.EFF(1," Cerrar filtros "))}function U(a,d){1&a&&(e.nrm(0,"i",36),e.EFF(1," Filtros activados "))}function H(a,d){1&a&&(e.nrm(0,"i",36),e.EFF(1," Filtrar "))}function X(a,d){if(1&a&&e.DNE(0,U,2,0)(1,H,2,0),2&a){const u=e.XpG();e.vxM(u.filters?0:1)}}function W(a,d){if(1&a&&(e.j41(0,"div",27),e.EFF(1),e.k0s()),2&a){const u=e.XpG();e.R7$(),e.SpI(" ",u.checkedPromotions," seleccionado ")}}function K(a,d){1&a&&(e.j41(0,"div",31),e.nrm(1,"app-card-promotion",37)(2,"app-card-promotion",37)(3,"app-card-promotion",37),e.k0s()),2&a&&(e.R7$(),e.Y8G("isSkeleton",!0),e.R7$(),e.Y8G("isSkeleton",!0),e.R7$(),e.Y8G("isSkeleton",!0))}function J(a,d){if(1&a){const u=e.RV6();e.j41(0,"app-card-promotion",40),e.bIt("togglePromotionCheckbox",function(){e.eBV(u);const t=e.XpG(2);return e.Njj(t.onTogglePromotionCheckbox())}),e.k0s()}2&a&&e.Y8G("promotion",d.$implicit)}function z(a,d){1&a&&(e.j41(0,"div",39),e.EFF(1," A\xfan no hay promociones "),e.k0s())}function Z(a,d){if(1&a&&(e.j41(0,"div",31),e.Z7z(1,J,1,1,"app-card-promotion",38,e.fX1),e.DNE(3,z,2,0,"div",39),e.k0s()),2&a){const u=e.XpG();e.R7$(),e.Dyx(u.promotions),e.R7$(2),e.vxM(0===u.promotions.length?3:-1)}}function Q(a,d){if(1&a){const u=e.RV6();e.j41(0,"div",32)(1,"app-promotions-filter-block",41),e.bIt("onFilter",function(t){e.eBV(u);const r=e.XpG();return e.Njj(r.onFilter(t))})("setFilter",function(t){e.eBV(u);const r=e.XpG();return e.Njj(r.isFilterSet=t)}),e.k0s()()}2&a&&e.Y8G("@biggerFadeSlideIn",void 0)}const q=[{path:"",component:(()=>{var a;class d{constructor(o,t,r,l,i,h){this.api=o,this.router=t,this.toastService=r,this.headerService=l,this.state=i,this.popoversService=h,this.promotions=[],this.allSystemPromotionsCount=0,this.checkedPromotions=0,this.isFilterSet=!1,this.searchString="",this.searchSubject=new P.B,this.promotionPrismaFilter={},this.promotionsJoinTables={},this.aside={type:"filters",visible:!1},this.filters=null,this.sort=null,this.pagination={page:0,itemsPerPage:25},this.promotionsCount=0,this.loadingList=!1}ngOnInit(){this.searchSubject.pipe((0,v.B)(800)).subscribe(o=>{this.onSearchChanged(o)}),this.getState()}ionViewWillEnter(){this.headerService.setConfig({title:"promotions"}),this.getData()}onFilter(o){console.log("Filter event received:",Object.keys((null==o?void 0:o.filter)||{}).length),Object.keys((null==o?void 0:o.filter)||{}).length||(this.searchString=null),this.promotionPrismaFilter=o.filter,this.promotionsJoinTables=o.joinTables,this.pagination.page=0,this.getData()}onTogglePromotionCheckbox(){this.setNumberOfCheckedPromotions()}onToggleAllCheckboxes(o){this.promotions.forEach(t=>t.checked=o.detail.checked),this.setNumberOfCheckedPromotions()}onSearchInputChange(o){this.searchSubject.next(o.target.value)}onSearchChanged(o){this.searchString=o,this.pagination.page=0,this.getData()}onToggleAside(){this.aside.visible=!this.aside.visible}onGoNextPage(){(this.pagination.page+1)*this.pagination.itemsPerPage<this.allSystemPromotionsCount&&(this.pagination.page++,this.getData())}onGoPreviousPage(){this.pagination.page>0&&(this.pagination.page--,this.getData())}updatePagination(){const o=this.pagination.page*this.pagination.itemsPerPage+1,t=Math.min((this.pagination.page+1)*this.pagination.itemsPerPage,this.allSystemPromotionsCount);console.log(o),console.log(t)}setNumberOfCheckedPromotions(){this.checkedPromotions=this.promotions.filter(o=>o.checked).length}getData(){var o=this;return(0,b.A)(function*(){let t;try{var r,l,i,h;if(o.loadingList=!0,t=yield o.getPromotions(),null!==(r=t)&&void 0!==r&&r.error)throw new Error("Error fetching promotions");o.promotions=(null===(l=t)||void 0===l||null===(l=l.success)||void 0===l?void 0:l.data)||[],console.log("ALL PROMOTIONS",o.promotions),o.allSystemPromotionsCount=(null===(i=t)||void 0===i||null===(i=i.success)||void 0===i||null===(i=i.metadata)||void 0===i?void 0:i.count)||0,o.pagination.page=0,o.promotionsCount=(null===(h=t)||void 0===h||null===(h=h.success)||void 0===h||null===(h=h.metadata)||void 0===h?void 0:h.count)||0,o.setNumberOfCheckedPromotions(),o.updatePagination(),o.loadingList=!1}catch{o.toastService.showToast({text:"Ha ocurrido un error al cargar los procedimientos",theme:"red",icon:"fas fa-exclamation-triangle",time:1e4}),o.loadingList=!1}})()}getState(){this.state.getState().subscribe(o=>{this.currentUser=o.user})}getPromotions(){var o=this;return(0,b.A)(function*(){var t;let r;const l=o.isFilterSet?{...o.promotionPrismaFilter}:{};if(o.searchString&&(l.OR=[{projectName:{contains:o.searchString,mode:"insensitive"}},{title:{contains:o.searchString,mode:"insensitive"}},{description:{contains:o.searchString,mode:"insensitive"}},{title_es:{contains:o.searchString,mode:"insensitive"}},{description_es:{contains:o.searchString,mode:"insensitive"}},{title_en:{contains:o.searchString,mode:"insensitive"}},{description_en:{contains:o.searchString,mode:"insensitive"}},{title_fr:{contains:o.searchString,mode:"insensitive"}},{description_fr:{contains:o.searchString,mode:"insensitive"}},{title_de:{contains:o.searchString,mode:"insensitive"}},{description_de:{contains:o.searchString,mode:"insensitive"}},{title_ru:{contains:o.searchString,mode:"insensitive"}},{description_ru:{contains:o.searchString,mode:"insensitive"}},{constructionType:{contains:o.searchString,mode:"insensitive"}},{constructionSubType:{contains:o.searchString,mode:"insensitive"}}]),r=o.isFilterSet?yield o.api.getPromotions(l,o.sort,o.pagination,{properties:{apply:!0,filter:null,onlyCount:!1},promotionFiles:{apply:!0,filter:null,onlyCount:!1},promoter:{apply:!0,filter:null,onlyCount:!1},...o.promotionsJoinTables}):yield o.api.getPromotions(l,o.sort,o.pagination,{properties:{apply:!0,filter:null,onlyCount:!1},promotionFiles:{apply:!0,filter:null,onlyCount:!1},promoter:{apply:!0,filter:null,onlyCount:!1}}),null!==(t=r)&&void 0!==t&&null!==(t=t.success)&&void 0!==t&&t.data){const h=r.success.data.map(x=>{var L;let A=null;if(null!==(L=x.documents)&&void 0!==L&&L.length){const ne=new Date(x.documents[x.documents.length-1].toDate),re=new Date,ae=ne.getTime()-re.getTime(),S=Math.floor(ae/864e5);if(S<=60){let R="";S<0?R="Expirado":S<=60&&(R=` Expira en ${S} d\xedas `),A={dateStr:R,expired:S<0}}}return{...x,activeDocumentInfo:A}});r.success.data=h}return r})()}onSort(o){var t=this;return(0,b.A)(function*(){const r=yield t.popoversService.onShowMenuPopover(o,"list-order");if(console.log("Popover result:",r),null!=r&&r.data){const l=r.data;if(l.includes("_")){const i=l.split("_")[0],h=l.split("_")[1];t.sort={field:i,order:h}}else t.sort={field:l,order:"asc"};t.getData()}})()}}return(a=d).\u0275fac=function(o){return new(o||a)(e.rXU(k.i),e.rXU(C.Ix),e.rXU(j.f),e.rXU(n.d),e.rXU(c.c),e.rXU(s.m))},a.\u0275cmp=e.VBU({type:a,selectors:[["app-promotion-list"]],decls:42,vars:14,consts:[[3,"fullscreen","scrollY"],[1,"crm-block-content"],[1,"crm-block-body"],[1,"crm-block-body-fixed"],[1,"crm-header-modal"],[1,"crm-input"],[1,"crm-input-input","crm-input-input-searchbar"],[1,"fas","fa-search"],["type","text","placeholder","Buscar promoci\xf3n",3,"input","value"],[1,"crm-buttons-group"],["class","crm-button",3,"routerLink",4,"ngIf"],[1,"crm-button-secondary",3,"click","ngClass"],[1,"crm-block-pagination-selectors"],[1,"crm-button-pagination"],[1,"crm-button-pagination-text"],[1,"crm-button-pagination-buttons"],[1,"crm-button-pagination-arrow","crm-button-icon-solo",3,"click"],[1,"fas","fa-arrow-left"],[1,"crm-button-pagination-number"],[1,"fas","fa-arrow-right"],[1,"crm-dropdown",3,"click"],[1,"crm-dropdown-text"],[1,"crm-dropdown-right"],[1,"crm-dropdown-value"],[1,"crm-dropdown-arrow"],[1,"fas","fa-chevron-down"],[1,"crm-input-checkbox"],[1,"crm-input-checkbox-pre-label"],[3,"ionChange"],[1,"crm-input-checkbox-label"],[1,"crm-block-body-blue-content",2,"overflow-x","auto"],[2,"display","flex","align-items","flex-start","flex-wrap","wrap","gap","20px"],[1,"crm-block-content-aside"],[1,"crm-button",3,"routerLink"],[1,"fa","fa-plus"],[1,"fa","fa-times"],[1,"fa","fa-filter"],[3,"isSkeleton"],[3,"promotion"],[1,"crm-empty-list","crm-text"],[3,"togglePromotionCheckbox","promotion"],[3,"onFilter","setFilter"]],template:function(o,t){1&o&&(e.j41(0,"ion-content",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),e.nrm(7,"i",7),e.j41(8,"input",8),e.bIt("input",function(l){return t.onSearchInputChange(l)}),e.k0s()()(),e.j41(9,"div",9),e.DNE(10,Y,3,1,"button",10),e.j41(11,"button",11),e.bIt("click",function(){return t.onToggleAside()}),e.DNE(12,$,2,0)(13,X,2,1),e.k0s()()(),e.j41(14,"div",12)(15,"div",13),e.nrm(16,"div",14),e.j41(17,"div",15)(18,"button",16),e.bIt("click",function(){return t.onGoPreviousPage()}),e.nrm(19,"i",17),e.k0s(),e.j41(20,"div",18),e.EFF(21),e.k0s(),e.j41(22,"button",16),e.bIt("click",function(){return t.onGoNextPage()}),e.nrm(23,"i",19),e.k0s()(),e.j41(24,"div",20),e.bIt("click",function(l){return t.onSort(l)}),e.j41(25,"div",21),e.EFF(26," Ordenar por "),e.k0s(),e.j41(27,"div",22)(28,"div",23),e.EFF(29),e.k0s(),e.j41(30,"div",24),e.nrm(31,"i",25),e.k0s()()()(),e.nrm(32,"div"),e.j41(33,"div",26),e.DNE(34,W,2,1,"div",27),e.j41(35,"ion-checkbox",28),e.bIt("ionChange",function(l){return t.onToggleAllCheckboxes(l)}),e.k0s(),e.j41(36,"div",29),e.EFF(37),e.k0s()()()(),e.j41(38,"div",30),e.DNE(39,K,4,3,"div",31)(40,Z,4,1,"div",31),e.k0s()(),e.DNE(41,Q,2,1,"div",32),e.k0s()()),2&o&&(e.Y8G("fullscreen",!0)("scrollY",!1),e.R7$(8),e.Y8G("value",t.searchString),e.R7$(2),e.Y8G("ngIf","promoter"===(null==t.currentUser?null:t.currentUser.accountType)),e.R7$(),e.Y8G("ngClass",e.eq3(12,w,!(null!=t.aside&&t.aside.visible)&&t.filters)),e.R7$(),e.vxM(null!=t.aside&&t.aside.visible?12:13),e.R7$(9),e.SpI(" P\xe1g ",t.pagination.page+1," "),e.R7$(8),e.SpI(" ",null!=t.sort&&t.sort.field?(null==t.sort?null:t.sort.field)+" "+(null==t.sort?null:t.sort.order):"Fecha de creaci\xf3n"," "),e.R7$(5),e.vxM(t.checkedPromotions?34:-1),e.R7$(3),e.SpI(" Seleccionar ",t.promotions.length," registros "),e.R7$(2),e.vxM(t.loadingList?39:40),e.R7$(2),e.vxM(null!=t.aside&&t.aside.visible?41:-1))},dependencies:[_.YU,_.bT,g.eY,g.W9,g.hB,g.N7,C.Wk,p.X,G],data:{animation:[(0,f.hZ)("biggerFadeSlideIn",[(0,f.kY)(":enter",[(0,f.iF)({opacity:0,transform:"translateX(150px)"}),(0,f.i0)("100ms ease-out",(0,f.iF)({opacity:1,transform:"translateX(0)"}))])])]}}),d})()}];let ee=(()=>{var a;class d{}return(a=d).\u0275fac=function(o){return new(o||a)},a.\u0275mod=e.$C({type:a}),a.\u0275inj=e.G2t({imports:[C.iI.forChild(q),C.iI]}),d})();var te=m(7991);let oe=(()=>{var a;class d{}return(a=d).\u0275fac=function(o){return new(o||a)},a.\u0275mod=e.$C({type:a}),a.\u0275inj=e.G2t({imports:[_.MD,D.YN,g.bv,ee,te.S]}),d})()},4558:(T,F,m)=>{m.d(F,{w:()=>D});var _=m(3953);let D=(()=>{var g;class C{transform(f,...P){if(null==f||""===f)return"";let v;return v="string"==typeof f?parseFloat(f):f,isNaN(v)?"":v.toString().replace(/\.(?=\d+$)/,",").replace(/\B(?=(\d{3})+(?!\d))/g,".")}}return(g=C).\u0275fac=function(f){return new(f||g)},g.\u0275pipe=_.EJ8({name:"thousandSeparator",type:g,pure:!0}),C})()},6552:(T,F,m)=>{m.d(F,{T:()=>v});var _=m(467),D=m(7376),C=m(6069),b=m(3953),f=m(5188),P=m(2081);let v=(()=>{var e;class k{constructor(n,c){this.router=n,this.api=c}parseBackendDateToFrontendDateInput(n){if(!n)return null;try{const c=new Date(n),s=c.getFullYear();return`${s}-${String(c.getMonth()+1).padStart(2,"0")}-${String(c.getDate()).padStart(2,"0")}`}catch(c){return console.error("Invalid date format",c),null}}parseProperties(n){for(let s in n)n[s]instanceof Date?n[s]=n[s].toISOString():"string"==typeof n[s]&&n[s].match(/^\d{4}-\d{2}-\d{2}$/)&&(n[s]=new Date(n[s]).toISOString()),"true"===n[s]?n[s]=!0:"false"===n[s]&&(n[s]=!1);const c=D.cloneDeep(n);return delete c.id,c}parseNameToValue(n){return n.toLowerCase().replace(/ /g,"_")}groupPropertiesByPromotion(n,c){return n.map(p=>{const y=c.filter(M=>M.promotionId===p.id);return{...p,properties:y}})}setStepsCompleted(n,c){return n.steps=D.orderBy(n.steps,["order"],["asc"]),n.steps=n.steps.map(s=>(s.order<c.order&&(s.isCompleted=!0),s)),n}hexToRgba(n,c){if(!n)return"";let s,p,y;if(3===(n=n.replace("#","")).length)s=parseInt(n[0]+n[0],16),p=parseInt(n[1]+n[1],16),y=parseInt(n[2]+n[2],16);else{if(6!==n.length)return"";s=parseInt(n.substring(0,2),16),p=parseInt(n.substring(2,4),16),y=parseInt(n.substring(4,6),16)}return`rgba(${s}, ${p}, ${y}, ${c})`}getLanguageInfo(n){return C.e.find(s=>s.code===n)||{}}getCountryInfo(n){return C.X.find(s=>s.code===n)||{}}countAvailableProperties(n){return n&&0!==n.length?n.filter(c=>"available"===c.availabilityStatus).length:0}calculateRangeOfPropertiesPrices(n){if(!n||0===n.length)return{min:0,max:0};const c=n.map(s=>s.price);return{min:Math.min(...c),max:Math.max(...c)}}calculateRangeOfPropertiesRooms(n){if(!n||0===n.length)return{min:0,max:0};const c=n.map(s=>s.bedrooms);return{min:Math.min(...c),max:Math.max(...c)}}onRemoveAgencyAccessToPromotion(n){console.log("onRemoveAgencyAccessToPromotion",n)}redirectToPromoter(n){this.router.navigate([`/promoters/${n.id}`])}filterFilesByCategoryAndSort(n,c){return n&&0!==n.length?n.filter(s=>s.category===c).sort((s,p)=>{var y,M;return(null!==(y=null==s?void 0:s.orderIndex)&&void 0!==y?y:0)-(null!==(M=null==p?void 0:p.orderIndex)&&void 0!==M?M:0)}):[]}transformThousandSeparator(n){if(null==n||""===n)return"";let c;return c="string"==typeof n?parseFloat(n):n,isNaN(c)?"":c.toString().replace(/\.(?=\d+$)/,",").replace(/\B(?=(\d{3})+(?!\d))/g,".")}detectIfPromotionIsCompleted(n){var c=this;return(0,_.A)(function*(){var s;if(!n)return!1;const p=null===(s=yield c.api.getPromotionById(n.id))||void 0===s||null===(s=s.success)||void 0===s?void 0:s.data;return((null==p?void 0:p.deliveryDateModalityByStatus)||(null==p?void 0:p.deliveryDateModalityByMonths))&&!(null==p||!p.sellCommissionPercentage)&&!(null==p||!p.methodToPayCommissions)&&!(null==p||!p.reservePayment)&&((null==p?void 0:p.registersWithPreRegister)||(null==p?void 0:p.registersWithoutPreRegister))})()}isImageFile(n){var c;const p=null===(c=n.split(".").pop())||void 0===c?void 0:c.toLowerCase();return!!p&&["png","jpg","jpeg","gif","bmp","webp","svg","tiff","tif","ico","heic","jfif"].includes(p)}}return(e=k).\u0275fac=function(n){return new(n||e)(b.KVO(f.Ix),b.KVO(P.i))},e.\u0275prov=b.jDH({token:e,factory:e.\u0275fac,providedIn:"root"}),k})()},152:(T,F,m)=>{m.d(F,{B:()=>C});var _=m(3236),D=m(9974),g=m(4360);function C(b,f=_.E){return(0,D.N)((P,v)=>{let e=null,k=null,j=null;const n=()=>{if(e){e.unsubscribe(),e=null;const s=k;k=null,v.next(s)}};function c(){const s=j+b,p=f.now();if(p<s)return e=this.schedule(void 0,s-p),void v.add(e);n()}P.subscribe((0,g._)(v,s=>{k=s,j=f.now(),e||(e=f.schedule(c,b),v.add(e))},()=>{n(),v.complete()},void 0,()=>{k=e=null}))})}}}]);